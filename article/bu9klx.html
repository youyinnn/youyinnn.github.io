<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="baidu-site-verification" content="l09YSIpJQW" />
    <meta name="referrer" content="origin">
    <title>blog | youyinnn</title>
    <script src="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@latest/myjs/loadscripts.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@latest/myjs/jump-1.4.js"></script>
    <link rel="bookmark" href="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@latest/img/favicon.ico" />
    <link rel="icon" href="/img/favicon.ico" type="image/ico"/>
    <link rel="stylesheet" href="/mycss/style.css">

    <script src="/myjs/scriptlist.js"></script>
</head>

<body>

    <ol id="topbar" class="breadcrumb unselectable new_font">
        <p style="color:rgb(214, 214, 214); padding-right: 1rem;">
            <button id="egg" class="egg">ğŸš€</button>&nbsp;&nbsp;&nbsp;&nbsp;&gt;</p>
        <li class="breadcrumb-item">
            <spen id="homebut" href="javaScript:void(0)" class="ah">-home</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="articlesbut" href="javaScript:void(0)" class="ah">-articles</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="scriptbut" href="javaScript:void(0)" class="ah">-scripts</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="todobut" href="javaScript:void(0)" class="ah">-todos</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="resumebut" href="javaScript:void(0)" class="ah">-resume</spen>
        </li>
        <li class="breadcrumb-item dropdown">
            <spen href="javaScript:void(0)" class="ah" role="button" id="friendlinkedbut" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">-friends</spen>
            <div id="fldd" class="dropdown-menu" aria-labelledby="friendlinkedbut" style="border-radius: initial;"></div>
        </li>

        <div id="hb" data-toggle="tooltip" data-placement="bottom" title="show/hide TopBar">

        </div>
    </ol>

    <div id="homepage" class="unselectable new_font myhide">
        <div id="homepage-center">
            <div id="slogan">
                <i id="wolf-logo" style="font-style: normal;" class="mr-4">ğŸŒ‘</i><span id="slogan-text"></span>
            </div>
            <div id="homepage-btn">
                <div id="showmore"> &nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp; About Me & This Blog</div>
                <div id="showhacknical"> &nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp; My Github Analysis</div>
                <div id="toarticles"> &nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp; My Tech Articles</div>
            </div>
        </div>
        <div id="ifwrapper" class="hacknical_hide">
            <iframe id="hacknical_github_analysis" frameborder="0"></iframe>
        </div>
    </div>

    <div id="articles_side_panel" class="unselectable myhide new_font">
        <div id="cates_tree_head">Article Categories</div>
        <div id="cates_tree_body"></div>
        <div id="blog_statistic_head">Blog Statistics</div>
        <table id="blog_statistic_body" class="myhide">
            <tbody>
                <tr>
                    <td style="text-align:right">Online:</td>
                    <td style="text-align:left" id="stat_running"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Article:</td>
                    <td style="text-align:left" id="stat_article_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Chars:</td>
                    <td style="text-align:left" id="stat_typein"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Categories:</td>
                    <td style="text-align:left" id="stat_cate_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Tags:</td>
                    <td style="text-align:left" id="stat_tag_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Last update:</td>
                    <td style="text-align:left" id="stat_last_update"></td>
                </tr>
            </tbody>
        </table>
    </div>
    <div id="docpanel" class="myhide new_font">
        <div id="articlesearch" class="input-group">
            <input id="articlesearchtext" type="text" class="form-control" autocomplete="off" placeholder="search with keywords (algolia)">
            <div id="searchprocessbar">
                <div id="spb-out" class="spb-outter-animate"></div>
                <div id="spb-in" class="spb-inner-animate"></div>
            </div>
            <div class="input-group-append">
                <button id="cleanbut" class="btn btn-light" type="button" title="clear search">cls</button>
                <button id="categories" class="btn btn-light" type="button">cates</button>
                <button id="tags" class="btn btn-light" type="button" title="all tags">tags</button>
                <button id="articlesearchbut" class="btn btn-light" type="button" title="search">sch</button>
            </div>
        </div>
        <div id="searchrscount" class="unselectable"></div>
        <div class="tgs myhide" id="all_cates">
            <span style="font-size: 1rem; font-weight: bold ; padding: 6px;">All categories:</span>
            <br>
        </div>
        <div class="tgs myhide" id="all_tags">
            <span style="font-size: 1rem; font-weight: bold ; padding: 6px;">All tags:</span>
            <br>
        </div>
    </div>

    <div id="sidetoccontainer" class="tochide unselectable new_font">
        <div id="block">
            <div id="percent" data-toggle="tooltip" data-placement="bottom" title="return to the top">0%</div>
        </div>
        <div id="sidetoc" class="unselectable markdown-body editormd-preview-container markdown-toc"></div>
    </div>
    <div id="md" class="myhide markdown-body editormd-html-preview">
        
          <h3 id="fccefbaf">å‰è¨€</h3><p>æœ¬<strong>ç³»åˆ—</strong>æ–‡ç« ä¸»è¦æ˜¯ä¸ºJavaå¹¶å‘å…¥é—¨åšé“ºå«ï¼Œé›†ä¸­æ¸…ç‚¹ï¼š</p>
<ul>
<li><strong>Threadçš„åŸºæœ¬æ¦‚å¿µ</strong></li>
<li><strong>ç”Ÿå‘½å‘¨æœŸ</strong></li>
<li><strong>åˆ›å»ºå’Œä½¿ç”¨</strong></li>
<li><strong>çº¿ç¨‹çš„é­…åŠ›æ‰€åœ¨</strong><ul>
<li><strong>ä»çº¿ç¨‹ä¸åŒæ­¥åˆ°çº¿ç¨‹å®‰å…¨</strong><ul>
<li><strong>é”</strong></li>
<li><strong>æ­»é”æƒ…å†µ</strong></li>
</ul>
</li>
<li><strong>ä»çº¿ç¨‹å„è‡ªç‹¬ç«‹åˆ°çº¿ç¨‹é€šä¿¡</strong><ul>
<li><strong>åœæ­¢çº¿ç¨‹</strong></li>
<li><strong>å”¤é†’çº¿ç¨‹</strong></li>
<li><strong>é€šä¿¡</strong></li>
</ul>
</li>
</ul>
</li>
<li><strong>Javaä¸­çš„å¹¶å‘ç¼–ç¨‹</strong></li>
<li><strong>å¹¶å‘å’Œå•ä¾‹æ¨¡å¼çš„é‚£äº›äº‹</strong></li>
</ul>
<p>æœ¬ç³»åˆ—é™¤äº†å‚è€ƒ<em>ã€ŠJavaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹</em>å’Œ<em>ã€ŠJavaå¤šçº¿ç¨‹ç¼–ç¨‹æ ¸å¿ƒæŠ€æœ¯ã€‹</em>è¿™ä¸¤æœ¬ä¹¦ä¹‹å¤–ï¼Œè¿˜ä¼šå‚è€ƒJDKçš„æºç å’Œ<a href="https://docs.oracle.com/javase/8/docs/api/">APIæ–‡æ¡£</a>ï¼Œ<strong>ä¼šç¿»è¯‘æ–‡æ¡£ä¸­éƒ¨åˆ†é‡è¦çš„è¯´æ˜ï¼Œæ¯”å¦‚è¿‡æœŸæ–¹æ³•ä¸ºä»€ä¹ˆè¿‡æœŸå’Œå®˜æ–¹è§£å†³åŠæ³•ç­‰ç­‰</strong></p>
<p>æœ¬ç¯‡ä¸»è¦ä»‹ç»ä¸€ä¸‹ä¸‰éƒ¨åˆ†</p>
<ul>
<li><strong>Threadçš„åŸºæœ¬æ¦‚å¿µï¼š</strong>çº¿ç¨‹æ˜¯ä»€ä¹ˆï¼Œä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼ŒJavaçš„çº¿ç¨‹ä¼˜å…ˆçº§</li>
<li><strong>ç”Ÿå‘½å‘¨æœŸï¼š</strong>ç”Ÿå‘½å‘¨æœŸçš„çŠ¶æ€ã€è½¬æ¢ã€ç›¸å…³æ–¹æ³•</li>
<li><strong>åˆ›å»ºå’Œä½¿ç”¨ï¼š</strong>çº¿ç¨‹çš„åˆ›å»ºçš„ä¸¤ç§æ–¹æ³•ã€å¸¸ç”¨æ–¹æ³•å¦‚sleepï¼Œyieldï¼ŒçŠ¶æ€è·å–ç­‰</li>
</ul>
<hr>

          <h3 id="96201de0">ThreadåŸºæœ¬æ¦‚å¿µ</h3><p><strong>ç¨‹åº(program)ï¼š</strong>æ˜¯ä¸ºå®Œæˆç‰¹å®šä»»åŠ¡ã€ç”¨æŸç§è¯­è¨€ç¼–å†™çš„ä¸€ç»„æŒ‡ä»¤çš„é›†åˆã€‚å³æŒ‡ä¸€æ®µé™æ€çš„ä»£ç ï¼Œé™æ€å¯¹è±¡</p>
<p><strong>è¿›ç¨‹(process)ï¼š</strong>æ˜¯ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œè¿‡ç¨‹ï¼Œæˆ–æ˜¯æ­£åœ¨è¿è¡Œçš„ä¸€ä¸ªç¨‹åºã€‚åŠ¨æ€è¿‡ç¨‹ï¼šæœ‰å®ƒè‡ªèº«çš„äº§ç”Ÿã€å­˜åœ¨å’Œæ¶ˆäº¡çš„è¿‡ç¨‹ã€‚ç¨‹åºæ˜¯é™æ€çš„ï¼Œè¿›ç¨‹æ˜¯åŠ¨æ€çš„</p>
<p><strong>çº¿ç¨‹(thread)ï¼š</strong>è¿›ç¨‹å¯è¿›ä¸€æ­¥ç»†åŒ–ä¸ºçº¿ç¨‹ï¼Œæ˜¯ä¸€ä¸ªç¨‹åºå†…éƒ¨çš„ä¸€æ¡æ‰§è¡Œè·¯å¾„ã€‚è‹¥ä¸€ä¸ªç¨‹åºå¯åŒä¸€æ—¶é—´æ‰§è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œå°±æ˜¯æ”¯æŒå¤šçº¿ç¨‹çš„</p>
<p>Javaè¯­è¨€çš„JVMå…è®¸ç¨‹åºè¿è¡Œå¤šä¸ªçº¿ç¨‹ï¼Œå®ƒé€šè¿‡java.lang.Threadç±»æ¥å®ç°ã€‚</p>

          <h4 id="431481a7">è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«</h4><p>ä¸€ä¸ªè¿›ç¨‹åŒ…å«å¤šä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹æ˜¯è¿›ç¨‹çš„ä¸€ä¸ªå­ä»»åŠ¡</p>

          <h4 id="f012ae55">Javaçš„çº¿ç¨‹ä¼˜å…ˆçº§</h4><p>ä¼˜å…ˆçº§çš„æ„ä¹‰å°±æ˜¯ä¼˜å…ˆçº§è¶Šé«˜ï¼Œè¶Šæœ‰å¯èƒ½å…ˆè·å¾—CPUèµ„æºï¼Œæˆ–è€…æ›´å¤šçš„CPUèµ„æº</p>
<p>ç‰¹ç‚¹ï¼š</p>
<ul>
<li><strong>ç»§æ‰¿æ€§ï¼š</strong>å­çº¿ç¨‹æŒæœ‰å’Œçˆ¶çº¿ç¨‹ä¸€æ ·çš„ä¼˜å…ˆçº§</li>
<li><strong>æ¦‚ç‡æ€§ï¼š</strong>é«˜ä¼˜å…ˆçº§ä»…ä»…æ˜¯æé«˜è·å–èµ„æºçš„æ¦‚ç‡ï¼Œè€Œä¸æ˜¯ç»å¯¹ä¼˜å…ˆï¼Œæ¢å¥è¯è¯´ï¼ŒJVMåªæ˜¯æŠŠä½ è®¾ç½®çš„ä¼˜å…ˆçº§ä½œä¸ºå‚è€ƒï¼Œå®é™…æ‰§è¡Œè¿˜æ˜¯çœ‹JVMè‡ªå·±çš„é€‰æ‹©ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹JVMéƒ½ä¼šå‚è€ƒä½ çš„ä¼˜å…ˆçº§</li>
</ul>

          <h4 id="5c5f3041">å®ˆæŠ¤çº¿ç¨‹ï¼ˆDaemon Threadï¼‰</h4><p>ä»æˆ‘çš„ç†è§£æ¥çœ‹ï¼Œçº¿ç¨‹çš„åˆ†ç±»å¯ä»¥æ ¹æ®çº¿ç¨‹çš„æœåŠ¡å¯¹è±¡æ¥åˆ†ä¸ºï¼š</p>
<ul>
<li><strong>ç”¨æˆ·çº¿ç¨‹ï¼š</strong>ç›´æ¥ä¸ºä¸šåŠ¡æœåŠ¡çš„çº¿ç¨‹</li>
<li><strong>å®ˆæŠ¤çº¿ç¨‹ï¼š</strong>ç›´æ¥ä¸ºçº¿ç¨‹æœåŠ¡çš„çº¿ç¨‹æˆ–è€…é—´æ¥ä¸ºä¸šåŠ¡æœåŠ¡çš„çº¿ç¨‹</li>
</ul>
<p>å®ˆæŠ¤çº¿ç¨‹çš„æ„ä¹‰åœ¨äº<strong>â€œå®ˆæŠ¤â€</strong>ï¼Œå½“çº¿ç¨‹ä¸­ä¸å­˜åœ¨ç”¨æˆ·çº¿ç¨‹äº†ï¼Œå®ˆæŠ¤çº¿ç¨‹å°±è‡ªåŠ¨é”€æ¯ï¼Œå¯¹äºå®ˆæŠ¤çº¿ç¨‹ï¼Œ<em>ã€ŠJavaå¤šçº¿ç¨‹ç¼–ç¨‹æ ¸å¿ƒæŠ€æœ¯ã€‹</em>ä¸€ä¹¦è¯´äº†ä¸€ä¸ªå¾ˆå¥½çš„æ¯”å–»ï¼š</p>
<blockquote>
<p>ä»»ä½•ä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹å°±æƒ³ä¸€ä¸ªä¿å§†ä¸€æ ·å®ˆæŠ¤ç€æ•´ä¸ªJVMä¸­æ‰€æœ‰çš„ç”¨æˆ·çº¿ç¨‹ï¼ˆåŸè¯æ˜¯éå®ˆæŠ¤çº¿ç¨‹ï¼‰ï¼Œåªè¦å½“å‰JVMé‡Œé¢è¿˜æœ‰ä¸€ä¸ªç”¨æˆ·çº¿ç¨‹æ²¡æœ‰ç»“æŸï¼Œå®ˆæŠ¤çº¿ç¨‹å°±å¾—ä¸€ç›´å·¥ä½œã€‚åªæœ‰å½“æœ€åä¸€ä¸ªç”¨æˆ·çº¿ç¨‹ç»“æŸçš„æ—¶å€™ï¼Œå®ˆæŠ¤çº¿ç¨‹æ‰è‡ªåŠ¨éšç€JVMä¸€åŒç»“æŸå·¥ä½œã€‚Daemonçº¿ç¨‹çš„ä½œç”¨å°±æ˜¯ä¸ºå…¶ä»–çº¿ç¨‹çš„è¿è¡Œæä¾›ä¾¿åˆ©ã€‚</p>
<p>å®ˆæŠ¤çº¿ç¨‹å…¸å‹çš„ä»£è¡¨å°±æ˜¯GCï¼Œå½“ç¨‹åºé‡Œé¢æ²¡æœ‰ç”¨æˆ·çº¿ç¨‹äº†ï¼Œä¹Ÿå°±æ²¡æœ‰åƒåœ¾å›æ”¶çš„å¿…è¦äº†ï¼Œæ‰§è¡ŒGCçš„çº¿ç¨‹è‡ªåŠ¨é”€æ¯ã€‚</p>
</blockquote>

          <h3 id="319f60ee">ç”Ÿå‘½å‘¨æœŸ</h3><table>
<thead>
<tr>
<th align="left">çŠ¶æ€åç§°</th>
<th align="left">è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td align="left">NEW</td>
<td align="left">åˆè¯•çŠ¶æ€ï¼Œåˆšåˆšnewå‡ºçº¿ç¨‹ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰è°ƒç”¨startæ–¹æ³•</td>
</tr>
<tr>
<td align="left">RUNNABLE</td>
<td align="left">è¿è¡ŒçŠ¶æ€ï¼ŒJavaçº¿ç¨‹ä¸­å°†æ“ä½œç³»ç»Ÿä¸­çš„â€œRUNNINGâ€å’Œâ€œREADYâ€ä¸¤ä¸ªçŠ¶æ€ç»Ÿç§°ä¸ºâ€œRUNNABLEâ€</td>
</tr>
<tr>
<td align="left">BLOCKED</td>
<td align="left">é˜»å¡çŠ¶æ€ï¼Œçº¿ç¨‹é˜»å¡äºé”</td>
</tr>
<tr>
<td align="left">WAITING</td>
<td align="left">ç­‰å¾…çŠ¶æ€ï¼Œè¡¨ç¤ºçº¿ç¨‹è¿›å…¥æ— æ—¶é—´é™åˆ¶çš„ç­‰å¾…ï¼Œçº¿ç¨‹éœ€è¦å…¶ä»–çº¿ç¨‹åšä¸€äº›é€šçŸ¥æˆ–è€…ä¸­æ–­åŠ¨ä½œ</td>
</tr>
<tr>
<td align="left">TIMED_WAITING</td>
<td align="left">è¶…æ—¶ç­‰å¾…çŠ¶æ€ï¼Œè¡¨ç¤ºçº¿ç¨‹è¿›å…¥æœ‰æ—¶é—´é™åˆ¶çš„ç­‰å¾…ï¼Œåœ¨æ—¶é—´é™åˆ¶å†…å¯ä»¥è¿›è¡Œä¸­æ–­æˆ–è€…é€šçŸ¥æ“ä½œï¼Œè¶…æ—¶åˆ™è‡ªè¡Œè¿”å›</td>
</tr>
<tr>
<td align="left">TERMINATED</td>
<td align="left">ç»ˆæ­¢çŠ¶æ€ï¼Œçº¿ç¨‹å·²ç»æ‰§è¡Œå®Œæ¯•</td>
</tr>
</tbody></table>
<p>
        <div class="_showpic_776bfe38 showpicbtn">Loading images >></div>
        <img href=https://image.youyinnn.top/TIM%E5%9B%BE%E7%89%8720180710172525.png class="_pic_776bfe38 hidepic" picId="776bfe38"></img>
        <script>
            {
                let imgself776bfe38s = document.getElementsByClassName('_pic_776bfe38')
                let showpicbtn776bfe38s = document.getElementsByClassName('_showpic_776bfe38')
                let isInViewPortOfTwo776bfe38 = function () {
                    const viewPortHeight = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight 
                    const top = imgself776bfe38s[0].getBoundingClientRect() && imgself776bfe38s[0].getBoundingClientRect().top
                    if (top  <= viewPortHeight + 300) {
                        for (el of imgself776bfe38s) {
                            el.src = el.getAttribute('href')
                            el.classList.add('showpic')
                            window.removeEventListener('scroll', isInViewPortOfTwo776bfe38)
                            isInViewPortOfTwo776bfe38 = null
                        }
                        for (el of showpicbtn776bfe38s) {
                            el.style.display = 'none'
                        }
                    }
                }
                window.addEventListener('scroll', isInViewPortOfTwo776bfe38)
            }
        </script>
    </p>

          <h3 id="4d807567">çº¿ç¨‹åˆ›å»ºä¸ä½¿ç”¨</h3>
          <h4 id="8ff5c406">åˆ›å»º</h4><p><strong>çº¿ç¨‹çš„å®ç°æ–¹æ³•ï¼š</strong></p>
<ol>
<li>ç»§æ‰¿Threadç±»</li>
<li>å®ç°Runnableæ¥å£å¹¶å®ç°run()æ–¹æ³•</li>
</ol>

          <h5 id="5887955e">æ–¹å¼1ï¼šç»§æ‰¿Threadç±»</h5><pre><code class="language-java">public class testThread {
    public static void main(String[] args) {
        //3ã€åˆ›å»ºå­ç±»ç‹¬å¯¹è±¡
        SubThread subThread = new SubThread();
        //4ã€è°ƒç”¨çº¿ç¨‹startæ–¹æ³• å¯åŠ¨çº¿ç¨‹ è°ƒç”¨runæ–¹æ³•
        //5ã€runæ–¹æ³• å¹¶ä¸å¯åŠ¨çº¿ç¨‹
        subThread.start();
    }
}

//1ã€åˆ›å»ºä¸€ä¸ªç»§æ‰¿Threadç±»çš„å­ç±»
class SubThread extends Thread{
    //2ã€é‡å†™Threadç±»çš„runæ–¹æ³•ï¼Œæ–¹æ³•å†…å®ç°è¿™ä¸ªçº¿ç¨‹éœ€è¦åšçš„åŠŸèƒ½ã€‚
    @Override
    public void run() {
        super.setName(&quot;å­çº¿ç¨‹&quot;);
        for (int i = 0; i&lt; 10 ; ++i){
            System.out.println(Thread.currentThread().getName()+&quot;:çº¿ç¨‹æ–¹æ³•&quot;);
        }
    }
}</code></pre>

          <h5 id="7800f47f">æ–¹å¼2ï¼šå®ç°Runnableæ¥å£</h5><pre><code class="language-java">public class testImplRunnable {
    public static void main(String[] args) {
        PrintNumber printNumber = new PrintNumber();
        //å¯åŠ¨çº¿ç¨‹ æ‰§è¡ŒThreadå¯¹è±¡æ„é€ æ—¶ä¼ å…¥çš„å¯¹è±¡çš„runæ–¹æ³•
        Thread thread = new Thread(printNumber);
        thread.start();

        Thread thread2 = new Thread(printNumber);
        thread2.start();
    }
}

class PrintNumber implements Runnable{

    @Override
    public void run() {
        for (int i = 0 ; i &lt; 10 ; ++i){
            System.out.println(i);
        }
    }
}</code></pre>

          <h5 id="297e9abf">ä¸¤ç§æ–¹å¼çš„å¯¹æ¯”</h5><ul>
<li><strong>ç»§æ‰¿æ–¹å¼</strong>è®©ç±»åœ¨ç»§æ‰¿ä¸Šé¢çš„é€‰æ‹©å—é™ï¼Œ<strong>æ¥å£å®ç°æ–¹å¼</strong>åˆ™å¾ˆéšæ„</li>
<li><strong>ç»§æ‰¿æ–¹å¼</strong>è®©ç±»æ‹¥æœ‰ä¸€äº›<strong>çº¿ç¨‹å†…å»ºçš„æ–¹æ³•</strong>ä¾‹å¦‚<code>yield()</code>ï¼Œ<strong>æ¥å£å®ç°æ–¹å¼</strong>åˆ™æ²¡æœ‰</li>
</ul>

          <h5 id="7deb404d">start() å’Œ run()çš„åŒºåˆ«</h5><ol>
<li><p>æ˜¯å¦åˆ›å»ºæ–°çº¿ç¨‹ï¼š</p>
<pre><code class="language-java">public class testThread {
    public static void main(String[] args) {
        SubThread subThread = new SubThread();
        // startæ–¹æ³•  åˆ›å»ºæ–°çº¿ç¨‹    ç”±æ–°çº¿ç¨‹å»è°ƒç”¨runæ–¹æ³•
        subThread.start();
        // runæ–¹æ³•    å¹¶ä¸å¯åŠ¨æ–°çº¿ç¨‹ ç”±å½“å‰çº¿ç¨‹è°ƒç”¨runæ–¹æ³•
        subThread.run();
    }
}
class SubThread extends Thread{
    @Override
    public synchronized void start() {
        super.start();
        System.out.println(Thread.currentThread().getName() + &quot; start&quot;);
    }
    @Override
    public void run() {
        for (int i = 0; i&lt; 3 ; ++i){
            System.out.println(Thread.currentThread().getName()+&quot;:çº¿ç¨‹æ–¹æ³•&quot;);
        }
    }
}</code></pre>
<p> Output:</p>
<pre><code class="language-console">main start
main:çº¿ç¨‹æ–¹æ³•
Thread-0:çº¿ç¨‹æ–¹æ³•
Thread-0:çº¿ç¨‹æ–¹æ³•
Thread-0:çº¿ç¨‹æ–¹æ³•
main:çº¿ç¨‹æ–¹æ³•
main:çº¿ç¨‹æ–¹æ³•</code></pre>
</li>
<li><p>startåªèƒ½è°ƒç”¨1æ¬¡ï¼Œè€Œrunå¯ä»¥è°ƒç”¨æ— æ•°æ¬¡ï¼Œå°±åƒè°ƒç”¨ä¸€èˆ¬çš„å¯¹è±¡æ–¹æ³•ä¸€æ ·ï¼›</p>
</li>
<li><p>startæ–¹æ³•æ˜¯Threadç±»å®ç°çš„ï¼Œè€Œrunæ–¹æ³•æ˜¯æ¥è‡ªäºRunnableæ¥å£çš„ï¼›</p>
</li>
<li><p>å¦‚æœä½ é‡å†™äº†startæ–¹æ³•ï¼Œé‚£ä¹ˆstartæ–¹æ³•ä¸­çš„å½“å‰çº¿ç¨‹æ˜¯çˆ¶çº¿ç¨‹ï¼Œè€Œä¸æ˜¯æ–°çº¿ç¨‹ï¼›</p>
</li>
</ol>

          <h4 id="a89869ed">ä½¿ç”¨</h4>
          <h5 id="dad0bdec">currentThread()æ–¹æ³•</h5><p>è¿™ä¸ªæ–¹æ³•è·å–æ­£åœ¨è°ƒç”¨å½“å‰ä»£ç æ®µçš„çº¿ç¨‹çš„<strong>çº¿ç¨‹å¯¹è±¡</strong>ï¼Œè·å–åˆ°çº¿ç¨‹å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥è·å–çº¿ç¨‹çš„<strong>åå­—ã€çŠ¶æ€ã€IDå·ã€çº¿ç¨‹ä¼˜å…ˆçº§ã€æ˜¯å¦å¤„äºç»ˆç«¯ã€æ˜¯å¦å¤„äºæ´»åŠ¨çŠ¶æ€</strong>ç­‰ä¿¡æ¯ï¼Œè¿™äº›APIåœ¨åé¢æˆ‘ä»¬ä¼šä¸€ä¸ªä¸ªè®²åˆ°</p>
<pre><code class="language-java">@Test
public void testCurr(){
    System.out.println(Thread.currentThread().getName()); //main
    System.out.println(Thread.currentThread().isAlive()); //true
    System.out.println(Thread.currentThread().getState()); //RUNNABLE
    System.out.println(Thread.currentThread().getPriority()); //5
}</code></pre>

          <h5 id="c4fcbde7">isAlive()æ–¹æ³•</h5><p>ä½œç”¨æ˜¯åˆ¤æ–­å½“å‰çº¿ç¨‹æ˜¯å¦<strong>å­˜æ´»</strong>ï¼Œè¿™ä¸ªå­˜æ´»çš„ç•Œå®šæ˜¯ï¼š<strong>å¦‚æœçº¿ç¨‹å¤„äºæ­£åœ¨è¿è¡Œæˆ–è€…å‡†å¤‡å¼€å§‹è¿è¡Œçš„çŠ¶æ€ï¼Œåˆ™åˆ¤å®šçº¿ç¨‹å­˜æ´»</strong></p>

          <h5 id="b3c69907">sleep()æ–¹æ³•</h5><p>è®©å½“å‰çº¿ç¨‹ç¡ä¸Š<strong>næ¯«ç§’</strong></p>
<pre><code class="language-java">@Test
public void testSleep() throws InterruptedException {
    Runnable sleep = () -&gt; {
        try {
            System.out.println(Thread.currentThread().getName() + &quot; sleep&quot;);
            Thread.sleep(10 * 1000);
            System.out.println(&quot;sleep done&quot;);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    };
    Thread t = new Thread(sleep, &quot;sleepThread&quot;);
    t.start();
    //t.run();
    Thread.sleep(1000);
    System.out.println(t.getState() + &quot;  &quot; + t.getName());
}</code></pre>
<p>åœ¨<strong>lineï¼š13-14</strong>ï¼Œæˆ‘ä»¬éœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li>t.<strong>start()æ–¹æ³•</strong>æ˜¯ä»¥<strong>æ–°å¼€ä¸€ä¸ªçº¿ç¨‹</strong>çš„æ–¹å¼è¿è¡Œ<strong>sleep.run()</strong></li>
<li>start.<strong>run()æ–¹æ³•</strong>æ˜¯ç›´æ¥åœ¨<strong>å½“å‰çº¿ç¨‹</strong>ä¸­è¿è¡Œ<strong>sleep.run()</strong></li>
</ul>
<p>æ‰€ä»¥å½“æˆ‘ä»¬ä»¥<strong>startæ–¹å¼</strong>å»å¯åŠ¨ç¨‹åºçš„æ—¶å€™ï¼Œè¾“å‡ºç»“æœä¸ºï¼š</p>
<pre><code class="language-console">sleepThread sleep
TIMED_WAITING  sleepThread</code></pre>
<p>å¯ä»¥çœ‹åˆ°çº¿ç¨‹åå­—ä¸º<strong>sleepThread</strong>ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼š</p>
<ul>
<li>è¿™ä¸ªç¨‹åºè¿˜æœ‰å¦å¤–ä¸€ä¸ªç›®çš„å°±æ˜¯ä¸ºäº†<strong>æ£€æµ‹ç¡çœ ä¸­çš„çº¿ç¨‹åˆ°åº•æ˜¯å¤„äºä»€ä¹ˆçŠ¶æ€</strong>ï¼Œä»ç»“æœå¾—çŸ¥ï¼Œæ˜¯<strong>TIMED_WAITINGçŠ¶æ€</strong></li>
<li>ä¸ºäº†å¯ä»¥æ£€æµ‹åˆ°ç¡çœ çº¿ç¨‹ï¼Œæˆ‘ä»¬<strong>åœ¨mainçº¿ç¨‹ä¸­ä¹Ÿç¡äº†1ç§’</strong>ï¼ŒåŸå› æ˜¯<strong>sleepThread</strong>åªæ˜¯<strong>mainçº¿ç¨‹</strong>çš„ä¸€ä¸ª<strong>å­çº¿ç¨‹</strong>ï¼Œ<strong>å¦‚æœmainçº¿ç¨‹æŒ‚äº†ï¼Œåˆ™å…¶å­çº¿ç¨‹ä¹Ÿå°±è·Ÿç€æŒ‚</strong>ï¼Œæ‰€ä»¥ç†è®ºä¸Šæ¥è¯´ï¼Œæ•´ä¸ªç¨‹åºå¹¶ä¸ä¼šçœ‹åˆ°<strong>lineï¼š7</strong>æ‰€è¾“å‡ºçš„è¯­å¥</li>
</ul>
<p>å½“æˆ‘ä»¬ä»¥<strong>runæ–¹å¼</strong>å¯åŠ¨çº¿ç¨‹çš„æ—¶å€™ï¼Œè¾“å‡ºä¸ºï¼š</p>
<pre><code class="language-console">main sleep
sleep done
NEW  sleepThread</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œæ‰§è¡Œ<strong>sleep.run</strong>æ–¹æ³•çš„ç¡®å®æ˜¯<strong>mainçº¿ç¨‹</strong>ï¼Œè€Œä¸”æ•´ä¸ªç¨‹åºåœ¨è¾“å‡ºç¬¬ä¸€è¡Œçš„æ—¶å€™ï¼Œæ˜¯ç¡äº†10ç§’å†è¾“å‡ºæ¥ä¸‹æ¥çš„ï¼Œç„¶åæˆ‘ä»¬çš„<strong>sleepThread</strong>ä¹Ÿæ˜¯æ²¡æœ‰è¿è¡Œï¼Œè¿˜æ˜¯å¤„äº<strong>NEWçŠ¶æ€</strong></p>

          <h6 id="479c457a">æ³¨æ„</h6><blockquote>
<p>åœ¨çº¿ç¨‹çš„<strong>sleep</strong>çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœè°ƒç”¨äº†çº¿ç¨‹çš„ä¸­æ–­æ–¹æ³•<code>interrupt()</code>ï¼Œåˆ™åœ¨sleepä»£ç å¤„ä¼šæŠ›å‡º<code>InterruptedException</code>å¼‚å¸¸ï¼Œè¿™ä¸ªå¼‚å¸¸ä¼š<strong>æ¸…é™¤çº¿ç¨‹çš„ä¸­æ–­æ ‡è¯†</strong>ï¼Œæ‰€ä»¥ä½ ä¹‹å‰è°ƒç”¨<code>interrupt()</code>æ–¹æ³•è®¾ç½®çš„ä¸­æ–­æ ‡è¯†å¯èƒ½æ²¡ç”¨äº†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè¦åœ¨æœ‰<strong>sleep</strong>ä»£ç çš„çº¿ç¨‹ä¸­ä½¿ç”¨ä¸­æ–­æ ‡è¯†å»æœ‰æ•ˆåœ°è¿›è¡Œç»ˆç«¯æ“ä½œçš„è¯ï¼Œé‚£ä¹ˆ<code>catch(){}</code>è¯­å¥å—é‡Œå°±ä¸èƒ½ä»€ä¹ˆä¹Ÿä¸åšï¼Œå¿…é¡»åœ¨<code>catch(){}</code>ä¸­æœ‰ä¸­æ–­çš„é€»è¾‘ï¼Œå¦åˆ™å¯èƒ½è¾¾ä¸åˆ°ä¸­æ–­çš„æ•ˆæœã€‚</p>
</blockquote>

          <h5 id="82a824fc">join()æ–¹æ³•</h5><p>åœ¨å½“å‰çº¿ç¨‹ä¸­è°ƒç”¨<code>someThread.join()</code>æ–¹æ³•ï¼Œå°±æ˜¯æš‚åœå½“å‰çº¿ç¨‹ï¼Œå¯åŠ¨someThreadï¼Œåªæœ‰å½“someThreadæ‰§è¡Œå®Œæ¯•æˆ–è€…è¿™ä¸ªæ–¹æ³•ä¼šè¢«<code>interrupt()</code>æ‰“æ–­ï¼Œè€ŒæŠ›å‡ºä¸­æ–­å¼‚å¸¸ã€‚</p>
<p><code>join()</code>è¿˜æœ‰<code>join(long timeout)</code>ï¼Œå…¶å†…éƒ¨å®ç°å¦‚ï¼š</p>
<pre><code class="language-java">public final synchronized void join(long millis) throws InterruptedException {
    long base = System.currentTimeMillis();
    long now = 0;
    if (millis &lt; 0) {
        throw new IllegalArgumentException(&quot;timeout value is negative&quot;);
    }
    if (millis == 0) {
        while (isAlive()) {
            wait(0);
        }
    } else {
        while (isAlive()) {
            long delay = millis - now;
            if (delay &lt;= 0) {
                break;
            }
            wait(delay);
            now = System.currentTimeMillis() - base;
        }
    }
}</code></pre>
<p>å¯ä»¥çœ‹åˆ°ï¼Œjoinæ–¹æ³•å°±æ˜¯å¦‚æœæœ¬çº¿ç¨‹è¿˜å­˜æ´»ï¼Œå°±æ— é™ç­‰å¾…è‡ªå·±ï¼Œç»™åˆ«çš„çº¿ç¨‹è®©å‡ºæœºä¼š</p>

          <h5 id="29d6ef98">yield()æ–¹æ³•</h5><p>è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯<strong>æ”¾å¼ƒå½“å‰çš„CPUèµ„æº</strong>ï¼Œå°†å®ƒè®©ç»™å…¶ä»–çš„ä»»åŠ¡å»å ç”¨CPUæ‰§è¡Œï¼Œ<strong>ä½†æ˜¯æ”¾å¼ƒçš„æ—¶é—´ä¸ç¡®å®šï¼Œæœ‰å¯èƒ½åˆšä¸€æ”¾å¼ƒï¼Œé©¬ä¸Šå°±æŠ¢å›æ¥äº†ï¼Œæœ‰ç‚¹ä¸è¦è„¸ï¼</strong></p>

          <h5 id="b944b2d1">getState()æ–¹æ³•</h5><p>è·å–ä¸€ä¸ªStateå¯¹è±¡ï¼Œè¡¨ç¤ºå½“å‰çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</p>

          <h3 id="a8d39efa">Objectæ–¹æ³•</h3>
          <h4 id="6769ec80">wait(long timeout)</h4><p>ä½œç”¨æ˜¯ä½¿å½“å‰æ‰§è¡Œä»£ç çš„<strong>çº¿ç¨‹ï¼ˆas Tï¼‰</strong>è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œç”±äº<code>wait()</code>æ–¹æ³•æ˜¯Objectç±»çš„æ–¹æ³•ï¼Œç”¨æ¥å°†<strong>å½“å‰çº¿ç¨‹ï¼ˆTï¼‰</strong>ç½®å…¥â€œç­‰å¾…é˜Ÿåˆ—â€ä¸­ã€‚æ‰€ä»¥éœ€è¦æ˜¾å¼åœ°ä½¿ç”¨<strong>synchronized</strong>å—åŒ…è£¹èµ·æ¥ï¼Œåœ¨synchronizedå—ä¸­å†æ¬¡è·å–<strong>è¯¥é”ï¼ˆè°ƒç”¨<code>wait()</code>çš„å¯¹è±¡çš„å¯¹è±¡é”ï¼Œas OLï¼‰</strong>ï¼Œæ‰èƒ½è°ƒç”¨<code>wait()</code>æ–¹æ³•ï¼Œå¦åˆ™ä¼šæŠ›å‡º<code>java.lang.IllegalMonitorStateException</code>å¼‚å¸¸</p>
<blockquote>
<p>æ³¨æ„ï¼š</p>
<ol>
<li>åªæœ‰çº¿ç¨‹åœ¨è·å–äº†è¯¥é”å¯¹è±¡çš„é”ä¹‹åï¼ˆåœ¨è¯¥é”å¯¹è±¡çš„synchronizedå—æˆ–è€…æ–¹æ³•ä¸­ï¼‰ï¼Œæ‰èƒ½è°ƒç”¨è¯¥å¯¹è±¡çš„<code>wait()</code>æ–¹æ³•ï¼Œå¦åˆ™æŠ›å‡ºå¼‚å¸¸ï¼›</li>
<li>åœ¨å“ªä¸ªé”å¯¹è±¡ä¸Šè°ƒç”¨<code>wait()</code>æ–¹æ³•ï¼Œå°±é‡Šæ”¾å“ªä¸ªé”å¯¹è±¡ï¼›</li>
<li>æ— è®ºtimeoutä¸ºå¤šå°‘ï¼Œæ€»æ˜¯éœ€è¦ç­‰åˆ°è¯¥åŒæ­¥åŒºåŸŸå†æ¬¡ç«äº‰åˆ°é”å¯¹è±¡æ—¶æ‰èƒ½è§£é™¤ç­‰å¾…ï¼Œå¦‚æœå…¶ä»–åŒæ­¥åŒºåŸŸä¸€ç›´ä¸æ”¾å¼ƒè¯¥é”å¯¹è±¡ï¼Œé‚£ä¹ˆå‰åŒæ­¥åŒºåŸŸä¹Ÿä¸€ç›´è·å–ä¸åˆ°è¯¥é”å¯¹è±¡ï¼›</li>
</ol>
</blockquote>
<p>è°ƒç”¨<code>wait()</code>æ–¹æ³•ä¹‹åï¼Œå½“å‰çº¿ç¨‹<strong>é©¬ä¸Šï¼ˆä»waité‚£ä¸€è¡Œå¼€å§‹é©¬ä¸Šæ”¾é”ï¼Œè€Œä¸æ˜¯ç›´åˆ°é€€å‡ºsyncå—ï¼‰</strong>é‡Šæ”¾<strong>è¯¥é”ï¼ˆOLï¼‰</strong>ï¼Œå¹¶è¿›å…¥ç­‰å¾…é˜Ÿåˆ—<strong>ï¼ˆå¯¹è±¡é”å¯¹åº”å¯¹è±¡çš„ç­‰å¾…é˜Ÿåˆ—ï¼‰</strong>ï¼Œæ­¤æ—¶çº¿ç¨‹è¿›å…¥suspendçŠ¶æ€</p>
<p>å¦‚æœtimeoutè®¾ç½®ä¸º0çš„è¯åˆ™æ²¡æœ‰è¶…æ—¶æ—¶é—´ï¼Œä¸€ç›´ç­‰åˆ°notify</p>
<p>è‹¥è¦<strong>çº¿ç¨‹T</strong>ä»<code>wait()</code>ä¸­è¿”å›ï¼š</p>
<ul>
<li><strong>å…¶ä»–çº¿ç¨‹</strong>ï¼Œè·å–åˆ°<strong>OL</strong>ï¼Œå¹¶ä¸”è°ƒç”¨è¯¥å¯¹è±¡çš„<code>notify()</code>æ–¹æ³•ï¼Œå¹¶ä¸”<strong>çº¿ç¨‹T</strong>ï¼Œåœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­<strong>éšæœºåœ°ï¼ˆarbitrarilyï¼‰</strong>è¢«é€‰ä¸­å”¤é†’</li>
<li><strong>å…¶ä»–çº¿ç¨‹</strong>ï¼Œè·å–åˆ°<strong>OL</strong>ï¼Œå¹¶ä¸”è°ƒç”¨è¯¥å¯¹è±¡çš„<code>notifyAll()</code>æ–¹æ³•</li>
<li><strong>å…¶ä»–çº¿ç¨‹</strong>ï¼Œè°ƒç”¨äº†<strong>çº¿ç¨‹T</strong>çš„<code>interrupt()</code>æ–¹æ³•ï¼Œæ‰€ä»¥éœ€è¦å¤„ç†ä¸­æ–­å¼‚å¸¸</li>
<li>é™¤étimeoutä¸æ˜¯0ï¼Œåˆ°æœŸè¶…æ—¶è‡ªå·±è¿”å›</li>
</ul>
<p><strong>çº¿ç¨‹T</strong>è¢«<strong>å”¤é†’ï¼ˆnotifyï¼‰</strong>ä¹‹åï¼Œä»ç„¶å’Œå…¶ä»–çº¿ç¨‹åœ¨é€šå¸¸çš„æƒ…å†µä¸‹ï¼Œå†æ¬¡ç«äº‰<strong>OL</strong>ï¼Œä»¥è·å–è¿›å…¥åŒæ­¥çš„æƒåŠ›ï¼Œä¸€æ—¦è·å–åˆ°æƒåŠ›ï¼Œ<strong>çº¿ç¨‹T</strong>å°±ä¼šæ¢å¤åˆ°waitæ—¶å€™å®Œå…¨ä¸€æ ·çš„çŠ¶æ€ï¼Œç»§ç»­å·¥ä½œã€‚</p>
<p>ç­‰å¾…çŠ¶æ€ä¸­çš„çº¿ç¨‹ä¹Ÿå¯ä»¥ä¸å¿…è¢«å…¶ä»–çº¿ç¨‹å”¤é†’ã€æ‰“æ–­ã€æˆ–è€…ç­‰å¾…è¶…æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªè¡Œ<strong>æ£€æµ‹</strong>å”¤é†’çš„æ¡ä»¶ï¼Œæ»¡è¶³æ¡ä»¶å°±ä¸å†ç­‰å¾…ï¼Œæ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬æ¨èä½ åœ¨ä½¿ç”¨<code>wait()</code>çš„æ—¶å€™ä½¿ç”¨ä»¥ä¸‹è¿™æ ·çš„loopï¼š</p>
<pre><code class="language-java">synchronized (obj) {
 while (&lt;condition does not hold&gt;)
     obj.wait(timeout);
 ... // Perform action appropriate to condition
}</code></pre>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<strong>çº¿ç¨‹T</strong>åœ¨<code>wait()</code>çš„è¿‡ç¨‹ä¸­ï¼Œä»…é‡Šæ”¾<strong>OL</strong>é”ï¼Œçº¿ç¨‹åŸæ¥æŒæœ‰çš„é”ä»ä¼šéšç€çº¿ç¨‹è¿›å…¥waitçŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥åšä¸ªç®€å•çš„æµ‹è¯•ï¼š</p>
<pre><code class="language-java">public class WaitTest {

    private static String lockA = &quot;la&quot;;
    private static String lockB = &quot;lb&quot;;

    public static void main(String[] args) {
        new Thread(() -&gt; {
            synchronized (lockA) {
                System.out.println(&quot;T1 got locak A&quot;);
                synchronized (lockB) {
                    System.out.println(&quot;T1 got locak B&quot;);
                    try {
                        System.out.println(&quot;T1 wait, released lockA for now&quot;);
                        lockA.wait(5000);
                        System.out.println(&quot;T1 come back from wait, and got lockA again&quot;);
                    } catch (InterruptedException e) {
                        e.printStackTrace();
                    }
                }
                System.out.println(&quot;T1 released lockB&quot;);
            }
            System.out.println(&quot;T1 released lockA finally&quot;);
        }).start();
        new Thread(() -&gt; {
            System.out.println(&quot;T2 sleep 3 seconds&quot;);
            try {
                Thread.sleep(3000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            synchronized (lockA) {
                System.out.println(&quot;T2 got lockA, and sleep 6 sec&quot;);
                try {
                    Thread.sleep(6000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
            System.out.println(&quot;T2 released lockA&quot;);
        }).start();
        new Thread(() -&gt; {
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            System.out.println(&quot;T3 wanna get lockB&quot;);
            synchronized (lockB) {
                System.out.println(&quot;T3 got lockB&quot;);
            }
            System.out.println(&quot;T3 released lockB&quot;);
        }).start();
    }
}</code></pre>
<p>è¾“å‡ºï¼š</p>
<pre><code class="language-console">T1 got locak A
T2 sleep 3 seconds
T1 got locak B
T1 wait, released lockA for now
T3 wanna get lockB
T2 got lockA, and sleep 6 sec
T2 released lockA
T1 come back from wait, and got lockA again
T1 released lockB
T1 released lockA finally
T3 got lockB
T3 released lockB</code></pre>
<p>æˆ‘ä»¬éœ€è¦æ³¨æ„2ç‚¹ï¼š</p>
<ol>
<li>åœ¨14è¡Œè™½ç„¶è®¾ç½®äº†è¶…æ—¶æ—¶é—´æ˜¯5ç§’ï¼Œä½†æ˜¯ä»æ—§ç­‰å¾…äº†6ç§’ï¼Œå› ä¸ºt2å æœ‰äº†lockA6ç§’ä¹‹ä¹…</li>
<li>è™½ç„¶t1åœ¨æŸæ—¶åˆ»é‡Šæ”¾äº†lockAï¼Œä½†æ˜¯t1æŒæœ‰çš„lockBè¿˜æ²¡é‡Šæ”¾ï¼Œæœ€åt3è¿˜æ˜¯å¾—ç­‰åˆ°t1é‡Šæ”¾äº†lockBä¹‹åæ‰èƒ½è·å–åˆ°lockB</li>
</ol>
<p>æ€»ç»“ä¸€ä¸‹æ—¶é—´çº¿ï¼ŒæŒ‰ç…§ç»å¯¹æ—¶é—´æ¥è¯´ï¼š</p>
<ul>
<li><p>0ç§’å¼€å§‹ä¸ä¹…ï¼š</p>
<ul>
<li><p>T1æ‹¿åˆ°Aé”ï¼Œéšåæ‹¿åˆ°Bé”ï¼Œç„¶ååœ¨Aé”ä¸Šwaitï¼Œå¹¶ä¸”è¶…æ—¶5ç§’ï¼›</p>
</li>
<li><p>T2å¼€å§‹æ²‰ç¡3ç§’</p>
</li>
<li><p>T3å¼€å§‹æ²‰ç¡1ç§’</p>
<blockquote>
<p>è¿™æ—¶Aé”å·²ç»é‡Šæ”¾ï¼ŒBé”è¢«T1æŠ“ä½</p>
</blockquote>
</li>
</ul>
</li>
<li><p>1ç§’æ—¶ï¼š</p>
<ul>
<li>T3é†’æ¥ï¼Œåœ¨Bé”çš„é—¨å‰BLOCKä½ï¼Œå› ä¸ºè¿™æ—¶å€™Bé”è¢«T1æŠ“ä½ç€ï¼›</li>
<li>T2è¿˜åœ¨ç¡ï¼Œè¿˜æœ‰2ç§’ï¼›</li>
<li>T1åœ¨ç­‰å¾…Aé”è¶…æ—¶ï¼Œè¿˜å‰©4ç§’ï¼›</li>
</ul>
</li>
<li><p>2ç§’æ—¶ï¼š</p>
<ul>
<li>T1åœ¨ç­‰å¾…Aé”è¶…æ—¶ï¼Œè¿˜å‰©3ç§’ï¼›</li>
<li>T2è¿˜åœ¨ç¡ï¼Œè¿˜æœ‰1ç§’ï¼›</li>
<li>T3ä»åœ¨ç­‰Bé”ï¼›</li>
</ul>
</li>
<li><p>3ç§’æ—¶ï¼š</p>
<ul>
<li>T2é†’æ¥ï¼Œæ‹¿åˆ°Aé”ï¼Œå¹¶æ²‰ç¡6ç§’ï¼›</li>
<li>T1åœ¨ç­‰å¾…Aé”è¶…æ—¶ï¼Œè¿˜å‰©2ç§’ï¼›</li>
<li>T3ä»åœ¨ç­‰Bé”ï¼›</li>
</ul>
</li>
<li><p>5ç§’æ—¶ï¼š</p>
<ul>
<li>T1ç­‰å¾…Aé”è¶…æ—¶ç»“æŸï¼Œä½†æ˜¯Aé”è¢«T2æŠ“ä½ç¡è§‰äº†ï¼Œè¿˜å‰©1ç§’ï¼Œæ‰€ä»¥T1 BLOCKä½ï¼›</li>
<li>T2è¿˜æœ‰1ç§’è‹é†’ï¼›</li>
<li>T3å¿«å“­äº†ï¼›</li>
</ul>
</li>
<li><p>6ç§’æ—¶ï¼š</p>
<ul>
<li>T2é†’æ¥ï¼Œæ”¾å¼€Aé”ï¼›</li>
<li>T1æ‹¿åˆ°Aé”ï¼Œæ²¡äº‹å¹²äº†ï¼Œæ”¾å¼€Bé”ï¼Œæ”¾å¼€Aé”ï¼›</li>
<li>T3ç»ˆäºæ‹¿åˆ°Bé”äº†ï¼›</li>
</ul>
</li>
</ul>

          <h4 id="1f5647d8">notify()</h4><p>å”¤é†’åœ¨è¯¥å¯¹è±¡<strong>ç­‰å¾…é˜Ÿåˆ—</strong>ä¸­çš„ä¸€ä¸ªç­‰å¾…çº¿ç¨‹ï¼Œåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…çš„çº¿ç¨‹æ˜¯è¢«<strong>éšæœºé€‰å–</strong>å”¤é†’çš„ï¼Œä¸”å¿…é¡»æ˜¯ç”±è°ƒç”¨è¯¥å¯¹è±¡<code>wait()</code>æ–¹æ³•è€Œè¿›å…¥çš„ç­‰å¾…é˜Ÿåˆ—</p>
<p>è¢«å”¤é†’çš„çº¿ç¨‹ä¼šå’Œå…¶ä»–çº¿ç¨‹ä¸€æ ·ï¼Œåœ¨åŒæ ·çš„æƒ…å†µä¸‹ä¸€èµ·ç«äº‰è¯¥<strong>å¯¹è±¡çš„åŒæ­¥é”ï¼ˆas OLï¼‰</strong></p>
<blockquote>
<p>ç»†èŠ‚è¯´æ˜ï¼š</p>
<ol>
<li>è¢«notifyé€šçŸ¥çš„å¯¹è±¡ï¼Œå¹¶ä¸æ˜¯é©¬ä¸Šå°±è·å–<strong>OL</strong>ï¼Œè€Œæ˜¯è¿˜éœ€è¦ç§¯æç«äº‰</li>
<li>notifyä¹‹åï¼Œå’Œwaitä¸ä¸€æ ·çš„æ˜¯ï¼Œå¹¶ä¸æ˜¯é©¬ä¸Šæ”¾é”ï¼Œè€Œæ˜¯ç›´åˆ°é€€å‡ºsyncåŒºåŸŸä¹‹åæ‰é‡Šæ”¾é”</li>
</ol>
</blockquote>
<p>æœ¬æ–¹æ³•åªèƒ½åœ¨å½“å‰çº¿ç¨‹<strong>æŒæœ‰è¯¥å¯¹è±¡é”çš„æ—¶å€™ï¼Œæ‰èƒ½è°ƒç”¨è¯¥å¯¹è±¡çš„<code>notify()</code>æ–¹æ³•</strong>ï¼š</p>
<ul>
<li>By executing a synchronized instance method of that object.</li>
<li>By executing the body of a <code>synchronized</code> statement that synchronizes on the object.</li>
<li>For objects of type <code>Class,</code> by executing a synchronized static method of that class.</li>
</ul>
<p>å¦åˆ™ä¼šæŠ›å‡º<code>java.lang.IllegalMonitorStateException</code>å¼‚å¸¸</p>

          <h4 id="a3164266">notifyAll()</h4><p>å”¤é†’åœ¨è¯¥å¯¹è±¡<strong>ç­‰å¾…é˜Ÿåˆ—</strong>ä¸­çš„æ‰€æœ‰ç­‰å¾…çº¿ç¨‹ï¼Œä¸”å¿…é¡»æ˜¯ç”±è°ƒç”¨è¯¥å¯¹è±¡<code>wait()</code>æ–¹æ³•è€Œè¿›å…¥çš„ç­‰å¾…é˜Ÿåˆ—</p>
<p>è¢«å”¤é†’çš„æ‰€æœ‰çº¿ç¨‹ä¼šå’Œå…¶ä»–çº¿ç¨‹ä¸€æ ·ï¼Œåœ¨åŒæ ·çš„æƒ…å†µä¸‹ä¸€èµ·ç«äº‰è¯¥<strong>å¯¹è±¡çš„åŒæ­¥é”ï¼ˆas OLï¼‰</strong></p>

          <h4 id="fba275b2">è®¨è®ºä¸€ä¸‹waitçš„é£é™©</h4><p>è¿™æ˜¯åœ¨å‡ ä¸ªæœˆå‰é¡ºä¸°ç§‘æŠ€é¢è¯•çš„æ—¶å€™ï¼Œä¸€é¢é¢è¯•å®˜é—®æˆ‘çš„é—®é¢˜ï¼Œå½“æ—¶æˆ‘æ²¡ç­”ä¸Šï¼Œå› ä¸ºå½“æ—¶å‡†å¤‡çš„å¾ˆä¸å……åˆ†ï¼Œè¿waitå’Œsleepçš„åŒºåˆ«éƒ½æ²¡çœ‹ï¼Œä¼°è®¡æ˜¯å› ä¸ºè¿™ä¸ªåŸå› ï¼Œé¢è¯•å®˜ä»¥ä¸ºåˆæ‘¸åˆ°æˆ‘çš„ä¸Šé™äº†ï¼Œé¡ºä¸°ç§‘æŠ€è¿˜æ˜¯æŒºæƒ³å»çš„</p>
<p>ä»Šå¤©çœ‹äº†ä¸€ä¸‹waitå’Œnotifyä¹‹åï¼Œæ„Ÿè§‰èƒ½å›ç­”å‡ºè¿™ä¸ªé—®é¢˜äº†</p>
<ol>
<li><p>å› ä¸ºwaitå¹¶<strong>ä¸ä¼šé‡Šæ”¾çº¿ç¨‹å æœ‰çš„å…¶ä»–é”</strong>ï¼Œå¦‚æœå¿½ç•¥æ‰è¿™ä¸ªé—®é¢˜çš„è¯ï¼Œä¼šéšå½¢åœ°åˆ¶é€ ä¸€äº›<strong>æ­»é”</strong>ï¼Œå½“ç„¶ï¼Œè¿™å±äº<strong>è®¾è®¡ä¸Š</strong>çš„é—®é¢˜</p>
<pre><code class="language-java">new Thread(() -&gt; {
    synchronized (lockA) {
        synchronized (lockB) {
            try {
                String lock = lockA;
                lock.wait(10000);
            } catch (InterruptedException e) {}
        }
    }
}).start();
new Thread(() -&gt; {
    try {Thread.sleep(300);} catch (InterruptedException e) {}
    synchronized (lockA) {
        synchronized(lockB) {}
    }
}).start();</code></pre>
<p>å½“çº¿ç¨‹1æ”¾å¼ƒäº†LockAå¹¶ä¸”è¿›å…¥é˜»å¡çš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹Bè·å–åˆ°äº†LockAå¹¶ä¸”åœ¨è·å–LockBçš„æ—¶å€™é˜»å¡ï¼Œç„¶åçº¿ç¨‹Aä¹Ÿè¿›å…¥äº†é˜»å¡çŠ¶æ€ï¼Œå› ä¸ºè¦ä»waitè¿”å›çš„æ¡ä»¶æ˜¯ç«äº‰åˆ°LockAï¼Œè€Œè¿™æ—¶å€™LockAå·²ç»è¢«åˆ«çš„çº¿ç¨‹è·å–äº†ï¼›</p>
<p>åœ¨è¿™ç§çŠ¶æ€ä¸‹ï¼Œè¶…æ—¶å°±æ— æ•ˆäº†ï¼Œå‘èµ·ä¸­æ–­ä¹Ÿæ— æ•ˆï¼Œå› ä¸ºå‘èµ·ä¸­æ–­åªæ˜¯æ‰“äº†æ ‡å¿—ï¼Œçº¿ç¨‹Aä»ç„¶éœ€è¦è·å–åˆ°LockAæ‰èƒ½è¿”å›ï¼›</p>
<p>è€Œä½¿ç”¨<code>Lock</code>APIå°±èƒ½å¤Ÿå¾ˆå¥½åœ°è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿæä¾›<strong>éé˜»å¡å¼ã€æœ‰è¶…æ—¶</strong>çš„è·å–é”è·å–ä¸åˆ°å°±è¶…æ—¶è¿”å›ï¼›</p>
</li>
<li><p>å› ä¸ºwaitçš„å”¤é†’æœºåˆ¶è¿˜æ˜¯é‡æ–°å»ç«äº‰é”ï¼Œå¦‚æœç«äº‰ä¸é¡ºåˆ©çš„è¯ï¼Œä¼šä¸€ç›´è¿”å›ä¸äº†<strong>ç­‰å¾…å‰çš„çŠ¶æ€</strong>ï¼Œå¯¼è‡´è¿™ä¸ªçº¿ç¨‹è¿›å…¥<strong>é¥¥é¥¿çŠ¶æ€</strong></p>
</li>
<li><p>åŒæ ·çš„notifyçš„å”¤é†’æ˜¯éšæœºçš„ï¼Œå¦‚æœè¿æ°”ä¸å¥½çš„è¯ï¼Œçº¿ç¨‹ä¼šä¸€ç›´åœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­æ²¡æœ‰è¢«é€‰ä¸­ï¼Œä¹Ÿè¿›å…¥äº†ä¸€ç§<strong>é¥¥é¥¿çŠ¶æ€</strong></p>
</li>
</ol>

    </div>
    <div id="scriptsearcher" class="myhide input-group new_font">
        <input id="searchtext" type="text" class="form-control" placeholder="keywords" autocomplete="off">
        <div class="input-group-append">
            <button id="searchbut" class="btn btn-dark" type="button">Search</button>
        </div>
    </div>

    <div id="bbt" class="myhide new_font">
        <a id="toc" style="display: none;" class="myhide" href="javascript:void(0);" data-toggle="tooltip" data-placement="left" title="show/hide Toc">Toc</a>
        <a id="gohub" href="#" target="_blank" data-toggle="tooltip" data-placement="bottom" title="view this at github">unuse</a>
    </div>

    <div id="share_png_panel" class="myhide">
        <div id="share_curtain"></div>
        <div id="png_box"></div>
        <button id="share_png_paned_close" class="btn btn-dark">Close</button>
    </div>

</body>

</html>