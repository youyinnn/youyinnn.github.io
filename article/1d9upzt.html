<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="baidu-site-verification" content="l09YSIpJQW" />
    <meta name="referrer" content="origin">
    <title>blog | youyinnn</title>
    <script src="http://pv.sohu.com/cityjson?ie=utf-8"></script>
    <script>
        if (location.hostname === 'youyinnn.github.io' && returnCitySN.cname === 'CHINA') {
            location.href = 'https://youyinnn.gitee.io' + location.pathname
        }
    </script>
    <link rel="bookmark" href="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@master/img/favicon.ico" />
    <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@master/img/favicon.ico" />
    <link rel="stylesheet" href="/mycss/style.css">


    <script src="/resources/resources.js"></script>
    <script src="/myjs/import.js"></script>
</head>

<body>

    <ol id="topbar" class="breadcrumb unselectable new_font">
        <p style="color:rgb(214, 214, 214); padding-right: 1rem;">
            <button id="egg" class="egg em-svg em-rocket"></button>&nbsp;&nbsp;&nbsp;&nbsp;&gt;</p>
        <li class="breadcrumb-item">
            <spen id="homebut" href="javaScript:void(0)" class="ah">-home</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="articlesbut" href="javaScript:void(0)" class="ah">-articles</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="scriptbut" href="javaScript:void(0)" class="ah">-scripts</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="todobut" href="javaScript:void(0)" class="ah">-todos</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="resumebut" href="javaScript:void(0)" class="ah">-resume</spen>
        </li>
        <li class="breadcrumb-item dropdown">
            <spen href="javaScript:void(0)" class="ah" role="button" id="friendlinkedbut" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">-friends</spen>
            <div id="fldd" class="dropdown-menu" aria-labelledby="friendlinkedbut" style="border-radius: initial;"></div>
        </li>

        <div id="hb" data-toggle="tooltip" data-placement="bottom" title="show/hide TopBar">

        </div>
    </ol>

    <div id="homepage" class="unselectable new_font myhide">
        <span id="slogan">
            <i id="wolf-logo" class="em-svg em-new_moon mr-4"></i>I'M BACK
        </span>
        <div id="showmore"> &gt; About Me & This Blog</div>
        <div id="showhacknical"> &gt; My Github Analysis</div>
        <div id="toarticles"> &gt; My Tech Articles</div>
        <div id="ifwrapper" class="hacknical_hide">
            <iframe id="hacknical_github_analysis" frameborder="0"></iframe>
        </div>
    </div>

    <div id="series" class="unselectable">
        <span>系</span>
        <span>列</span>
        <span>文</span>
        <span>章</span>
    </div>
    <div id="seriesbox" class="unselectable">

    </div>

    <div id="articles_side_panel" class="unselectable myhide new_font">
        <div id="cates_tree_head">Article Categories</div>
        <div id="cates_tree_body"></div>
        <div id="blog_statistic_head">Blog Statistic</div>
        <table id="blog_statistic_body" class="myhide">
            <tbody>
                <tr>
                    <td style="text-align:right">Site running days:</td>
                    <td style="text-align:left" id="stat_running"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Total article:</td>
                    <td style="text-align:left" id="stat_article_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Char count:</td>
                    <td style="text-align:left" id="stat_typein"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Category count:</td>
                    <td style="text-align:left" id="stat_cate_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Tag count:</td>
                    <td style="text-align:left" id="stat_tag_count"></td>
                </tr>
            </tbody>
        </table>
    </div>
    <div id="docpanel" class="myhide new_font">
        <div id="articlesearch" class="input-group">
            <input id="articlesearchtext" type="text" class="form-control" autocomplete="off" placeholder="search">
            <div class="input-group-append">
                <button id="cleanbut" class="btn" type="button" title="clear search">cls</button>
                <button id="categories" class="btn" type="button">cates</button>
                <button id="tags" class="btn" type="button" title="all tags">tags</button>
                <button id="articlesearchbut" class="btn" type="button" title="search">sch</button>
            </div>
        </div>
        <div class="tgs myhide" id="all_cates">
            <span style="font-size: 1rem; font-weight: bold ; padding: 6px;">All categories:</span>
            <br>
        </div>
        <div class="tgs myhide" id="all_tags">
            <span style="font-size: 1rem; font-weight: bold ; padding: 6px;">All tags:</span>
            <br>
        </div>
    </div>

    <div id="sidetoccontainer" class="tochide unselectable new_font">
        <div id="block">
            <div id="percent" data-toggle="tooltip" data-placement="bottom" title="return to the top">0%</div>
        </div>
        <div id="sidetoc" class="unselectable markdown-body editormd-preview-container markdown-toc"></div>
    </div>
    <div id="md" class="myhide markdown-body editormd-html-preview">
        
          <h3>
            <a name="_root-Introduction" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            Introduction
          </h3><p>二维坐标中有一堆点集，记为P，假设P中至少有2个点，那么求出P中距离最近的两个点；</p>
<p>首先为了问题准备好点和求两点距离的方法，其中如果两点距离的输入只有一个点，那么它的距离代表无穷大，它表示没有解</p>
<pre><code class="language-java">class Point {
    double x;
    double y;

    Point(double x, double y) {
        this.x = x;
        this.y = y;
    }

    @Override
    public String toString() {
        return &quot;Point{&quot; +
                &quot;x=&quot; + x +
                &quot;, y=&quot; + y +
                &#39;}&#39;;
    }
}

private double distanceOfTwoPoint(Point a, Point b) {
    if (a == null || b == null) {
        return Double.MAX_VALUE;
    }
    return Math.sqrt(Math.pow(a.x - b.x, 2) + Math.pow(a.y - b.y, 2));
}</code></pre>

          <h4>
            <a name="_root-Brute Force - O(n^2)" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            Brute Force - O(n^2)
          </h4><p>枚举，没什么说的</p>
<pre><code class="language-java">public Point[] shortestDistance(Point[] set) {
    Point[] ans = new Point[2];
    double get = Double.MAX_VALUE;
    for (Point a : set) {
        for (Point b : set) {
            double tmp = distanceOfTwoPoint(a, b);
            if (tmp &lt; get &amp;&amp; a != b) {
                get = tmp;
                ans[0] = a;
                ans[1] = b;
            }
        }
    }
    return ans;
}</code></pre>

          <h4>
            <a name="_root-Divide And Conque - O(nlogn)" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            Divide And Conque - O(nlogn)
          </h4><p>利用分治法的思想，我们将点集分为三种情况：</p>
<ol>
<li><p>点数小于等于二时：直接计算，求该两点之间的距离。 </p>
</li>
<li><p>集合中有三个点：两两比较，求三个点中的最近的两个点距离。 </p>
</li>
<li><p>点数大于三时：首先<strong>划分</strong>集合S为SL和SR，使得SL中的每一个点位于SR中每一个点的左边，并且SL和SR中点数相同。分别在SL和SR中解决最近点对问题，得到DL和DR，分别表示SL和SR中的最近点对的距离。令d=min(DL,DR)。如果S中的最近点对(P1,P2)。P1、P2两点一个在SL和一个在SR中，那么P1和P2一定在以L为中心的间隙内，以L-d和L+d为界。 </p>
<p> <img src="http://image.youyinnn.top/20190227202606.png" alt=""></p>
</li>
</ol>
<p>针对这个基本思想，我们肯定是得有一个前提的，那就是怎么<strong>划分</strong>？如果说集合<strong>P</strong>是按照x坐标或者y坐标升降任意去排序的，那么我们就可以取集合中间下标的位置为<strong>MID</strong>，那么<strong>MID</strong>左右两边的点就是以x坐标或者y坐标值均匀分为两个子集，记为<strong>P1，P2</strong>；</p>
<p><strong>于是我们要求P必须是可划分的，也就是按照x或者y值去有序排列好的，否则得先对P进行排序，然后再划分</strong></p>
<p>然后就可以通过递归求解各自<strong>n/2</strong>的问题规模的解，各自的解记为<strong>d1，d2</strong>，定义<code>d = min{d1, d2}</code></p>
<p>这时候，<strong>dis</strong>不一定是问题的解，因为解有可能跨两个子集，所以我们还得检查<strong>MID附近</strong>可能的点集的解，最后再和<strong>dis</strong>比较，求出真正的解</p>
<p>假如说<strong>P</strong>以x坐标值为排序了，那么<strong>MID的附近</strong>的点一定存在*<em>范围关系：| MID.x - pi.x | &lt; dis *</em>，只有在这个范围内的点，才有可能存在解</p>
<p><strong>并且有以下事实：</strong>如果有<strong>跨MID</strong>的解的话，设解左边的点为<strong>pl</strong>，那么在上式范围内，右边的点存在的可能性不超过6个，于是说我们在范围关系内，左范围中的每一个点顶多再往后考虑6次右边范围内的点就行了，这样这个子过程时间就由线性缩为常量</p>
<p>于是我们整理一下逻辑：</p>
<ol>
<li>首先要求点集有序；</li>
<li>如果点集只有一个点，则返回无穷大，表明这个点集绝对没有解；</li>
<li>如果点集只有两个点，则直接返回两点距离，表明这个点集只有一个解；</li>
<li>如果点集有三个点，则直接暴力解；</li>
<li>如果三个点以上：<ol>
<li>根据中点<strong>MID</strong>划分；</li>
<li>递归传入左右子集；</li>
<li>得到左右子集的解之后，取最小值为<strong>dis</strong>；</li>
<li>考虑<strong>跨MID</strong>情况：<ol>
<li>在当前递归集合范围中，以 <strong>i = P.startIndex</strong> 开始遍历<strong>MID</strong>左边的点，且只取符合 <strong>pi.x &gt;= MID.x - dis **的点作为</strong>pl**</li>
<li>在当前递归集合范围中，针对<strong>pl</strong>，以 <strong>j = MID</strong> 开始遍历，且只取符合 <strong>pj.x &lt;= MID.x + dis</strong> 的点作为<strong>pr</strong>，且最多只找6次</li>
<li>若pl和pr的距离小于dis，则讲pl和pr作为备选解，继续往后</li>
</ol>
</li>
<li>考虑完<strong>跨MID</strong>情况后，选最小的一个情况为解；</li>
</ol>
</li>
</ol>
<pre><code class="language-java">public Point[] shortestDistance2(Point[] set, int start, int end) {
    Point[] ans = new Point[2];
    int length = end - start + 1;
    if (length == 1) {
        ans[0] = set[start];
    } else if (length == 2) {
        ans[0] = set[start];
        ans[1] = set[end];
    } else if (length == 3) {
        // brute force
        return shortestInThree(set);
    } else {
        int mid = (length / 2) + start;
        Point[] leftAns = shortestDistance2(set, start, mid);
        Point[] rightAns = shortestDistance2(set, mid + 1, end);
        double ld = Double.MAX_VALUE, rd = Double.MAX_VALUE;
        if (leftAns.length == 2) {
            ld = distanceOfTwoPoint(leftAns[0], leftAns[1]);
        }
        if (rightAns.length == 2) {
            rd = distanceOfTwoPoint(rightAns[0], rightAns[1]);
        }
        double dis = Math.min(ld, rd);
        Point midP = set[mid];
        double midAnsD = Double.MAX_VALUE;
        // process 5.4.1
        for (int i = start; i &lt;= end &amp;&amp; set[i].x &lt;= midP.x; i++) {
            Point pl = set[i];
            if (pl.x &gt;= midP.x - dis) {
                // process 5.4.2
                for (int j = mid, count = 0;
                     j &lt;= end &amp;&amp; count &lt; 6 &amp;&amp; set[j].x &lt;= midP.x + dis;
                     j++, count++) {
                    Point pr = set[j];
                    double tmp = distanceOfTwoPoint(pl, pr);
                    // process 5.4.3
                    if (tmp &lt; dis &amp;&amp; tmp != 0) {
                        ans[0] = pl;
                        ans[1] = pr;
                        midAnsD = tmp;
                    }
                }
            }
        }
        if (midAnsD &lt;= dis) {
            return ans;
        } else if (ld &lt;= rd) {
            return leftAns;
        } else {
            return rightAns;
        }
    }
    return ans;
}</code></pre>

          <h4>
            <a name="_root-Conclution" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            Conclution
          </h4><p>解法如果不知道<strong>那个事实</strong>的话，一般人是想不到的，而且还有更优化的理论，能把6个点缩为4个点，具体的引用可以<a href="https://blog.csdn.net/sinat_35678407/article/details/82874216">参考</a></p>
<p>反正在解法中，无论是规模减半还是合并子问题，算法都只需要线性的时间，而对P的排序我们可以选择一个<strong>O(nlogn)</strong>的算法，那么整体的算法效率也将是这个值，这也是该问题的最优效率</p>
<p>这也是这个问题很tricky的地方，关于排序，我自己选择是经过我自己优化的短几行的堆排序，它的效率正好是<strong>O(nlogn)</strong>：</p>
<pre><code class="language-java">public Point[] sortByX(Point[] set) {
    for (int i = 0; i &lt; set.length - 1; i++) {
        int heapLength = set.length - i;
        int lastParentIndex = (heapLength - 2) / 2;
        for (int j = lastParentIndex; j &gt;= 0; j--) {
            int leftChildIndex = j * 2 + 1;
            int rightChildIndex = leftChildIndex + 1;
            int bigIndex = leftChildIndex;
            if (rightChildIndex &lt; heapLength
                    &amp;&amp; set[rightChildIndex].x &gt; set[leftChildIndex].x) {
                bigIndex = rightChildIndex;
            }
            if (set[bigIndex].x &gt; set[j].x) {
                swap(set, bigIndex, j);
            }
        }
        swap(set, 0, heapLength - 1);
    }
    return set;
}</code></pre>

          <h4>
            <a name="_root-Test Case" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            Test Case
          </h4><pre><code class="language-java">private Point[] set = {
        new Point(0, 0),
        new Point(0.5, 2),
        new Point(1, 1),
        new Point(1, 3),
        new Point(1, 5),
        new Point(1, 7),
        new Point(-0.5, 2),
        new Point(-1, 1),
        new Point(-1, 3),
        new Point(-1, 5),
        new Point(-1, 7),
};
@Test
public void testSolution2(){
    Point[] points = sortByX(set);
    System.out.println(Arrays.toString(points));
    System.out.println(Arrays.toString(shortestDistance2(points, 0, set.length - 1)));
}</code></pre>

    </div>
    <div id="scriptsearcher" class="myhide input-group new_font">
        <input id="searchtext" type="text" class="form-control" placeholder="keywords" autocomplete="off">
        <div class="input-group-append">
            <button id="searchbut" class="btn btn-dark" type="button">Search</button>
        </div>
    </div>

    <div id="bbt" class="myhide new_font">
        <a id="toc" style="display: none;" class="myhide" href="javascript:void(0);" data-toggle="tooltip" data-placement="left" title="show/hide Toc">Toc</a>
        <a id="gohub" href="#" target="_blank" data-toggle="tooltip" data-placement="bottom" title="view this at github">unuse</a>
    </div>

    <div id="share_png_panel" class="myhide">
        <div id="share_curtain"></div>
        <div id="png_box"></div>
        <button id="share_png_paned_close" class="btn btn-dark">Close</button>
    </div>

</body>

</html>