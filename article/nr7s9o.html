<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="baidu-site-verification" content="l09YSIpJQW" />
    <meta name="referrer" content="origin">
    <title>blog | youyinnn</title>
    <link rel="bookmark" href="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@master/img/favicon.ico" />
    <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@master/img/favicon.ico" />
    <link rel="stylesheet" href="/mycss/style.css">

    <script src="/myjs/import.js"></script>
    <script>
        importJsBeforeLoad()
    </script>
</head>

<body>

    <ol id="topbar" class="breadcrumb unselectable new_font">
        <p style="color:rgb(214, 214, 214); padding-right: 1rem;">
            <button id="egg" class="egg em-svg em-rocket"></button>&nbsp;&nbsp;&nbsp;&nbsp;&gt;</p>
        <li class="breadcrumb-item">
            <spen id="homebut" href="javaScript:void(0)" class="ah">-home</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="articlesbut" href="javaScript:void(0)" class="ah">-articles</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="scriptbut" href="javaScript:void(0)" class="ah">-scripts</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="todobut" href="javaScript:void(0)" class="ah">-todos</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="resumebut" href="javaScript:void(0)" class="ah">-resume</spen>
        </li>
        <li class="breadcrumb-item dropdown">
            <spen href="javaScript:void(0)" class="ah" role="button" id="friendlinkedbut" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">-friends</spen>
            <div id="fldd" class="dropdown-menu" aria-labelledby="friendlinkedbut" style="border-radius: initial;"></div>
        </li>

        <div id="hb" data-toggle="tooltip" data-placement="bottom" title="show/hide TopBar">

        </div>
    </ol>

    <div id="homepage" class="unselectable new_font myhide">
        <span id="slogan">
            <i id="wolf-logo" class="em-svg em-new_moon mr-4"></i>I'M BACK
        </span>
        <div id="showmore"> &gt; About Me & This Blog</div>
        <div id="showhacknical"> &gt; My Github Analysis</div>
        <div id="toarticles"> &gt; My Tech Articles</div>
        <div id="ifwrapper" class="hacknical_hide">
            <iframe id="hacknical_github_analysis" frameborder="0"></iframe>
        </div>
    </div>

    <div id="series" class="unselectable">
        <span>系</span>
        <span>列</span>
        <span>文</span>
        <span>章</span>
    </div>
    <div id="seriesbox" class="unselectable">

    </div>

    <div id="articles_side_panel" class="unselectable myhide new_font">
        <div id="cates_tree_head">Article Categories</div>
        <div id="cates_tree_body"></div>
        <div id="blog_statistic_head">Blog Statistic</div>
        <table id="blog_statistic_body" class="myhide">
            <tbody>
                <tr>
                    <td style="text-align:right">Site running days:</td>
                    <td style="text-align:left" id="stat_running"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Total article:</td>
                    <td style="text-align:left" id="stat_article_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Char count:</td>
                    <td style="text-align:left" id="stat_typein"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Category count:</td>
                    <td style="text-align:left" id="stat_cate_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Tag count:</td>
                    <td style="text-align:left" id="stat_tag_count"></td>
                </tr>
            </tbody>
        </table>
    </div>
    <div id="docpanel" class="myhide new_font">
        <div id="articlesearch" class="input-group">
            <input id="articlesearchtext" type="text" class="form-control" autocomplete="off" placeholder="search">
            <div class="input-group-append">
                <button id="cleanbut" class="btn btn-dark" type="button" title="clear search">cls</button>
                <button id="categories" class="btn btn-dark" type="button">cates</button>
                <button id="tags" class="btn btn-dark" type="button" title="all tags">tags</button>
                <button id="articlesearchbut" class="btn btn-dark" type="button" title="search">sch</button>
            </div>
        </div>
        <div class="tgs myhide" id="all_cates">
            <span style="font-size: 1rem; font-weight: bold ; padding: 6px;">All categories:</span>
            <br>
        </div>
        <div class="tgs myhide" id="all_tags">
            <span style="font-size: 1rem; font-weight: bold ; padding: 6px;">All tags:</span>
            <br>
        </div>
    </div>

    <div id="sidetoccontainer" class="tochide unselectable new_font">
        <div id="block">
            <div id="percent" data-toggle="tooltip" data-placement="bottom" title="return to the top">0%</div>
        </div>
        <div id="sidetoc" class="unselectable markdown-body editormd-preview-container"></div>
    </div>
    <div id="md" class="myhide markdown-body editormd-html-preview">
        <p>{% cq %}</p>
<p>本文从为知笔记迁移过来, 本文的写作时间是 : 2016/10/17 下午12:28:14, 两年前的文章, 言语难免幼稚, 思维难免浅显, 多多包含.</p>
<p>{% endcq %}</p>

          <h3>
            <a name="_root-引例" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            引例
          </h3><pre><code class="language-java">    List&lt;Integer&gt; intlist = new ArrayList&lt;Integer&gt;();

    intlist.add(1);
    intlist.add(2);
    intlist.add(3);

    intlist.forEach((num)-&gt;System.out.println(num));</code></pre>
<p>​<br>这里就有一个疑问：ArrayList为什么会有一个forEach()函数，而且传进去的变量是这样的形式？</p>
<p>于是我向上找了<code>forEach()</code>方法的源码，发现这个方法是被定义在   <code>Iterable</code>接口里面的，接口里面为什么能定义方法？</p>
<pre><code class="language-java">    /**
     * Performs the given action for each element of the {@code Iterable}
     * until all elements have been processed or the action throws an
     * exception.  Unless otherwise specified by the implementing class,
     * actions are performed in the order of iteration (if an iteration order
     * is specified).  Exceptions thrown by the action are relayed to the
     * caller.
     *
     * @implSpec
     * &lt;p&gt;The default implementation behaves as if:
     * &lt;pre&gt;{@code
     *     for (T t : this)
     *         action.accept(t);
     * }&lt;/pre&gt;
     *
     * @param action The action to be performed for each element
     * @throws NullPointerException if the specified action is null
     * @since 1.8
     */
    default void forEach(Consumer&lt;? super T&gt; action) {
        Objects.requireNonNull(action);
        for (T t : this) {
            action.accept(t);
        }
    }</code></pre>
<p>看了这个方法的说明发现，这是java8的新特性：允许接口里面定义默认方法。再一层一层地往上找可以发现继承和实现的关系图：</p>
<p>我们再回到<code>forEach</code>方法，他的参数为什么是这样的，看了源码我发现，他传进去的是一个：<code>Consumer</code> 类型的参数。所以这又是个什么鬼？惯例帖源码：</p>
<pre><code class="language-java">/**
 * Represents an operation that accepts a single input argument and returns no
 * result. Unlike most other functional interfaces, {@code Consumer} is expected
 * to operate via side-effects.
 *
 * &lt;p&gt;This is a &lt;a href=&quot;package-summary.html&quot;&gt;functional interface&lt;/a&gt;
 * whose functional method is {@link #accept(Object)}.
 *
 * @param &lt;T&gt; the type of the input to the operation
 *
 * @since 1.8
 */
@FunctionalInterface
public interface Consumer&lt;T&gt; {
​
    /**
     * Performs this operation on the given argument.
     *
     * @param t the input argument
     */
    void accept(T t);
​
    /**
     * Returns a composed {@code Consumer} that performs, in sequence, this
     * operation followed by the {@code after} operation. If performing either
     * operation throws an exception, it is relayed to the caller of the
     * composed operation.  If performing this operation throws an exception,
     * the {@code after} operation will not be performed.
     *
     * @param after the operation to perform after this operation
     * @return a composed {@code Consumer} that performs in sequence this
     * operation followed by the {@code after} operation
     * @throws NullPointerException if {@code after} is null
     */
    default Consumer&lt;T&gt; andThen(Consumer&lt;? super T&gt; after) {
        Objects.requireNonNull(after);
        return (T t) -&gt; { accept(t); after.accept(t); };
    }
}</code></pre>
<p>得，看到这个 @since 1.8 就知道，<code>这又是一个java8的新东西：函数式接口 @FunctionalInterface 简称FI</code>，通过一些资料，我得知虽然之前也有一些<code>FI</code>，但是并没有很明确的给这些接口定义为<code>FI</code>，而是叫做<code>SAM类型（单抽象方法类型 Single Abstract Method）</code>。现在让我来好好研究这个接口，嗯，接口里面有个需要实现的方法<code>void accept(T t);</code>既然说需要实现那这个先放着，看下面那坨玩意.... 默认定义了一个<code>anThen</code>方法，传进去的是一个<code>Consumer</code>，出来的也是一个<code>Consumer</code>...？？</p>
<p>没关系，我们看第一句，这玩意就是判断你传进去的东西是不是<code>null</code>，不是就抛出个空指针异常；</p>
<p>下面就直接<code>return</code>了 而且这个结构有点不太好看出他做了什么，下面来分析分析我们<code>return</code>的是一个<code>Consumer</code>，所以在得出最终结果之前我们还得再进一次这个函数...所以..等等...不过这好像跟我们的<code>forEach</code>没什么关系。</p>
<p>好我们言归正传，看看forEach：</p>
<pre><code class="language-java">    default void forEach(Consumer&lt;? super T&gt; action) {
        Objects.requireNonNull(action);
        for (T t : this) {
            action.accept(t);
        }
    }</code></pre>
<p>直接看for循环，这种形式的for循环是java1.5出的增强性for循环，目的是为了方便便利数组和集合，因为隐藏了index信息，所以对于单个元素的引索则显得很无力。 </p>
<p>因此吧，<code>this</code>就是我们的<code>intlist</code>，<code>action</code>就是我们的<code>lambda</code>表达式</p>
<pre><code class="language-java">  (num)-&gt;System.out.println(num)</code></pre>
<p>然后。。。<code>action.accept(t)</code>。。这其实没什么，我们去看看<code>accept</code>就好了，往上翻发现：</p>
<pre><code class="language-java">    /**
     * Performs this operation on the given argument.
     *
     * @param t the input argument
     */
    void accept(T t);</code></pre>
<p>说啥？它说，执行输入进来的这个语句的操作。但这是接口里面的待实现的方法，没有实现我这么执行？？在哪实现的？？好，执行吧，他执行什么？ t ？ 往上看，t 是....？？？根据结果来看 t 应该是 <code>System.out.println(num)</code></p>
<p>因为我们accept的就是这个句子，但是，如果 t 是一个语句，那么就和之前java5的增强性for循环的格式不对应...那那那我真没办法了。。只能认为这是一个语法糖了。。。我去反编译.class也看不懂底层到底是这么实现的，所学有限。</p>
<p>现在回到我们的最初----lambda表达式</p>
<p>其语法如下：</p>
<p><code>(parameters)-&gt;{ statements; }</code></p>
<p>我们的例子</p>
<p><code>(num)-&gt;System.out.println(num)</code></p>
<p>从结果来看，应该是我给你什么，你就能拿这个为我干什么事情。</p>
<p>再来看Java5和Java8的对比：</p>
<pre><code class="language-java">    //Java5的for-Each表达式对集合的循环
    for(Integer num : intlist){
        System.out.println(num);
    }

    //Java8的forEach()+lambda表达式对集合的循环
    intlist.forEach((num)-&gt;System.out.println(num));</code></pre>
<p>在Java5的基础上，lambda就使代码更加简洁。</p>
<p>那么。。。lambda能在哪里用？前面提到过一个： <code>@FunctionalInterface</code> ，研究了Java8的API文档我发现：</p>
<p>这是一个FI声明，FI官方给的定义就是：有且仅有一个抽象方法的接口。而且这个抽象方法被称作是函数式方法，这个函数式方法能被lambda表达式的值和返回值类型所匹配。FI能够为多种上下文提供目标类型。</p>

          <h3>
            <a name="_root-Lambda的用法：" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            Lambda的用法：
          </h3><p>可选类型声明：不需要声明参数类型，编译器可以统一识别参数值。 </p>
<p>可选的参数圆括号：一个参数无需定义圆括号，但多个参数需要定义圆括号。 </p>
<p>可选的大括号：如果主体包含了一个语句，就不需要使用大括号。 </p>
<p>可选的返回关键字：如果主体只有一个表达式返回值则编译器会自动返回值，大括号需要指定明表达式返回了一个数值。</p>
<p>关于<code>lambda</code>表达式的理解，我在runoob网上看到一个例子，我觉得挺有代表性的，我自己也试着模仿这个例子去使用<code>lambda</code>：</p>
<pre><code class="language-java">public class lambdaTest {

    //首先有一个标准的FI
    @FunctionalInterface
    interface LambdaPerform{
        void interfacesay(String name,int age);
    }

    public static void main(String[] args) {

        //lambda表达式登场
        LambdaPerform implementsay = (String name,int age) -&gt; { System.out.print(&quot;lambda :&quot;);System.out.println(&quot; &quot;+name+&quot; : &quot;+age);};

        //神奇的一幕发生了
        implementsay.interfacesay(&quot;Tom&quot;, 25);
    }
}</code></pre>
<p>控制台有结果：</p>
<p>lambda : Tom : 25</p>
<p>我们可以看到，传统的接口里面的抽象方法，必须要在某个类实现了这个接口，并提供了这个方法的实现，才可以用这个方法，那现在，如果这个接口是一个<code>FI</code>，<code>lambda</code>表达式登场之后，这个抽象方法<code>interfacesay</code>就能被使用。现在我们明白了，<code>lambda</code>表达式一登场的时候，他等于就干了两件大事：</p>
<ul>
<li><p>实现了这个接口（从格式上看应该是等式左边的部分完成这个操作，有点匿名内部类的意思）</p>
</li>
<li><p>实现了这个接口里面唯一的抽象方法。（等式右边就好比写成列出成员列表，完成方法体实现抽象方法）</p>
</li>
</ul>
<p>至少我是这样理解他干了这俩事的，所以我们就可以使用这个<code>interfacesay</code>函数！！！</p>

          <h3>
            <a name="_root-总结" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            总结
          </h3><p>这也就解决了上面的<code>accept</code>方法为什么没有实现却可以使用的问题！</p>
<p>runoob网站还提到，<code>lambda</code>表达式只能引用<code>final</code>或者<code>final</code>局部变量，也就是不能在<code>lambda</code>内修改外部定义的变量，否则编译出错。就算没有说明变量是<code>final</code>，在表达式内也改不了，意思是传进去的变量被标识为有一个隐式的<code>final</code>说明。</p>
<p>参考：<br><a href="http://www.runoob.com/java/java8-lambda-expressions.html">http://www.runoob.com/java/java8-lambda-expressions.html</a><br><a href="http://blog.csdn.net/samjustin1/article/details/52268004">http://blog.csdn.net/samjustin1/article/details/52268004</a><br>Java Platform SE 8 - API</p>

    </div>
    <div id="scriptsearcher" class="myhide input-group new_font">
        <input id="searchtext" type="text" class="form-control" placeholder="keywords" autocomplete="off">
        <div class="input-group-append">
            <button id="searchbut" class="btn btn-dark" type="button">Search</button>
        </div>
    </div>

    <div id="bbt" class="myhide new_font">
        <a id="toc" style="display: none;" class="myhide" href="javascript:void(0);" data-toggle="tooltip" data-placement="left" title="show/hide Toc">Toc</a>
        <a id="gohub" href="#" target="_blank" data-toggle="tooltip" data-placement="bottom" title="view this at github">unuse</a>
    </div>

    <div id="share_png_panel" class="myhide">
        <div id="share_curtain"></div>
        <div id="png_box"></div>
        <button id="share_png_paned_close" class="btn btn-dark">Close</button>
    </div>

    <script>
        importJsAfterLoad()
    </script>
</body>

</html>