<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="baidu-site-verification" content="l09YSIpJQW" />
    <meta name="referrer" content="origin">
    <title>blog | youyinnn</title>
    <script src="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@master/myjs/loadscripts.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@master/myjs/jump-1.3.js"></script>
    <link rel="bookmark" href="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@master/img/favicon.ico" />
    <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@master/img/favicon.ico" />
    <link rel="stylesheet" href="/mycss/style.css">

    <script src="/resources/resources.js"></script>
    <script src="/myjs/scriptlist.js"></script>
</head>

<body>

    <ol id="topbar" class="breadcrumb unselectable new_font">
        <p style="color:rgb(214, 214, 214); padding-right: 1rem;">
            <button id="egg" class="egg">ğŸš€</button>&nbsp;&nbsp;&nbsp;&nbsp;&gt;</p>
        <li class="breadcrumb-item">
            <spen id="homebut" href="javaScript:void(0)" class="ah">-home</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="articlesbut" href="javaScript:void(0)" class="ah">-articles</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="scriptbut" href="javaScript:void(0)" class="ah">-scripts</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="todobut" href="javaScript:void(0)" class="ah">-todos</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="resumebut" href="javaScript:void(0)" class="ah">-resume</spen>
        </li>
        <li class="breadcrumb-item dropdown">
            <spen href="javaScript:void(0)" class="ah" role="button" id="friendlinkedbut" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">-friends</spen>
            <div id="fldd" class="dropdown-menu" aria-labelledby="friendlinkedbut" style="border-radius: initial;"></div>
        </li>

        <div id="hb" data-toggle="tooltip" data-placement="bottom" title="show/hide TopBar">

        </div>
    </ol>

    <div id="homepage" class="unselectable new_font myhide">
        <div id="homepage-center">
            <div id="slogan">
                <i id="wolf-logo" style="font-style: normal;" class="mr-4">ğŸŒ‘</i><span id="slogan-text"></span>
            </div>
            <div id="homepage-btn">
                <div id="showmore"> &nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp; About Me & This Blog</div>
                <div id="showhacknical"> &nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp; My Github Analysis</div>
                <div id="toarticles"> &nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp; My Tech Articles</div>
            </div>
        </div>
        <div id="ifwrapper" class="hacknical_hide">
            <iframe id="hacknical_github_analysis" frameborder="0"></iframe>
        </div>
    </div>

    <div id="articles_side_panel" class="unselectable myhide new_font">
        <div id="cates_tree_head">Article Categories</div>
        <div id="cates_tree_body"></div>
        <div id="blog_statistic_head">Blog Statistics</div>
        <table id="blog_statistic_body" class="myhide">
            <tbody>
                <tr>
                    <td style="text-align:right">Online:</td>
                    <td style="text-align:left" id="stat_running"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Article:</td>
                    <td style="text-align:left" id="stat_article_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Chars:</td>
                    <td style="text-align:left" id="stat_typein"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Categories:</td>
                    <td style="text-align:left" id="stat_cate_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Tags:</td>
                    <td style="text-align:left" id="stat_tag_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Last update:</td>
                    <td style="text-align:left" id="stat_last_update"></td>
                </tr>
            </tbody>
        </table>
    </div>
    <div id="docpanel" class="myhide new_font">
        <div id="articlesearch" class="input-group">
            <input id="articlesearchtext" type="text" class="form-control" autocomplete="off" placeholder="search">
            <div class="input-group-append">
                <button id="cleanbut" class="btn btn-light" type="button" title="clear search">cls</button>
                <button id="categories" class="btn btn-light" type="button">cates</button>
                <button id="tags" class="btn btn-light" type="button" title="all tags">tags</button>
                <button id="articlesearchbut" class="btn btn-light" type="button" title="search">sch</button>
            </div>
        </div>
        <div class="tgs myhide" id="all_cates">
            <span style="font-size: 1rem; font-weight: bold ; padding: 6px;">All categories:</span>
            <br>
        </div>
        <div class="tgs myhide" id="all_tags">
            <span style="font-size: 1rem; font-weight: bold ; padding: 6px;">All tags:</span>
            <br>
        </div>
    </div>

    <div id="sidetoccontainer" class="tochide unselectable new_font">
        <div id="block">
            <div id="percent" data-toggle="tooltip" data-placement="bottom" title="return to the top">0%</div>
        </div>
        <div id="sidetoc" class="unselectable markdown-body editormd-preview-container markdown-toc"></div>
    </div>
    <div id="md" class="myhide markdown-body editormd-html-preview">
        
          <h3 id="fccefbaf">
            <a name="_root-å‰è¨€" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            å‰è¨€
          </h3><p>ä¸€è¨€éš¾å°½ ç›´æ¥å¼€å§‹å§ æ—¶é—´æœ‰é™ å°±ä¸ä¸€ä¸€è§£è¯»æ¥å£äº†</p>
<p>è¿™ç¯‡æ˜¯é€è¡Œçº§åˆ«çš„<code>HashMap</code>çš„<strong>â€œåŸºç¡€æ“ä½œâ€</strong>æºç è§£è¯»ï¼Œä»…ä»…åˆ†æä¸€äº›æ ¸å¿ƒçš„<strong>å•å…ƒç´ åŸºç¡€æ“ä½œï¼ˆCRUDï¼‰</strong>ï¼Œå°½å¯èƒ½ä»å¤§æ¡†æ¶æ€è·¯å»åˆ†æå®ç°æ€è·¯ï¼Œä¸€äº›å¤ªç»†çš„å˜é‡å’Œæ— å…³æ“ä½œï¼Œå°±ä¸åˆ†æå¤ªå¤šäº†</p>
<p>æœ¬ç¯‡å› ä¸ºæ—¶é—´å’Œç²¾åŠ›æœ‰é™ï¼Œä¹Ÿè·³è¿‡äº†ä¸€äº›å¾ˆåº•å±‚çš„åˆ†æå¦‚hashè®¡ç®—ï¼Œæ¯”ç‰¹ä½è®¡ç®—ç­‰ï¼Œç½‘ä¸Šè¿˜æœ‰å¥½å¤šå¤§ç¥å¯¹äºè¿™ä¸ªåˆ†æçš„æ¯”æˆ‘å¥½å¾—å¤š</p>
<p><strong>å¤šå…ƒç´ æ“ä½œå¦‚<code>putAll</code></strong>ä»¥åŠä¸€äº›å…‹éš†å’Œåºåˆ—åŒ–çš„æ“ä½œçš„è¯ï¼Œå°±ä¸åˆ†æäº†</p>
<p>å¼€ç¯‡å³æ˜¯å¯¹äºä½œè€…å®ç°ç¬”è®°çš„è§£è¯»ï¼Œä½ å¯èƒ½è§‰å¾—å°±æ˜¯ä¸€ç¯‡æºç è‹±æ–‡ç¿»è¯‘ï¼Œä½†æ˜¯åˆ°åé¢åˆ°äº†æ–¹æ³•çš„æ—¶å€™ï¼Œæ¯è¡Œéƒ½æ˜¯æ ¹æ®è‡ªå·±çš„ç†è§£å»è§£è¯»çš„ï¼Œå¦‚æœæ‚¨æœ‰å…¶ä»–çš„çœ‹æ³•ï¼Œå¯ä»¥ç•™è¨€è®¨è®ºã€‚</p>
<hr>

          <h3 id="a072b854">
            <a name="_root-Documentä»‹ç»" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            Documentä»‹ç»
          </h3><blockquote>
<p>åŸºäºå“ˆå¸Œè¡¨å®ç°çš„<code>Map</code>æ¥å£ã€‚è¿™ä¸ªå®ç°æä¾›äº†æ‰€æœ‰å¯é€‰çš„æ˜ å°„æ“ä½œï¼Œå¹¶å…è®¸ç©ºå€¼å’Œç©ºé”®ã€‚(HashMapç±»å¤§è‡´ç›¸å½“äºHashtableï¼Œä½†å®ƒæ˜¯éåŒæ­¥çš„ï¼Œå¹¶ä¸”å…è®¸ä¸ºç©ºã€‚)è¿™ä¸ªç±»ä¸ä¿è¯æ˜ å°„çš„é¡ºåºï¼›ç‰¹åˆ«åœ°ï¼Œå®ƒä¸èƒ½ä¿è¯é¡ºåºä¼šéšæ—¶é—´ä¿æŒä¸å˜ï¼ˆä¹Ÿå°±æ˜¯è¯´é¡ºåºå¯èƒ½ä¼šåœ¨å…¶ä»–çš„æ“ä½œä¸­è¢«æ”¹å˜ï¼‰ã€‚</p>
<p>è¿™ä¸ªå®ç°ä¸ºåŸºæœ¬æ“ä½œï¼ˆ<code>get</code>å’Œ<code>put</code>ï¼‰æä¾›äº†æ’å®šæ—¶é—´çš„æ€§èƒ½ï¼Œå‡è®¾å“ˆå¸Œå‡½æ•°å°†å…ƒç´ é€‚å½“åœ°åˆ†æ•£åœ¨å„ä¸ªæ¡¶ï¼ˆ <strong>bucketsï¼Œå­˜å‚¨å…ƒç´ çš„ç»“æ„ï¼Œåæ–‡ç”¨ä»“ä½æè¿°è¿™ä¸ªæ¦‚å¿µ</strong> ï¼‰ä¸­ã€‚å¯¹é›†åˆè§†å›¾çš„éå†è¿­ä»£æ‰€èŠ±è´¹çš„æ—¶é—´ï¼Œä¸<code>HashMap</code>å®ä¾‹çš„ <strong>â€œå®¹é‡ï¼ˆcapacityï¼‰â€</strong> åŠå…¶ <strong>å¤§å°ï¼ˆé”®-å€¼æ˜ å°„æ•°ï¼‰</strong> æˆæ¯”ä¾‹ã€‚å› æ­¤ï¼Œå¦‚æœè¿­ä»£æ€§èƒ½å¾ˆé‡è¦ï¼Œé‚£ä¹ˆä¸è¦å°†åˆå§‹å®¹é‡è®¾ç½®å¾—å¤ªé«˜ï¼ˆæˆ–è€…è´Ÿè½½ç³»æ•°å¤ªä½ï¼‰ï¼Œè¿™æ˜¯éå¸¸é‡è¦çš„ã€‚</p>
<p><code>HashMap</code>å®ä¾‹æœ‰ä¸¤ä¸ªå½±å“å…¶æ€§èƒ½çš„å‚æ•°ï¼šåˆå§‹å®¹é‡ <strong>ï¼ˆinitial capacityï¼‰</strong> å’Œè´Ÿè½½å› å­<strong>ï¼ˆload factorï¼‰</strong>ã€‚å®¹é‡æ˜¯å“ˆå¸Œè¡¨ä¸­çš„æ¡¶æ•°<strong>ï¼ˆç®±å­æ•°ï¼‰</strong>ï¼Œåˆå§‹å®¹é‡åªæ˜¯åˆ›å»ºå“ˆå¸Œè¡¨æ—¶çš„å®¹é‡ã€‚è´Ÿè½½å› å­æ˜¯åœ¨å“ˆå¸Œè¡¨çš„å®¹é‡è‡ªåŠ¨å¢åŠ ä¹‹å‰ï¼Œå“ˆå¸Œè¡¨è¢«å…è®¸è¾¾åˆ°çš„æœ€å¤§å®¹é‡çš„åº¦é‡<strong>ï¼ˆé˜ˆå€¼ï¼‰</strong>ã€‚å½“å“ˆå¸Œè¡¨ä¸­çš„æ¡ç›®æ•°é‡è¶…è¿‡è´Ÿè½½å› å­å’Œå½“å‰å®¹é‡çš„ä¹˜ç§¯æ—¶ï¼Œå“ˆå¸Œè¡¨å°±ä¼šè¢«é‡æ–°å“ˆå¸Œ(ä¹Ÿå°±æ˜¯è¯´ï¼Œé‡æ–°æ„å»ºå†…éƒ¨æ•°æ®ç»“æ„)ï¼Œè¿™æ ·å“ˆå¸Œè¡¨çš„å®¹é‡å¤§çº¦æ˜¯åŸæ¥çš„ä¸¤å€ã€‚</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œé»˜è®¤çš„è´Ÿè½½å› å­<strong>(0.75)</strong>åœ¨æ—¶é—´å’Œç©ºé—´æˆæœ¬ä¹‹é—´æä¾›äº†å¾ˆå¥½çš„æƒè¡¡ã€‚è¾ƒé«˜çš„å€¼å‡å°‘äº†ç©ºé—´å¼€é”€ï¼Œä½†å¢åŠ äº†æŸ¥æ‰¾æˆæœ¬ï¼ˆåæ˜ åœ¨<code>HashMap</code>ç±»çš„å¤§å¤šæ•°æ“ä½œä¸­ï¼ŒåŒ…æ‹¬<code>get</code>å’Œ<code>put</code>ï¼‰ã€‚åœ¨è®¾ç½®æ˜ å°„çš„åˆå§‹å®¹é‡æ—¶ï¼Œåº”è¯¥è€ƒè™‘æ˜ å°„ä¸­çš„<strong>æœŸæœ›æœ€å¤§é”®å€¼å¯¹æ•°é‡</strong>åŠå…¶<strong>è´Ÿè½½å› å­</strong>ï¼Œä»¥æœ€å°åŒ–é‡å“ˆå¸Œ<strong>ï¼ˆrehashï¼‰</strong>æ“ä½œçš„æ¬¡æ•°ã€‚å¦‚æœåˆå§‹å®¹é‡å¤§äº<strong>æœŸæœ›æœ€å¤§é”®å€¼å¯¹æ•°é‡</strong>é™¤ä»¥<strong>è´Ÿè½½å› å­</strong>ï¼Œå°±ä¸ä¼šå‘ç”Ÿé‡å“ˆå¸Œæ“ä½œã€‚ </p>
<p>å¦‚æœè¦å°†è®¸å¤šæ˜ å°„ï¼ˆé”®å€¼å¯¹ï¼‰å­˜å‚¨åœ¨<code>HashMap</code>å®ä¾‹ä¸­ï¼Œé‚£ä¹ˆä½¿ç”¨è¶³å¤Ÿå¤§çš„å®¹é‡åˆ›å»ºæ˜ å°„å°†ä½¿æ˜ å°„å­˜å‚¨çš„æ•ˆç‡æ›´é«˜ï¼Œè€Œä¸æ˜¯è®©å®ƒæ ¹æ®éœ€è¦æ‰§è¡Œè‡ªåŠ¨é‡å“ˆå¸Œä»¥å¢é•¿è¡¨ã€‚æ³¨æ„ï¼Œä½¿ç”¨å…·æœ‰ç›¸åŒ<code>hashCode()</code>çš„å¤šä¸ªé”®ç¡®å®ä¼šé™ä½ä»»ä½•æ•£åˆ—è¡¨çš„æ€§èƒ½ã€‚ä¸ºäº†æ”¹å–„å½±å“ï¼Œå½“é”®å…·æœ‰å¯æ¯”æ€§æ—¶ï¼Œè¿™ä¸ªç±»å¯ä»¥ä½¿ç”¨é”®ä¹‹é—´çš„æ¯”è¾ƒé¡ºåºæ¥å¸®åŠ©æ–­å¼€è¿æ¥ï¼ˆé¿å…hashå†²çªï¼‰ã€‚</p>
</blockquote>

          <h3 id="d8d8492b">
            <a name="_root-ä½œè€…ç»™çš„å®ç°æç¤º" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            ä½œè€…ç»™çš„å®ç°æç¤º
          </h3>
          <h4 id="21cf46bd">
            <a name="_root-1.å…³äºæ•´ä½“ç»“æ„" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            1.å…³äºæ•´ä½“ç»“æ„
          </h4><blockquote>
<p>è¿™ä¸ªmapå®ç°ï¼Œåœ¨ä¸€èˆ¬çš„æƒ…å†µä¸‹å°±åƒæ˜¯ä¸€ä¸ªä¸ªç”±å“ˆå¸Œè¡¨ï¼ˆ<strong>hash table</strong>ï¼‰ç»„ç»‡èµ·æ¥çš„ç®±å­ä¸€æ ·ï¼Œä½†æ˜¯å½“è¿™äº›ç®±å­çš„æ•°é‡å˜å¾—éå¸¸å¤§ï¼ˆéå¸¸å¤§å¦‚ä½•è¡¡é‡ï¼Ÿï¼‰çš„æ—¶å€™ï¼Œå®ƒä¼šç”¨æ ‘ç»“ç‚¹ï¼ˆ<strong>TreeNode</strong>ï¼‰ç»“æ„å»æ›¿æ¢ç®±å­çš„ç»“æ„ï¼Œæ¯ä¸ªç»“æ„å’Œ<code>java.util.TreeMap</code>å¾ˆç›¸ä¼¼ã€‚</p>
<p>ç±»ä¸­å¤§éƒ¨åˆ†çš„æ–¹æ³•éƒ½æ˜¯åœ¨ä¸€èˆ¬çš„æƒ…å†µä¸‹è€ƒè™‘çš„ï¼ˆ<strong>table method</strong>ï¼‰ï¼Œä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆå½“ä½œä¸€å †æ™®é€šç®±å­ä¸€æ ·ä½¿ç”¨ï¼Œä½†æ˜¯åœ¨åˆé€‚çš„æƒ…å†µä¸‹ï¼ˆå¯èƒ½åªæ˜¯ç®€å•çš„åˆ¤æ–­ç»“æ„æ˜¯å¦<code>instanceof</code>ä¸€ä¸ªNodeï¼‰ä¼šå°†è½¬æ¥åˆ°<strong>TreeNode</strong>ç»“æ„ä¸‹å¯ç”¨çš„æ–¹æ³•ï¼ˆ<strong>tree method</strong>ï¼‰ï¼Œè¿™æ—¶å€™ä½ éœ€è¦è®²æ¯ä¸ªç®±å­å½“æˆä¸€æ£µæ ‘å»å¯¹å¾…ã€‚</p>
<p><strong>TreeNode</strong>ç»“æ„ä¸‹çš„è¿™äº›ç®±å­å¯èƒ½ä¼šè¢«éå†æˆ–è€…æœ‰åˆ«çš„ç”¨é€”ï¼Œä½†æ˜¯åœ¨è¿™ä¸ª<strong>TreeNode</strong>ç»“æ„é‡Œçš„ç®±å­æ•°é‡è¶Šæ¥è¶Šå¤šçš„æƒ…å†µä¸‹ï¼Œä¾æ—§æ”¯æŒä»¥ç†æƒ³çš„é€Ÿåº¦è¿›è¡Œå¿«é€ŸæŸ¥æ‰¾æ“ä½œã€‚ç„¶è€Œï¼Œè€ƒè™‘åˆ°mapä¸­ç»å¤§å¤šæ•°çš„ç®±å­ç»“æ„éƒ½æ˜¯ä¸€èˆ¬çš„ç»“æ„ï¼Œé‚£ä¹ˆæ£€æŸ¥è¿™äº›æ ‘ç»“æ„ç®±å­çš„æ“ä½œå°±å¯èƒ½åœ¨è¡¨æ–¹æ³•ï¼ˆ<strong>table method</strong>ï¼‰è¿›è¡Œçš„è¿‡ç¨‹ä¸­è¢«å»¶è¿Ÿæ‰§è¡Œã€‚</p>
</blockquote>

          <h4 id="b6934351">
            <a name="_root-2.å…³äºTree Bins" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            2.å…³äºTree Bins
          </h4><blockquote>
<p> æ ‘ç®±å­ï¼ˆ<strong>Tree bins</strong>ï¼Œç®±å­éƒ½æ˜¯<strong>TreeNode</strong>ç»“æ„ï¼‰çš„é¡ºåºé¦–å…ˆç”±å…ƒç´ çš„hashCodeï¼ˆå“ˆå¸Œç ï¼‰å†³å®šï¼Œä½†æ˜¯åœ¨æœ‰å…³è”çš„æƒ…å†µä¸‹ï¼Œå¦‚æœä¸¤ä¸ªå…ƒç´ å®ç°äº†åŒä¸€ä¸ª<code>class C implements Comparable&lt;C&gt;</code>æ¥å£çš„è¯ï¼Œé‚£ä¹ˆå®ƒä»¬çš„é¡ºåºç”±å®ç°äº†çš„æ¯”è¾ƒæ–¹æ³•å†³å®šï¼ˆæˆ‘ä»¬ä¿å®ˆåœ°é€šè¿‡åå°„å»éªŒè¯thiså¯¹è±¡æ¥æ£€æŸ¥æ³›å‹--è¯¦æƒ…è§<code>comparableClassFor</code>æ–¹æ³•ï¼‰ã€‚</p>
<p> æ ‘ç®±å­çš„å¢åŠ æ¯”è¾ƒå¤æ‚ä½†æ˜¯ç»å¯¹å€¼å¾—ï¼Œæœ€åçš„æƒ…å†µä¸‹ä¹Ÿæœ‰<strong>O(logn)</strong>æ•ˆç‡ï¼Œä½†æ˜¯æ“ä½œè¦æ±‚é”®ï¼ˆKEYSï¼‰å¿…é¡»æœ‰å”¯ä¸€çš„å“ˆå¸Œï¼ˆhashsï¼‰æˆ–è€…æœ‰åºæ€§ä¿è¯ï¼Œå› æ­¤ï¼Œåœ¨ä¸€äº›æ„å¤–æƒ…å†µæˆ–è€…<code>hashCode()</code>æ–¹æ³•å®ç°å¾—å¤ªçƒ‚ï¼Œä¹Ÿå°±æ˜¯ä¸€äº›é”®ï¼ˆKEYSï¼‰å…±äº«ä¸€ä¸ªhashCodeçš„æƒ…å†µä¸‹ï¼Œåªè¦å®ƒä»¬è¿˜èƒ½äº’ç›¸æ¯”è¾ƒï¼Œæ€§èƒ½ä¼šæ…¢æ…¢é€€åŒ–ã€‚ï¼ˆå¦‚æœè¿™äº›åŠæ³•éƒ½æ²¡æœ‰è¢«é‡‡ç”¨ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šåœ¨ä¸¤å€çš„æ—¶é—´æ•ˆç‡æˆ–è€…ç©ºé—´æ•ˆç‡ä¸Šè¿›è¡Œæ¯”è¾ƒå…ƒç´ ï¼Œè¿™æ˜¯åœ¨æ²¡æœ‰é¢„é˜²æªæ–½çš„æƒ…å†µä¸‹ã€‚ä½†æ˜¯è¿™æ ·çš„æƒ…å†µåªä¼šåœ¨èœé¸Ÿç¨‹åºå‘˜çš„èº«ä¸Šæ‰æœ‰å¯èƒ½å‘ç”Ÿï¼Œå› ä¸ºç¨‹åºå·²ç»å¤Ÿæ…¢äº†ï¼Œå†æ…¢ä¸€ç‚¹ä¹Ÿæ²¡å·®ï¼‰</p>
</blockquote>

          <h4 id="c6ba601a">
            <a name="_root-3.TreeNodeç»“æ„å¸¦æ¥çš„æ€§èƒ½" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            3.TreeNodeç»“æ„å¸¦æ¥çš„æ€§èƒ½
          </h4><blockquote>
<p>å› ä¸º <strong>TreeNodes</strong> ç»“æ„ä¸€èˆ¬éƒ½æ˜¯æ™®é€šç»“ç‚¹å¤§å°çš„ä¸¤å€å·¦å³å¤§ï¼Œæˆ‘ä»¬ä»…ä»…æ˜¯åœ¨å½“ç®±å­è£…äº†è¶³å¤Ÿçš„ç»“ç‚¹çš„æ—¶å€™ï¼Œä¸ºäº†ä¿è¯èƒ½å¤Ÿç»§ç»­ä½¿ç”¨æ‰ä½¿ç”¨è¿™ä¸ªç»“æ„ï¼ˆçœ‹<code>TREEIFY_THRESHOLD</code>ï¼Œæ ‘åŒ–é˜ˆå€¼ï¼‰ã€‚è€Œä¸”å½“ä»–ä»¬çš„æ•°é‡å˜å°çš„æ—¶å€™ï¼ˆç§»é™¤æ“ä½œæˆ–è€…æ¢å¤å¤§å°çš„æ“ä½œï¼‰å®ƒä»¬ä¼šå˜å›ä¸€èˆ¬çš„ç®±å­ç»“æ„ã€‚</p>
<p>åœ¨ä½¿ç”¨åˆ†å¸ƒè‰¯å¥½çš„ç”¨æˆ·å®ç°çš„å“ˆå¸Œç çš„æ—¶å€™ï¼Œå¾ˆå°‘ä½¿ç”¨æ ‘ç®±å­ç»“æ„ã€‚</p>
<p>ç†æƒ³æƒ…å†µä¸­ï¼Œå¦‚æœå“ˆå¸Œç çš„å®ç°èƒ½ä¿è¯éšæœºæ€§ï¼Œé‚£ä¹ˆå®¹å™¨ä¸­çš„èŠ‚ç‚¹åˆ†å¸ƒé¢‘ç‡éµå¾ª<a href="http://en.wikipedia.org/wiki/Poisson_distribution">æ³Šæ¾åˆ†å¸ƒ</a>ï¼Œé»˜è®¤è°ƒæ•´å¤§å°çš„å‚æ•°å¹³å‡çº¦ä¸º <strong>0.5</strong> ï¼Œé˜ˆå€¼ä¸º <strong>0.75</strong> ï¼Œè™½ç„¶ç”±äºæ–¹å·®è¾ƒå¤§ï¼Œä¼šé€‚å½“è°ƒæ•´åˆ†å¸ƒç²’åº¦ã€‚ï¼ˆè¿™ä¸ªæ„æ€å¤§è‡´æ˜¯è¯´ï¼Œä¿æŒå®¹å™¨çš„è½½é‡æ˜¯å®¹å™¨çš„å®¹é‡çš„ <strong>0.5~0.75</strong> ä¹‹é—´ï¼Œæ¥è¿‘ <strong>0.75</strong> å°±éœ€è¦è€ƒè™‘å®¹å™¨æ‰©å®¹ï¼‰</p>
<p>å¦‚æœå¿½è§†æ–¹å·®,é¢„æœŸçš„åˆ—è¡¨å¤§å°kçš„å‡ºç°æ¬¡æ•°æ˜¯ï¼š<strong>(exp(-0.5) * pow(0.5, k) / é˜¶ä¹˜(k))</strong>ï¼Œå€¼å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>0:    0.60653066</p>
</li>
<li><p>1:    0.30326533</p>
</li>
<li><p>2:    0.07581633</p>
</li>
<li><p>3:    0.01263606</p>
</li>
<li><p>4:    0.00157952</p>
</li>
<li><p>5:    0.00015795</p>
</li>
<li><p>6:    0.00001316</p>
</li>
<li><p>7:    0.00000094</p>
</li>
<li><p>8:    0.00000006</p>
</li>
</ul>
<p>æ›´å¤šçš„å€¼å°±å·²ç»ä¸åˆ°åƒä¸‡åˆ†ä¹‹ä¸€äº†ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨<code>hashCode()</code>å®ç°å¾—ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œå‡ ä¹å®¹å™¨ä¸­å‡ ä¹ä¸å¯èƒ½å‡ºç°ä¸¤ä½æ•°ä»¥ä¸Šçš„æ ‘ç®±å­ã€‚</p>
<p>æ ‘ç®±çš„æ ¹é€šå¸¸æ˜¯å®ƒçš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚ç„¶è€Œï¼Œæœ‰æ—¶ï¼ˆå½“å‰çš„å®ç°ï¼Œä»…åœ¨<code>Iterator.remove</code>æ–¹æ³•ä¸Šå‡ºç°è¿™ä¸ªæƒ…å†µï¼‰ï¼Œæ ¹å¯èƒ½ä¼šåœ¨å…¶ä»–åœ°æ–¹ï¼Œä½†å¯ä»¥é€šè¿‡<code>TreeNode.root()</code>æ–¹æ³•æ¢å¤çˆ¶èŠ‚ç‚¹è·Ÿéšã€‚</p>
</blockquote>

          <h4 id="9a9de4f0">
            <a name="_root-4.å…¶ä»–çš„ç»†èŠ‚" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            4.å…¶ä»–çš„ç»†èŠ‚
          </h4><blockquote>
<p>æ‰€æœ‰é€‚ç”¨çš„å†…éƒ¨æ–¹æ³•éƒ½æ¥å—å“ˆå¸Œç ä½œä¸ºå‚æ•°ï¼ˆé€šå¸¸ç”±publicæ–¹æ³•æä¾›ï¼‰ï¼Œå…è®¸å®ƒä»¬å¯ä»¥åœ¨ä¸é‡æ–°è®¡ç®—ç”¨æˆ·å®ç°çš„å“ˆå¸Œç çš„æƒ…å†µä¸‹ç›¸äº’è°ƒç”¨ã€‚å¤§å¤šæ•°å†…éƒ¨æ–¹æ³•ä¹Ÿæ¥å—ä¸€ä¸ªâ€œtabâ€å‚æ•°ï¼Œè¿™ä¸ªå‚æ•°é€šå¸¸æ˜¯å½“å‰çš„è¡¨ï¼Œä½†å¯èƒ½æ˜¯æ–°è¡¨æˆ–æ—§è¡¨è°ƒæ•´æˆ–è½¬æ¢ã€‚</p>
<p>å½“ç®±å­ï¼ˆbinï¼‰åˆ—è¡¨è¢«æ ‘åŒ–ã€åˆ†å‰²æˆ–æœªæ ‘åŒ–æ—¶ï¼Œæˆ‘ä»¬ä¿ç•™å®ƒä»¬å…·æœ‰ç›¸åŒçš„ç›¸å¯¹è®¿é—® / éå†é¡ºåºï¼ˆä¾‹å¦‚ï¼šå­—æ®µã€åä¸€ä¸ªç»“ç‚¹ï¼‰ä»¥æ›´å¥½åœ°ä¿å­˜å±€éƒ¨ï¼Œå¹¶ç¨å¾®ä¿ç•™ç®€åŒ–è°ƒç”¨çš„åˆ†å‰²å’Œéå†çš„å‡½æ•°è°ƒç”¨<code>iterator.remove</code>ã€‚å½“åœ¨æ’å…¥æ—¶ä½¿ç”¨æ¯”è¾ƒå™¨æ—¶ï¼Œä¿æŒä¸€æ¬¡å…¨éƒ¨æ’åºï¼ˆæˆ–è¿™é‡Œè¦æ±‚çš„æœ€æ¥è¿‘çš„æ’åºï¼‰ä»¥è¾¾åˆ°é‡æ–°å¹³è¡¡ï¼Œæˆ‘ä»¬å°†ç±»å’Œæ ‡è¯†ç è¿›è¡Œæ¯”è¾ƒï¼Œä»¥ä½œä¸ºä¸€ä¸ªæƒè¡¡çš„é€‰æ‹©ã€‚</p>
<p><strong>æ™®é€šæ¨¡å¼</strong>å’Œ<strong>æ ‘æ¨¡å¼</strong>ä¹‹é—´çš„ä½¿ç”¨å’Œè½¬æ¢æ˜¯æœ‰ç‚¹å¤æ‚çš„ï¼Œå¯ä»¥å‚è€ƒ<code>LinkedHashMap</code>ã€‚çœ‹åˆ°å…¶ä¸­æ˜¯åœ¨<strong>æ’å…¥</strong>æ—¶è°ƒç”¨<strong>hookæ–¹æ³•</strong>ï¼Œå…è®¸<code>LinkedHashMap</code>å†…éƒ¨è¿›è¡Œ<strong>åˆ é™¤æ“ä½œ</strong>å’Œ<strong>è®¿é—®æ“ä½œ</strong>ï¼Œå¦åˆ™ä¿æŒè¿™äº›æœºåˆ¶ç‹¬ç«‹æ€§ã€‚ï¼ˆè¿™ä¹Ÿè¦æ±‚å°†mapå®ä¾‹ä¼ é€’ç»™ä¸€äº›å®ç”¨ç¨‹åºæ–¹æ³•ï¼Œè€Œè¿™å¯èƒ½ä¼šåˆ›å»ºä¸€äº›æ–°çš„èŠ‚ç‚¹ã€‚ï¼‰</p>
</blockquote>

          <h3 id="f8461fbf">
            <a name="_root-static finalæˆå‘˜å˜é‡" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            static finalæˆå‘˜å˜é‡
          </h3><pre><code class="language-java">// é»˜è®¤çš„åˆå§‹åŒ–å®¹å™¨å®¹é‡ ä¸€å¼€å§‹å°±æ˜¯16ä¸ª
static final int DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4; // aka 16

// æœ€å¤§çš„å®¹é‡ 
// åªåœ¨ä½ ä½¿ç”¨æŒ‡å®šå®¹é‡çš„æ„é€ å‡½æ•°æ„é€ å®¹å™¨çš„æ—¶å€™ å¹¶ä¸”ä½ ç»™çš„å€¼æ¯”è¿™ä¸ªå€¼æ›´å¤§çš„æ—¶å€™ä½¿ç”¨
// æ— è®ºå¦‚ä½•ä¸€ä¸ªå®¹å™¨åˆå§‹åŒ–å®¹é‡ä¸ä¼šå¤§è¿‡è¿™ä¸ªå€¼
// è€Œä¸”æœ€å¥½æ˜¯å°äºè¿™ä¸ªå€¼çš„2çš„ä»»æ„æ¬¡æ–¹
static final int MAXIMUM_CAPACITY = 1 &lt;&lt; 30;

// é»˜è®¤çš„è´Ÿè½½å› å­
static final float DEFAULT_LOAD_FACTOR = 0.75f;

// æ ‘åŒ–é˜ˆå€¼
// ç®±å­ç»“æ„è¶…è¿‡è¿™ä¸ªé˜ˆå€¼çš„æ—¶å€™ä¼šç”¨æ ‘ç»“æ„è€Œä¸æ˜¯é“¾ç»“æ„å»ç®¡ç†ç®±å­
// å½“ä¸€æ¡é“¾ç»“ç‚¹è¶…è¿‡è¿™ä¸ªé˜ˆå€¼çš„æ—¶å€™ ç®±å­ä¼šå˜æˆæ ‘ç»“æ„
// è¿™ä¸ªå€¼å¿…é¡»å¤§äº2ï¼Œå¹¶ä¸”åº”è¯¥è‡³å°‘ä¸º8ï¼Œä»¥ä¾¿åŒ¹é…åœ¨æ ‘ä¸­è¿›è¡Œåˆ é™¤æ“ä½œåå› ä¸ºå°ºå¯¸æ”¶ç¼©è€Œè½¬æ¢ä¸ºæ™®é€šç®±å­çš„æƒ…å†µ
static final int TREEIFY_THRESHOLD = 8;

// é€†æ ‘åŒ–é˜ˆå€¼
// åœ¨ä¸€äº›æ¢å¤å®¹é‡çš„æ“ä½œä¸­ å½“ç®±å­å®¹é‡å°äºè¿™ä¸ªé˜ˆå€¼çš„æ—¶å€™ä¼šå¯¹ç®±å­è¿›è¡Œé€†æ ‘åŒ–
// è¿™ä¸ªå€¼æœ€å¤§æ˜¯6
static final int UNTREEIFY_THRESHOLD = 6;

// æœ€å°çš„è¡¨å®¹é‡
// è¶…è¿‡è¿™ä¸ªæœ€å°çš„è¡¨å®¹é‡å°±åº”è¯¥æ ‘åŒ–äº†(å¦åˆ™å¦‚æœåœ¨ä¸€ä¸ªä»“ä½ä¸­æœ‰å¤ªå¤šèŠ‚ç‚¹ï¼Œè¡¨å°†è¢«è°ƒæ•´å¤§å°)
// è¿™ä¸ªå€¼è‡³å°‘ä¸º4 * TREEIFY_THRESHOLD ä»¥é¿å…è°ƒæ•´å¤§å°å’Œæ ‘åŒ–é˜ˆå€¼ä¹‹é—´çš„å†²çª
static final int MIN_TREEIFY_CAPACITY = 64;</code></pre>

          <h3 id="e2565b71">
            <a name="_root-å†…éƒ¨ç±»ï¼šé“¾ç®±å­â€”â€”ç»“ç‚¹" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            å†…éƒ¨ç±»ï¼šé“¾ç®±å­â€”â€”ç»“ç‚¹
          </h3><pre><code class="language-java">/**
 * Basic hash bin node, used for most entries.  (See below for
 * TreeNode subclass, and in LinkedHashMap for its Entry subclass.)
 */
static class Node&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; {
    final int hash;
    final K key;
    V value;
    Node&lt;K,V&gt; next;

    Node(int hash, K key, V value, Node&lt;K,V&gt; next) {
        this.hash = hash;
        this.key = key;
        this.value = value;
        this.next = next;
    }

    public final K getKey()        { return key; }
    public final V getValue()      { return value; }
    public final String toString() { return key + &quot;=&quot; + value; }

    public final int hashCode() {
        return Objects.hashCode(key) ^ Objects.hashCode(value);
    }

    public final V setValue(V newValue) {
        V oldValue = value;
        value = newValue;
        return oldValue;
    }

    public final boolean equals(Object o) {
        if (o == this)
            return true;
        if (o instanceof Map.Entry) {
            Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;
            if (Objects.equals(key, e.getKey()) &amp;&amp;
                Objects.equals(value, e.getValue()))
                return true;
        }
        return false;
    }
}</code></pre>
<p>ç®€å•è€Œå¸¸è§„ï¼Œä¸»è¦æ˜¯ä¸¤ä¸ªfinalå˜é‡ï¼Œå­˜å‚¨Keyå’Œhashï¼Œç„¶åæ˜¯valueå’Œä¸‹ä¸€ä¸ªç»“ç‚¹ï¼›</p>
<p>
        <div class="_showpic_52e9084d showpicbtn">Loading images >></div>
        <img href=https://image.youyinnn.top/20180817154531.png class="_pic_52e9084d hidepic" picId="52e9084d"></img>
        <script>
            {
                let imgself52e9084ds = document.getElementsByClassName('_pic_52e9084d')
                let showpicbtn52e9084ds = document.getElementsByClassName('_showpic_52e9084d')
                let isInViewPortOfTwo52e9084d = function () {
                    const viewPortHeight = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight 
                    const top = imgself52e9084ds[0].getBoundingClientRect() && imgself52e9084ds[0].getBoundingClientRect().top
                    if (top  <= viewPortHeight + 300) {
                        for (el of imgself52e9084ds) {
                            el.src = el.getAttribute('href')
                            el.classList.add('showpic')
                            window.removeEventListener('scroll', isInViewPortOfTwo52e9084d)
                            isInViewPortOfTwo52e9084d = null
                        }
                        for (el of showpicbtn52e9084ds) {
                            el.style.display = 'none'
                        }
                    }
                }
                window.addEventListener('scroll', isInViewPortOfTwo52e9084d)
            }
        </script>
    </p>

          <h3 id="84184acf">
            <a name="_root-é™æ€æ–¹æ³•" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            é™æ€æ–¹æ³•
          </h3>
          <h4 id="36dd98e4">
            <a name="_root-hash" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            hash
          </h4><pre><code class="language-java">// è®¡ç®—key.hashCode()ï¼Œå¹¶å°†(XORs)çš„é«˜æ¯”ç‰¹ä½åˆ†æ•£åˆ°ä½æ¯”ç‰¹ä½ ä»¥å‡å°‘hashå†²çª
// åº”ç”¨äº†ä¸€ç§è½¬æ¢ å°†é«˜æ¯”ç‰¹çš„å½±å“å‘ä¸‹ä¼ æ’­
// æ¯”ç‰¹ä¼ æ’­çš„é€Ÿåº¦ æ•ˆç”¨å’Œè´¨é‡ä¹‹é—´å­˜åœ¨æƒè¡¡
static final int hash(Object key) {
    int h;
    return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);
}</code></pre>

          <h4 id="88846189">
            <a name="_root-comparableClassFor" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            comparableClassFor
          </h4><pre><code class="language-java">// å¦‚æœxå®ç°äº†æ¯”è¾ƒå™¨æ¥å£å°±è¿”å›xçš„Classå¯¹è±¡ ä¸ç„¶å°±è¿”å›null
static Class&lt;?&gt; comparableClassFor(Object x) {
    //...
}</code></pre>

          <h4 id="538e3387">
            <a name="_root-compareComparables" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            compareComparables
          </h4><pre><code class="language-java">// è¿”å›ä¸¤ä¸ªå¯æ¯”è¾ƒå¯¹è±¡çš„æ¯”è¾ƒç»“æœ
@SuppressWarnings({&quot;rawtypes&quot;,&quot;unchecked&quot;}) // for cast to Comparable
static int compareComparables(Class&lt;?&gt; kc, Object k, Object x) {
    return (x == null || x.getClass() != kc ? 0 :
            ((Comparable)k).compareTo(x));
}</code></pre>

          <h4 id="ecfc30af">
            <a name="_root-tableSizeFor" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            tableSizeFor
          </h4><pre><code class="language-java">// æ— è®ºç»™ä»€ä¹ˆå®¹é‡ æ€»æ˜¯è°ƒæ•´ä¸ºæ¯”ä»–å¤§çš„2çš„è‹¥å¹²æ¬¡å¹‚å¤§å¤§å° æœ€å¤§ä¸è¶…è¿‡MAXIMUM_CAPACITY
static final int tableSizeFor(int cap) {
    int n = cap - 1;
    n |= n &gt;&gt;&gt; 1;
    n |= n &gt;&gt;&gt; 2;
    n |= n &gt;&gt;&gt; 4;
    n |= n &gt;&gt;&gt; 8;
    n |= n &gt;&gt;&gt; 16;
    return (n &lt; 0) ? 1 : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;
}</code></pre>

          <h3 id="5d5a1419">
            <a name="_root-æˆå‘˜å˜é‡" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            æˆå‘˜å˜é‡
          </h3><pre><code class="language-java">// è¡¨
// ä»¥ä¸€ä¸ªNode&lt;K,V&gt;æ•°ç»„æ¥è¡¨ç¤ºä¸€å¼ è¡¨çš„ç¬¬ä¸€å±‚ç»“æ„ æˆ‘ç§°è¿™ä¸ªæ•°ç»„ä¸ºâ€œä¸»ä»“â€
// åˆšåˆå§‹åŒ–çš„æ—¶å€™é¦–å…ˆä½¿ç”¨çš„è¡¨ åœ¨æœ‰å¿…è¦çš„æ—¶å€™ä¼šé‡æ–°è®¡ç®—å®¹é‡
// è¡¨çš„é•¿åº¦æ€»æ˜¯2çš„ä»»æ„æ¬¡å¹‚ ï¼ˆæŸäº›æƒ…å†µä¸‹ä¹Ÿå¯ä»¥æ˜¯0ï¼‰
transient Node&lt;K,V&gt;[] table;

// é”®å€¼å¯¹é›†åˆ
// ä¿å­˜é”®å€¼å¯¹çš„é›†åˆ æ³¨æ„AbstractMapçš„æˆå‘˜ç™½èƒ½åŠ›ç”¨çš„æ˜¯keySet() and values()
transient Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet;

// è½½é‡ è¿™ä¸ªmapä¸­è£…äº†å¤šå°‘å¯¹é”®å€¼å¯¹
transient int size;

// è¿™ä¸ªmapæ”¹å˜ç»“æ„çš„æ¬¡æ•° å¯ä»¥æ˜¯HaspMapç»“æ„çš„æ”¹å˜ä¹Ÿå¯ä»¥æ˜¯å†…éƒ¨ç»“æ„çš„æ”¹å˜
// é€šå¸¸è¿­ä»£çš„æ—¶å€™ä¼šç”¨è¿™ä¸ªå€¼åšå‚è€ƒ
transient int modCount;

// ä¸‹ä¸€æ¬¡å®¹é‡è°ƒæ•´ï¼ˆload_factor * capacityï¼‰è¦è¾¾åˆ°çš„çš„é˜ˆå€¼
int threshold;

// å½“å‰å“ˆå¸Œè¡¨çš„è´Ÿè½½å› å­
final float loadFactor;</code></pre>

          <h3 id="ad927a55">
            <a name="_root-æ„é€ å‡½æ•°" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            æ„é€ å‡½æ•°
          </h3><p>æœ¬æ¥ä¸æ‰“ç®—åˆ†ææ„é€ å‡½æ•°çš„ï¼Œä½†æ˜¯æ£€æŸ¥æ–‡ç« çš„æ—¶å€™å‘ç°ï¼Œæ„é€ å‡½æ•°ä¹Ÿæœ‰ç‚¹ä¸œè¥¿ï¼Œæ„é€ å‡½æ•°æœ‰4ä¸ªï¼Œæ”¾mapçš„é‚£ä¸ªå°±å¿½ç•¥äº†ï¼Œå…ˆçœ‹æ— å‚çš„ï¼š</p>

          <h4 id="ae9116f5">
            <a name="_root-æ— å‚" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            æ— å‚
          </h4><pre><code class="language-java">/**
 * Constructs an empty &lt;tt&gt;HashMap&lt;/tt&gt; with the default initial capacity
 * (16) and the default load factor (0.75).
 */
public HashMap() {
    this.loadFactor = DEFAULT_LOAD_FACTOR; // all other fields defaulted
}</code></pre>
<p>å‡½æ•°å°±åªæŒ‡å®šäº†ä¸€ä¸ªé»˜è®¤çš„è´Ÿè½½å› å­ï¼Œå…¶ä»–çš„å‚æ•°ä¼šåœ¨<code>resize()</code>æ–¹æ³•åšå‡ºï¼Œå¾€ä¸‹çœ‹å°±çŸ¥é“äº†ï¼›</p>

          <h4 id="611c78fc">
            <a name="_root-æœ‰å‚1" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            æœ‰å‚1
          </h4><pre><code class="language-java">public HashMap(int initialCapacity) {
    this(initialCapacity, DEFAULT_LOAD_FACTOR);
}</code></pre>

          <h4 id="4a312b3f">
            <a name="_root-æœ‰å‚2" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            æœ‰å‚2
          </h4><pre><code class="language-java">public HashMap(int initialCapacity, float loadFactor) {
    if (initialCapacity &lt; 0)
        throw new IllegalArgumentException(&quot;Illegal initial capacity: &quot; +
                                           initialCapacity);
    if (initialCapacity &gt; MAXIMUM_CAPACITY)
        initialCapacity = MAXIMUM_CAPACITY;
    if (loadFactor &lt;= 0 || Float.isNaN(loadFactor))
        throw new IllegalArgumentException(&quot;Illegal load factor: &quot; +
                                           loadFactor);
    this.loadFactor = loadFactor;
    this.threshold = tableSizeFor(initialCapacity);
}</code></pre>
<p>è¿™é‡Œå…¶ä»–çš„éƒ½ä¸é‡è¦ï¼Œå…³é”®çœ‹<code>line:11</code>ï¼Œå…¶å®æˆ‘ä»¬æŒ‡å®šåˆå§‹å®¹é‡å¹¶æ˜¯ç›´æ¥çš„ç»™è¡¨æŒ‡å®šé•¿åº¦ï¼Œè€Œæ˜¯ç›´æ¥æŒ‡å®šé˜ˆå€¼å¤§å°ï¼Œå› ä¸ºæˆ‘æŒ‡å®š1000å®¹é‡çš„å®¹å™¨ï¼Œè‚¯å®šæ˜¯è®¡åˆ’å¥½èƒ½ä¸€æ¬¡æ€§ä¸æ‰©å®¹åœ°è£…1000ä¸ªï¼Œè¯»åé¢ä½ ä¼šå‘ç°ï¼Œhashmapä½ æ˜¯ä¸ä¼šè£…æ»¡çš„ï¼Œåˆ°äº†å®ƒå®¹é‡çš„75%ï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼‰å®ƒå°±ä¼šæ‰©å®¹ï¼Œå› ä¸ºå®ƒè¦ç•™ä¸€å¤§éƒ¨åˆ†çš„ç©ºé—´æ¥é˜²æ­¢hashå†²çªï¼›</p>

          <h3 id="22bb35f4">
            <a name="_root-ç»“æ„å‰§é€ï¼" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            ç»“æ„å‰§é€ï¼
          </h3><p>
        <div class="_showpic_28359cc4 showpicbtn">Loading images >></div>
        <img href=https://image.youyinnn.top/20180817171145.png class="_pic_28359cc4 hidepic" picId="28359cc4"></img>
        <script>
            {
                let imgself28359cc4s = document.getElementsByClassName('_pic_28359cc4')
                let showpicbtn28359cc4s = document.getElementsByClassName('_showpic_28359cc4')
                let isInViewPortOfTwo28359cc4 = function () {
                    const viewPortHeight = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight 
                    const top = imgself28359cc4s[0].getBoundingClientRect() && imgself28359cc4s[0].getBoundingClientRect().top
                    if (top  <= viewPortHeight + 300) {
                        for (el of imgself28359cc4s) {
                            el.src = el.getAttribute('href')
                            el.classList.add('showpic')
                            window.removeEventListener('scroll', isInViewPortOfTwo28359cc4)
                            isInViewPortOfTwo28359cc4 = null
                        }
                        for (el of showpicbtn28359cc4s) {
                            el.style.display = 'none'
                        }
                    }
                }
                window.addEventListener('scroll', isInViewPortOfTwo28359cc4)
            }
        </script>
    </p>
<p>æˆ‘ä»¬çœ‹åˆ°ï¼Œè¿™å°±æ˜¯ä¸€å¼ ä¸€èˆ¬çš„HashMapçš„ç»“æ„ï¼Œæœ€ä¸Šé¢çš„ä¸€æ¨ªæ’æ˜¯ä¸€ä¸ª<code>Node&lt;K,V&gt;[]</code>ä¹Ÿå°±æ˜¯æˆå‘˜å˜é‡tableï¼Œæˆ‘ç§ç§°è¿™ä¸ªtableä¸º<strong>ä¸»ä»“ï¼ˆmain warehouseï¼‰ã€‚</strong></p>
<p>æ¯hashåˆ°çš„å…ƒç´ éƒ½ä¼šé¦–å…ˆè¢«æ”¾åˆ°<strong>ä¸»ä»“</strong>å¯¹åº”ä¸‹æ ‡çš„ä½ç½®ä¸Šå»ï¼Œæˆ‘ç§ç§°æ¯ä¸ªä¸‹æ ‡å¯¹åº”çš„ä½ç½®ä¸ºä¸€ä¸ª<strong>ä»“ä½ï¼ˆpositionï¼‰</strong>ï¼Œæ¯ä¸€ä¸ª<strong>ç®±å­ï¼ˆä¹Ÿå°±æ˜¯æ¯ä¸€ä¸ªç»“ç‚¹ï¼‰</strong>ç»è¿‡hashæ•£åˆ—åï¼Œå¦‚æœåˆ†åˆ°åŒä¸€ä¸ªä»“ä½ä¸­ï¼Œå°†åœ¨è¿™ä¸ªä»“ä½ä¸Šç»„ç»‡æˆé“¾è¡¨ï¼Œæˆ‘ç§ç§°è¿™ä¸ªé“¾è¡¨ä¸º<strong>é“¾ç®±ç¾¤ï¼ˆlinked binsï¼‰</strong>ï¼Œå¦‚æœ<strong>é“¾ç®±ç¾¤</strong>é•¿åº¦è¾¾åˆ°æ ‘åŒ–é˜ˆå€¼ï¼Œé‚£ä¹ˆè¿™æ¡<strong>é“¾ç®±ç¾¤</strong>å°±ä¼šæ ‘åŒ–ä¸ºæ ‘ç»“æ„ï¼Œæˆ‘ç§ç§°è¿™ä¸ªæ ‘ç»“æ„ä¸º<strong>æ ‘ç®±ç¾¤ï¼ˆtree binsï¼‰</strong>ã€‚<strong>é“¾ç®±ç¾¤</strong>å’Œ<strong>æ ‘ç®±ç¾¤</strong>æˆ‘ç»Ÿç§°ä¸º<strong>ç®±ç¾¤ç»“æ„ï¼ˆbins structureï¼‰</strong></p>
<p>æ‰€ä»¥æˆ‘ä»¬æ‰¾å…ƒç´ çš„æ—¶å€™æœ‰è¿™ä¹ˆä¸€ä»¶äº‹ï¼š<strong>hashCodeæ‰¾ä»“ä½ï¼Œequalsæ‰¾ç®±å­ï¼</strong></p>

          <h3 id="7fe6fca2">
            <a name="_root-æˆå‘˜æ–¹æ³•" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            æˆå‘˜æ–¹æ³•
          </h3>
          <h4 id="a34e512a">
            <a name="_root-get" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            get
          </h4><pre><code class="language-java">// å¤šçš„æ²¡ä»€ä¹ˆå¥½è¯´ å…³é”®æ˜¯å¼•å‡ºgetNodeæ–¹æ³•
public V get(Object key) {
    Node&lt;K,V&gt; e;
    return (e = getNode(hash(key), key)) == null ? null : e.value;
}</code></pre>

          <h5 id="7350631e">
            <a name="_root-getNode" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            getNode
          </h5><pre><code class="language-java">final Node&lt;K,V&gt; getNode(int hash, Object key) {
    Node&lt;K,V&gt;[] tab; 
    Node&lt;K,V&gt; first, e; 
    int n; K k;
    if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp;
        (first = tab[(n - 1) &amp; hash]) != null) {
        if (first.hash == hash &amp;&amp; // always check first node
            ((k = first.key) == key || (key != null &amp;&amp; key.equals(k))))
            return first;
        if ((e = first.next) != null) {
            if (first instanceof TreeNode)
                return ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);
            do {
                if (e.hash == hash &amp;&amp;
                    ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))
                    return e;
            } while ((e = e.next) != null);
        }
    }
    return null;
}</code></pre>
<p>è¿™é‡Œæœ‰5ä¸ªå˜é‡ï¼Œç¬¬ä¸€ä¸ª<strong>tab</strong>å˜é‡å¼•ç”¨mapçš„<strong>ä¸»ä»“</strong>ï¼›</p>
<p>ç„¶å<strong>first</strong>æ ¹æ®hashå»æ‰¾åˆ°çš„<strong>ä¸»ä»“</strong>ä¸Šçš„ä»“ä½çš„ç¬¬ä¸€ä¸ª<strong>ç®±å­</strong>ï¼›</p>
<p><strong>e</strong>è¡¨ç¤ºç®±ç¾¤ä¸­çš„æŸä¸ª<strong>ç®±å­</strong>ï¼›</p>
<p><strong>n</strong>è¡¨ç¤º<strong>ä¸»ä»“æ•°ç»„çš„é•¿åº¦</strong>ï¼›</p>
<p><strong>k</strong>è¡¨ç¤ºå½“å‰è®¿é—®çš„ç®±å­çš„Keyå¯¹è±¡ï¼›</p>
<p>è¯»å®Œä»£ç å‘ç°ï¼Œåœ¨ä¸€ç³»åˆ—ä¸¥è°¨çš„æ¡ä»¶è¿‡åï¼Œé¦–å…ˆçœ‹ç¬¬ä¸€ä¸ªç®±å­çš„hashå€¼å’Œè¦æ‰¾åˆ°çš„keyçš„hashå€¼æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰åˆ™å†æ¯”è¾ƒåœ°å€ä»¥åŠequalsæ–¹æ³•ï¼›</p>
<p>å¦‚æœç¬¬ä¸€ä¸ªç®±å­å¹¶ä¸æ˜¯è¦æ‰¾çš„å…ƒç´ ï¼Œä¸”å½“å‰ä»“ä½ä¸åªä¸€ä¸ªç®±å­è€Œæ˜¯ä¸€ä¸ªç®±ç¾¤ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±å¼€å§‹åˆ¤æ–­<strong>ç®±ç¾¤ç»“æ„</strong>ï¼Œå¦‚æœfirstæ˜¯<strong>æ ‘ç®±</strong>ï¼Œé‚£ä¹ˆå°±ç”¨<strong>æ ‘ç»“æ„çš„æ–¹æ³•å»æŸ¥æ‰¾ç»“ç‚¹</strong>ï¼Œå¦åˆ™å°±æ˜¯<strong>é“¾ç®±ç¾¤</strong>ï¼Œæ¥ç€å°±æ˜¯ä¸­è§„ä¸­çŸ©çš„é“¾éå†ï¼Œå¯¹æ¯”æ­¥éª¤å’Œä¸Šé¢ä¸€è‡´ï¼›</p>
<p><strong>æ— è®ºæ˜¯æ ‘ç®±å­è¿˜æ˜¯é“¾ç®±å­çš„æŸ¥æ‰¾ï¼Œéƒ½æ˜¯<code>k == key || k.equals(key)</code>è¿™æ ·çš„æ¯”è¾ƒå¥å¼ï¼</strong></p>
<p>æ³¨æ„åˆ°<code>line:8</code>æœ‰ä¸€å¥<code>(n - 1) &amp; hash</code>ï¼Œè¿™æ˜¯å°†hashå†æ˜ å°„åˆ°ä¸»ä»“çš„ä¸‹æ ‡ä¸­ï¼Œè¿™ä¹Ÿå°±è§£é‡Šäº†ä¸ºä»€ä¹ˆä¼šæœ‰<code>first.hash == hash</code>è¿™æ ·çš„è¯­å¥ï¼Œå› ä¸ºå³ä½¿ä¸åŒçš„hashä¹Ÿæœ‰å¯èƒ½æ˜ å°„åˆ°åŒä¸€ä¸ªä»“ä½ï¼Œä¸‹æ–‡çš„<code>hash &amp; (n - 1)</code>ä¹Ÿæ˜¯è®¡ç®—ä»“ä½çš„ä¸‹æ ‡ï¼ŒäºŒè€…æ²¡æœ‰åŒºåˆ«ï¼›</p>
<p>ä½†æ˜¯è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™æ ·è®¡ç®—ä¸‹æ ‡æ˜¯æœ‰è¦æ±‚çš„ï¼Œ<strong>è¦æ±‚å°±æ˜¯è¡¨å®¹é‡å¿…é¡»æ˜¯2çš„æ¬¡å¹‚ï¼Œæ‰èƒ½è¿›è¡Œè¿™æ ·çš„è¿ç®—</strong>ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæœ‰é™æ€æ–¹æ³•<code>tableSizeFor</code>è¿™ä¸ªæ–¹æ³•ï¼Œæ¯”å¦‚è¯´ä½ æŒ‡å®šåˆå§‹åŒ–å®¹é‡ä¸º1000ï¼Œå®é™…åˆ›å»ºå‡ºæ¥çš„è¡¨å®¹é‡ä¹Ÿæ˜¯æ¯”1000å¤§çš„2çš„æ¬¡å¹‚æ•°å³1024ï¼Œæˆ‘ä»¬é…åˆæœ‰å‚1æ„é€ æ–¹æ³•å»è§£ç­”ï¼Œå½“æˆ‘ä»¬æœ€å¼€å§‹ä½¿ç”¨æœ‰å‚æ„é€ 1çš„æ—¶å€™ï¼Œåªæœ‰<strong>threshold</strong>è¢«èµ‹å€¼ä¸ºæ¯”å¦‚è¯´1000ï¼Œç„¶ååˆ°äº†<code>resize()</code>æ–¹æ³•ï¼š</p>
<blockquote>
<p>oldCap=0ï¼›</p>
<p>oldThr = threshold = 1024ï¼›</p>
<p>newCap = oldThr = 1024ï¼›</p>
<p>newThr = newCap * loadFactor = 1024 * 0.75ï¼›</p>
</blockquote>
<p>æ‰€ä»¥æ–°å®¹é‡å°±æ˜¯1024ï¼</p>

          <h4 id="d6f701a8">
            <a name="_root-containsKey" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            containsKey
          </h4><pre><code class="language-java">public boolean containsKey(Object key) {
    return getNode(hash(key), key) != null;
}</code></pre>
<p>ä¸è§£é‡Šäº†</p>

          <h4 id="72a69d7c">
            <a name="_root-put" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            put
          </h4><pre><code class="language-java">// å¼•putVal
public V put(K key, V value) {
    return putVal(hash(key), key, value, false, true);
}</code></pre>

          <h5 id="1e31c4c9">
            <a name="_root-putVal" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            putVal
          </h5><pre><code class="language-java">final V putVal(int hash, K key, V value, boolean onlyIfAbsent,
               boolean evict) {
    Node&lt;K,V&gt;[] tab; 
    Node&lt;K,V&gt; p; 
    int n, i;
    if ((tab = table) == null || (n = tab.length) == 0)
        n = (tab = resize()).length;
    if ((p = tab[i = (n - 1) &amp; hash]) == null)
        tab[i] = newNode(hash, key, value, null);
    else {
        Node&lt;K,V&gt; e; K k;
        if (p.hash == hash &amp;&amp;
            ((k = p.key) == key || (key != null &amp;&amp; key.equals(k))))
            e = p;
        else if (p instanceof TreeNode)
            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value);
        else {
            for (int binCount = 0; ; ++binCount) {
                if ((e = p.next) == null) {
                    p.next = newNode(hash, key, value, null);
                    if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st
                        treeifyBin(tab, hash);
                    break;
                }
                if (e.hash == hash &amp;&amp;
                    ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))
                    break;
                p = e;
            }
        }
        if (e != null) { // existing mapping for key
            V oldValue = e.value;
            if (!onlyIfAbsent || oldValue == null)
                e.value = value;
            afterNodeAccess(e);
            return oldValue;
        }
    }
    ++modCount;
    if (++size &gt; threshold)
        resize();
    afterNodeInsertion(evict);
    return null;
}</code></pre>
<p>å‡è®¾æˆ‘ä»¬è¦å­˜å‚¨çš„keyå’Œvalueç»„è£…æˆäº†ä¸€ä¸ª<strong>ç®±å­ï¼ˆnodeï¼‰</strong>ï¼Œæˆ‘ä»¬çš„å·¥ä½œæ˜¯è¦æŠŠè¿™ä¸ªç®±å­æ”¾åœ¨mapä¸­åˆé€‚çš„ä½ç½®ä¸Š</p>
<ul>
<li><strong>tab</strong>ä»£è¡¨å½“å‰çš„è¡¨ï¼Œåœ¨<code>line:6</code>è¢«èµ‹å€¼ï¼Œ<code>line:7</code>æˆ‘ä»¬çœ‹åˆ°å¦‚æœmapæ˜¯ä¸€ä¸ªæ²¡è¢«åˆå§‹åŒ–è¿‡çš„mapï¼Œé‚£ä¹ˆå°±è°ƒç”¨<code>resize()</code>æ–¹æ³•åˆå§‹åŒ–ä¸€ä¸ªmapï¼›</li>
<li><strong>p</strong>ç”¨æ¥é¢„å­˜ä¹‹å‰åœ¨è¿™ä¸ªä»“ä½ä¸Šçš„ç¬¬ä¸€ä¸ªç®±å­ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªç»“ç‚¹ï¼Œåœ¨<code>line:8</code>è¢«èµ‹å€¼ï¼ŒåŒæ—¶ä¹Ÿåšé“¾éå†çš„<strong>åŒæŒ‡é’ˆä¹‹ä¸€</strong>ï¼Œä¸”å¦‚æœä½ç½®ä¸ŠåŸæœ¬å°±æ²¡æœ‰å…ƒç´ çš„è¯ï¼Œå°±ä¸ä¼šè¿›è¡Œ<code>line:10-38</code>çš„ä¸€ç³»åˆ—æ“ä½œï¼Œè€Œæ˜¯ç›´æ¥åœ¨<code>line:9</code>è¢«èµ‹äºˆæ–°çš„ç»“ç‚¹ï¼›å¦‚æœåŸæ¥ä½ç½®ä¸Šæœ‰å…ƒç´ çš„è¯ï¼Œé‚£ä¹ˆç»§ç»­è¿›è¡Œå¦‚ä¸‹é€»è¾‘ï¼š<ul>
<li>é¦–å…ˆæœ‰ä¸€ä¸ª<strong>e</strong>ï¼Œç”¨æ¥å­˜å‚¨ä¸€ä¸ªç»“ç‚¹ï¼Œè¿™ä¸ªeæœ‰ä¸¤ä¸ªä½œç”¨ï¼Œä¸€ä¸ªæ˜¯ç”¨ä½œé“¾éå†çš„<strong>åŒæŒ‡é’ˆä¹‹ä¸€</strong>ï¼Œå¦ä¸€ä¸ªå°±æ˜¯åœ¨é“¾ä¸­å·²ç»å­˜åœ¨ä¸€ä¸ªå’Œè¦å­˜å…¥çš„ç®±å­å…·æœ‰ç›¸åŒçš„<strong>hashå’Œkey</strong>çš„ç®±å­çš„æƒ…å†µä¸‹ï¼Œå­˜å‚¨è¿™ä¸ªå·²å­˜åœ¨çš„ç®±å­ï¼Œç”¨äºåé¢åˆ¤æ–­æ˜¯å¦è¦†ç›–value</li>
<li>è¿˜æœ‰ä¸€ä¸ª<strong>k</strong>ï¼Œç”¨æ¥å­˜å‚¨è¦å­˜å…¥ç®±å­çš„keyå€¼ï¼›</li>
</ul>
</li>
</ul>
<p><code>line:12-16</code>å¦‚æœhashï¼ˆkeyçš„hashå€¼ï¼‰ã€keyéƒ½ä¸€æ ·ï¼Œé‚£eå°±è¢«èµ‹å€¼ä¸ºpï¼Œè¿™æ—¶å€™ä¹Ÿå°±æ˜¯è¯¥ä»“ä½ä¸ŠåŸæ¥çš„ç¬¬ä¸€ä¸ªç®±å­ï¼›å¦‚æœä¸ä¸€æ ·ï¼Œé‚£å°±æ¥ç€åˆ¤æ–­pæ˜¯ä¸æ˜¯æ ‘ç®±å­ï¼Œå¦‚æœæ˜¯æ ‘ç®±å­ï¼Œé‚£ä¹ˆå°±æŒ‰ç…§æ ‘çš„æ–¹å¼å»å­˜æ”¾æˆ‘ä»¬è¦å­˜æ”¾çš„ç®±å­ï¼›</p>
<p>å¦‚æœè¿˜ä¸æ˜¯æ ‘ç®±å­ï¼Œæ„å‘³ç€è¿™æ—¶å€™è¿™ä¸ª<strong>ä»“ä½</strong>ä¸‹çš„ç®±ç¾¤ç»“æ„æ˜¯<strong>é“¾ç®±ç¾¤</strong>ï¼Œæˆ‘ä»¬æ‰§è¡Œ<code>line:17-30</code>ï¼Œå°è¯•æ‘¸åˆ°é“¾å°¾ï¼ŒæŠŠæ–°ç»“ç‚¹æ·»åŠ åˆ°é“¾å°¾<code>line:20</code>ï¼Œç„¶ååˆ¤æ–­é“¾é•¿åº¦ï¼Œåˆ°è¾¾æ ‘åŒ–é˜ˆå€¼å°±å°†<strong>é“¾ç®±ç¾¤</strong>æ ‘åŒ–ä¸º<strong>æ ‘ç®±ç¾¤</strong><code>line:21-22</code>ï¼›</p>
<p>å¦‚æœåœ¨æ‘¸é“¾å°¾çš„è¿‡ç¨‹ä¸­å‘ç°æœ‰hashå’Œkeyéƒ½ä¸€æ ·çš„ï¼Œè¿™å°±æ„å‘³ç€<strong>keyå†²çªï¼ˆkey conflictï¼‰</strong>ï¼Œèµ‹å€¼<strong>e</strong>ä¹‹åï¼ˆä»£è¡¨è®°ä¸‹è¿™ä¸ªå†²çªçš„ä½ç½®äº†ï¼‰ï¼Œé‚£å°±å¯ä»¥é€€å‡ºå¾ªç¯äº†<code>line:25-27</code>ï¼›</p>
<p><code>line:31-37</code>æ˜¯å¯¹<strong>keyå†²çª</strong>çš„æƒ…å†µè¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœå˜é‡<strong>onlyIfAbsent</strong>æ˜¯çœŸï¼Œé‚£ä¹ˆå°±ä¸è¦†ç›–åŸæœ‰keyå¯¹åº”çš„valueï¼›æˆ‘ä»¬çš„<code>put</code>æ–¹æ³•ä¼ çš„å°±æ˜¯falseï¼Œä¹Ÿå°±æ˜¯é»˜è®¤è¦†ç›–keyç›¸åŒçš„valueï¼›</p>
<p><strong>éœ€è¦å¼ºè°ƒçš„æ˜¯ï¼šæ•´ä¸ªæ–¹æ³•ä¸­ï¼Œhashæ–¹æ³•å’Œequalsæ–¹æ³•çš„åœ°ä½éƒ½æ˜¯æ— æ¯”é‡è¦çš„ï¼</strong></p>
<p>åé¢è¿˜æ³¨æ„åˆ°æœ‰<code>afterNodeAccess</code>å’Œ<code>afterNodeInsertion</code>ä¸¤ä¸ªæ–¹æ³•ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•åœ¨<code>HashMap</code>ä¸­æ²¡æœ‰å®ç°ï¼Œæ˜¯ç»™<code>LinkedHashMap</code>å»å®ç°çš„ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¸å¿…å…³å¿ƒï¼›</p>
<p>æœ€åè°ƒæ•´ä¸»ä»“ï¼Œå¦‚æœä¸»ä»“sizeå¤§äºé˜ˆå€¼å°±æ‰§è¡Œ<code>resize()</code>æ–¹æ³•ï¼›</p>

          <h6 id="c8a845fe">
            <a name="_root-resize" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            resize
          </h6><pre><code class="language-java">// è¿™ä¸ªæ–¹æ³•å¾ˆå…³é”® ç”¨äºè°ƒæ•´ä¸»ä»“çš„å¤§å°
// è¦ä¹ˆæ˜¯åˆå§‹åŒ–ä¸€ä¸ªä¸»ä»“ è¦ä¹ˆå°†ä¸»ä»“æ‰©è‡³2å€å¤§
// å¦‚æœæ—§ä¸»ä»“æ˜¯null é‚£å°±åˆ†é…ä¸€ä¸ªå’Œæ ¹æ®é˜ˆå€¼åšå‚è€ƒçš„ä¸»ä»“
// å¦åˆ™çš„è¯ ä½¿ç”¨2çš„æ¬¡å¹‚å€¼å»è°ƒæ•´å®¹é‡ å…ƒç´ è¦ä¹ˆåœ¨åŸæ¥çš„ä½ç½® è¦ä¹ˆåœ¨æ–°çš„è¡¨ä¸­æœ‰2çš„æ¬¡å¹‚çš„åç§»é‡
final Node&lt;K,V&gt;[] resize() {
    Node&lt;K,V&gt;[] oldTab = table;
    int oldCap = (oldTab == null) ? 0 : oldTab.length;
    int oldThr = threshold;
    int newCap, newThr = 0;
    if (oldCap &gt; 0) {
        if (oldCap &gt;= MAXIMUM_CAPACITY) {
            threshold = Integer.MAX_VALUE;
            return oldTab;
        }
        else if ((newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp;
                 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)
            newThr = oldThr &lt;&lt; 1; // double threshold
    }
    else if (oldThr &gt; 0) // initial capacity was placed in threshold
        newCap = oldThr;
    else {               // zero initial threshold signifies using defaults
        newCap = DEFAULT_INITIAL_CAPACITY;
        newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);
    }
    if (newThr == 0) {
        float ft = (float)newCap * loadFactor;
        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ?
                  (int)ft : Integer.MAX_VALUE);
    }
    threshold = newThr;
    @SuppressWarnings({&quot;rawtypes&quot;,&quot;unchecked&quot;})
        Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])new Node[newCap];
    table = newTab;
    if (oldTab != null) {
        for (int j = 0; j &lt; oldCap; ++j) {
            Node&lt;K,V&gt; e;
            if ((e = oldTab[j]) != null) {
                oldTab[j] = null;
                if (e.next == null)
                    newTab[e.hash &amp; (newCap - 1)] = e;
                else if (e instanceof TreeNode)
                    ((TreeNode&lt;K,V&gt;)e).split(this, newTab, j, oldCap);
                else { // preserve order
                    Node&lt;K,V&gt; loHead = null, loTail = null;
                    Node&lt;K,V&gt; hiHead = null, hiTail = null;
                    Node&lt;K,V&gt; next;
                    do {
                        next = e.next;
                        if ((e.hash &amp; oldCap) == 0) {
                            if (loTail == null)
                                loHead = e;
                            else
                                loTail.next = e;
                            loTail = e;
                        }
                        else {
                            if (hiTail == null)
                                hiHead = e;
                            else
                                hiTail.next = e;
                            hiTail = e;
                        }
                    } while ((e = next) != null);
                    if (loTail != null) {
                        loTail.next = null;
                        newTab[j] = loHead;
                    }
                    if (hiTail != null) {
                        hiTail.next = null;
                        newTab[j + oldCap] = hiHead;
                    }
                }
            }
        }
    }
    return newTab;
}</code></pre>
<ol>
<li><code>line:9-29</code>ï¼šè¿™ä¸€é˜¶æ®µä¸»è¦æ˜¯ç¡®å®šæ–°çš„é˜ˆå€¼å’Œæ–°çš„å®¹é‡ï¼Œè¦ä¹ˆæ˜¯åŸæ¥çš„ä¸¤å€ï¼Œè¦ä¹ˆæœ€å¤§ä¹Ÿå¤§ä¸è¿‡Integerçš„æœ€å¤§å€¼</li>
<li><code>line:33</code>ï¼šä¹‹åçš„ä»£ç ä¸»è¦å°±æ˜¯å…ƒç´ çš„æ¬è¿å·¥ä½œäº†ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯è¿™é‡Œé¢æœ‰<code>TreeNode</code>å¯¹è±¡è°ƒç”¨çš„<code>split</code>æ–¹æ³•ï¼Œå¯èƒ½ä¼šè°ƒæ•´ä¸€äº›ç®±å­çš„ä½ç½®ï¼ˆå¹¶ä¸æ˜¯è°ƒæ•´ç®±å­æ‰€åœ¨çš„ä»“ä½ï¼‰æ¯”å¦‚<strong>é€†æ ‘åŒ–ä¸€ä¸ªæ ‘ç®±ç¾¤</strong></li>
</ol>

          <h6 id="b541ee">
            <a name="_root-æ ‘ç®±å­â€”â€”å¤§åé¼é¼çš„çº¢é»‘æ ‘" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            æ ‘ç®±å­â€”â€”å¤§åé¼é¼çš„çº¢é»‘æ ‘
          </h6><p>è¿™æ–¹æ³•é‡Œé¢çš„ä¸€äº›æ ‘æ“ä½œç»†èŠ‚ï¼Œå¾—å…ˆäº†è§£æ¸…æ¥š<strong>æ ‘ç®±å­</strong>çš„ç»“æ„ï¼Œæ‰å¥½ç»§ç»­åˆ†æï¼Œæ‰€ä»¥è¿™é‡Œå…ˆæ’æ’­ä¸€ä¸‹ï¼Œäº†è§£ä¸€ä¸‹<strong>æ ‘ç®±å­</strong>çš„ç»“æ„</p>
<pre><code class="language-java">static final class TreeNode&lt;K,V&gt; extends LinkedHashMap.Entry&lt;K,V&gt; {
    TreeNode&lt;K,V&gt; parent;  // red-black tree links
    TreeNode&lt;K,V&gt; left;
    TreeNode&lt;K,V&gt; right;
    TreeNode&lt;K,V&gt; prev;    // needed to unlink next upon deletion
    boolean red;
    // ...
}
// è¿™ä¸ªæ˜¯LinkedHashMap.Entry&lt;K,V&gt; ç»“æ„ä¹ŸæŒºç®€å•
static class Entry&lt;K,V&gt; extends HashMap.Node&lt;K,V&gt; {
    Entry&lt;K,V&gt; before, after;
    Entry(int hash, K key, V value, Node&lt;K,V&gt; next) {
        super(hash, key, value, next);
    }
}</code></pre>
<p>è¿™é‡Œè™½ç„¶è¯´ç»§æ‰¿å…³ç³»ç¨å¾®å¤æ‚äº†ç‚¹ï¼Œä½†æ˜¯å•çº¯ä»æ•°æ®ç»“æ„çš„è§’åº¦å»ç†è§£è¿˜æ˜¯æŒºç®€å•çš„ï¼š</p>
<p><code>HashMap</code>çš„<strong>ä¸»ä»“</strong>æ˜¯ä¸€ä¸ªNodeæ•°ç»„ï¼Œ<code>HashMap.Entry</code>ï¼Œä»…ä»…ç”¨äºå­˜æ”¾é”®å€¼å¯¹ï¼›</p>
<p>è€Œ<code>LinkedHashMap</code>çš„<strong>ä¸»ä»“</strong>ä¹‹é—´çš„<strong>ä»“ä½</strong>æ˜¯ä»¥é“¾çš„å½¢å¼ç»„ç»‡çš„ï¼Œ<code>LinkedHashMap.Entry&lt;K,V&gt;</code>é™¤äº†é”®å€¼å¯¹è¿˜è¦å­˜æ”¾å‰ä¸€ä¸ªä»“ä½ï¼ˆbeforeï¼‰ä»¥åŠåä¸€ä¸ªä»“ä½ï¼ˆafterï¼‰</p>
<p>å†è¯´å›<code>TreeNode&lt;K,V&gt;</code>ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œè¿™æ˜¯ä¸€ä¸ª3+1æŒ‡é’ˆçš„ç»“ç‚¹ï¼Œ3åˆ†åˆ«æŒ‡å‘ï¼š<strong>çˆ¶ç»“ç‚¹ï¼ˆparentï¼‰ã€å·¦å­©å­ç»“ç‚¹ï¼ˆleftï¼‰ã€å³å­©å­ç»“ç‚¹ï¼ˆrightï¼‰</strong>ï¼Œ1æŒ‡çš„æ˜¯<strong>å‰æŒ‡é’ˆï¼ˆprevï¼‰</strong>ï¼Œç”¨äºåˆ é™¤ç»“ç‚¹çš„æ—¶å€™ï¼Œåšè¾…åŠ©æŒ‡é’ˆç”¨ï¼Œå‰æŒ‡é’ˆä¸ä¸€å®šæ˜¯çˆ¶èŠ‚ç‚¹ï¼›å†åŠ ä¸Šé—´æ¥ç»§æ‰¿è‡ª<code>HashMap.Node&lt;K,V&gt;</code> ï¼Œ<strong>é‚£ä¹ˆå°±è¿˜æœ‰ä¸€ä¸ªnextæŒ‡é’ˆï¼</strong></p>
<p>å¦‚æœæ²¡åˆ†æé”™çš„è¯ï¼Œ<strong>æ ‘ç®±å­</strong>çš„ç»“æ„å°±åº”è¯¥æ˜¯ï¼š</p>
<p>
        <div class="_showpic_c0f5bc18 showpicbtn">Loading images >></div>
        <img href=https://image.youyinnn.top/20180818150455.png class="_pic_c0f5bc18 hidepic" picId="c0f5bc18"></img>
        <script>
            {
                let imgselfc0f5bc18s = document.getElementsByClassName('_pic_c0f5bc18')
                let showpicbtnc0f5bc18s = document.getElementsByClassName('_showpic_c0f5bc18')
                let isInViewPortOfTwoc0f5bc18 = function () {
                    const viewPortHeight = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight 
                    const top = imgselfc0f5bc18s[0].getBoundingClientRect() && imgselfc0f5bc18s[0].getBoundingClientRect().top
                    if (top  <= viewPortHeight + 300) {
                        for (el of imgselfc0f5bc18s) {
                            el.src = el.getAttribute('href')
                            el.classList.add('showpic')
                            window.removeEventListener('scroll', isInViewPortOfTwoc0f5bc18)
                            isInViewPortOfTwoc0f5bc18 = null
                        }
                        for (el of showpicbtnc0f5bc18s) {
                            el.style.display = 'none'
                        }
                    }
                }
                window.addEventListener('scroll', isInViewPortOfTwoc0f5bc18)
            }
        </script>
    </p>
<p>è¿™é‡Œåº”è¯¥è¿˜æœ‰<strong>before</strong>å’Œ<strong>after</strong>ï¼Œä½†æ˜¯å’ŒHashMapæ— å…³ï¼Œå°±å¿½ç•¥äº†ï¼Œè€Œä¸”æˆ‘è®¤ä¸ºè¿™é‡Œæœ‰ç‚¹<strong>è®¾è®¡è¿‡åº¦</strong>ï¼Œ<strong>æœ‰äº†prevå’Œnextï¼Œä¸ºä»€ä¹ˆè¿˜è¦beforeå’Œafterï¼Ÿ</strong></p>

          <h6 id="2fa17b6a">
            <a name="_root-treeifyBin" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            treeifyBin
          </h6><p>ä¸ç®¡æ€ä¹ˆè¯´ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¼€å§‹åˆ†ææ ‘åŒ–æ–¹æ³•ï¼š</p>
<pre><code class="language-java">// æ ‘åŒ–è¿™ä¸ªhashä»“ä½ä¸Šçš„ç®±ç¾¤
final void treeifyBin(Node&lt;K,V&gt;[] tab, int hash) {
    int n, index; Node&lt;K,V&gt; e;
    if (tab == null || (n = tab.length) &lt; MIN_TREEIFY_CAPACITY)
        resize();
    else if ((e = tab[index = (n - 1) &amp; hash]) != null) {
        TreeNode&lt;K,V&gt; hd = null, tl = null;
        do {
            TreeNode&lt;K,V&gt; p = replacementTreeNode(e, null);
            if (tl == null)
                hd = p;
            else {
                p.prev = tl;
                tl.next = p;
            }
            tl = p;
        } while ((e = e.next) != null);
        if ((tab[index] = hd) != null)
            hd.treeify(tab);
    }
}</code></pre>
<p>ç›´æ¥å¼€å§‹åˆ†æ<code>line:6-17</code>ï¼Œè¿™é‡Œæœ‰è®¸å¤šæŒ‡é’ˆéœ€è¦ä¸€ä¸€åˆ†æï¼Œæ•´ä½“çš„æ“ä½œå°±æ˜¯å¯¹è¿™æ¡é“¾è¿›è¡Œéå†ï¼ŒåŒæ—¶å°†æ™®é€šç®±å­å˜æˆæ ‘ç®±ï¼ˆæ ‘åŒ–ï¼‰ï¼š</p>
<ul>
<li><strong>e</strong>ä»£è¡¨å½“å‰éå†åˆ°çš„æ™®é€šç®±å­ï¼›</li>
<li><strong>hd</strong>ä»£è¡¨å½“å‰é“¾ç®±çš„ç¬¬ä¸€ä¸ªç®±å­ï¼Œheadç®±å­ï¼Œå§‹ç»ˆæŒ‡å‘ç®±ç¾¤çš„ç¬¬ä¸€ä¸ªç®±å­ï¼›</li>
<li><strong>tl</strong>ä»£è¡¨è½¬æ¢ä¸ºæ ‘ç®±ç¾¤ä¹‹åä¸­çš„æŸä¸€ä¸ªæ ‘ç®±ï¼›</li>
<li><strong>p</strong>ä»£è¡¨å°†<strong>e</strong>ç®±å­æ ‘åŒ–ä¹‹åå¾—åˆ°çš„æ•°ç®±å­ï¼›</li>
</ul>
<p>å…¶å®è§‚å¯Ÿä¸¤è½®<code>do{}</code>æ“ä½œä¹‹åï¼Œå°±æ¯”è¾ƒæ¸…æ™°äº†ï¼Œåªå…³å¿ƒæ ‘ç®±å­ä¸­çš„<strong>prev</strong>å’Œ<strong>next</strong>æŒ‡é’ˆçš„è¯ï¼Œè¿™é¡¿æ“ä½œå°±åªæ˜¯æŠŠåŸæ¥çš„å•é¡¹é“¾è¡¨copyä¸ºä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œç»“ç‚¹ä¹‹é—´æœ‰<strong>prev</strong>å’Œ<strong>next</strong>çš„å…³ç³»ï¼ŒåŸæ¥åªæœ‰<strong>next</strong>ï¼Œç„¶åæ¯ä¸ª<code>Node</code>æ¢æˆäº†<code>TreeNode</code>è€Œå·²ï¼›</p>
<p>ç„¶åæ‹¿ç€<strong>hd</strong>å’Œ<strong>tab</strong>ï¼Œè°ƒç”¨<code>treeify</code>æ–¹æ³•ï¼Œå°†è¿™æ¡é“¾å˜æˆæ ‘ï¼Œç”±äºæ ‘åŒ–æ˜¯é€‰æ‹©<strong>çº¢é»‘æ ‘</strong>å»åšï¼Œæ‰€ä»¥<strong>tab</strong>è¿™ä¸ªä»“ä½çš„ç¬¬ä¸€ä¸ªæ ‘ç®±å­ä¸ä¸€å®šæ˜¯<strong>hd</strong>åŸæ¥æŒ‡çš„é‚£ä¸ªç®±å­ï¼›å…³äºè¿™ä¸ªæ–¹æ³•ï¼Œå°±ä¸ç»§ç»­å¾€ä¸‹åˆ†æäº†ï¼Œæ¶‰åŠåˆ°å¾ˆå¤šçº¢é»‘æ ‘çš„çŸ¥è¯†ï¼Œä½†æ˜¯ï¼š<strong>æ­£æ˜¯å› ä¸ºçº¢é»‘æ ‘çš„åŸå› ï¼Œçº¢é»‘æ ‘çš„æŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤çš„æ—¶é—´å¤æ‚åº¦æœ€åä¸ºO(logÂ n)ï¼</strong> </p>
<blockquote>
<p><em>å‚è€ƒï¼š</em></p>
<ul>
<li><a href="http://www.cnblogs.com/skywang12345/p/3245399.html">http://www.cnblogs.com/skywang12345/p/3245399.html</a></li>
<li><a href="https://blog.csdn.net/v_JULY_v/article/details/6105630">https://blog.csdn.net/v_JULY_v/article/details/6105630</a></li>
</ul>
</blockquote>
<p>è¿™é‡Œè¦ç‰¹åˆ«ç•™å¿ƒï¼<strong>æ ‘åŒ–è¿‡åçš„ç®±ç¾¤ï¼Œè¿˜ä¿æœ‰åŸæ¥çš„é“¾ç®±ç¾¤çš„prevå’Œnextçš„å…³ç³»ï¼ä¸ºäº†æ–¹ä¾¿ç›´æ¥åœ¨prevå’Œnextçš„å…³ç³»ä¸Šç›´æ¥è¿›è¡Œé€†æ ‘åŒ–ï¼</strong></p>

          <h4 id="d507ab89">
            <a name="_root-remove" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            remove
          </h4><p>åŒç†å¼•å‡ºremoveNode</p>
<pre><code class="language-java">public V remove(Object key) {
    Node&lt;K,V&gt; e;
    return (e = removeNode(hash(key), key, null, false, true)) == null ?
        null : e.value;
}</code></pre>

          <h5 id="c0003b6">
            <a name="_root-removeNode" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            removeNode
          </h5><pre><code class="language-java">final Node&lt;K,V&gt; removeNode(int hash, Object key, Object value,
                           boolean matchValue, boolean movable) {
    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, index;
    if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp;
        (p = tab[index = (n - 1) &amp; hash]) != null) {
        Node&lt;K,V&gt; node = null, e; K k; V v;
        if (p.hash == hash &amp;&amp;
            ((k = p.key) == key || (key != null &amp;&amp; key.equals(k))))
            node = p;
        else if ((e = p.next) != null) {
            if (p instanceof TreeNode)
                node = ((TreeNode&lt;K,V&gt;)p).getTreeNode(hash, key);
            else {
                do {
                    if (e.hash == hash &amp;&amp;
                        ((k = e.key) == key ||
                         (key != null &amp;&amp; key.equals(k)))) {
                        node = e;
                        break;
                    }
                    p = e;
                } while ((e = e.next) != null);
            }
        }
        if (node != null &amp;&amp; (!matchValue || (v = node.value) == value ||
                             (value != null &amp;&amp; value.equals(v)))) {
            if (node instanceof TreeNode)
                ((TreeNode&lt;K,V&gt;)node).removeTreeNode(this, tab, movable);
            else if (node == p)
                tab[index] = node.next;
            else
                p.next = node.next;
            ++modCount;
            --size;
            afterNodeRemoval(node);
            return node;
        }
    }
    return null;
}</code></pre>
<p>ç»è¿‡getå’Œputçš„æ´—ç¤¼ä¹‹åï¼Œå†çœ‹å…¶ä»–çš„å•å…ƒç´ åŸºç¡€æ“ä½œå°±æ¯”è¾ƒæµç•…äº†ï¼Œæ¦‚æ‹¬ä¸€ä¸‹<code>removeNode</code>åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼š</p>
<p>è§‚å¯Ÿ<strong>node</strong>è¿™ä¸€ä¸ªå˜é‡å°±å¥½äº†ï¼Œå®ƒä»£è¡¨åœ¨è¡¨ä¸­æ˜¯å¦æ‰¾åˆ°ä½ æƒ³è¦åˆ é™¤çš„é‚£ä¸ªç®±å­ï¼Œå¦‚æœæ‰¾åˆ°å°±èµ‹å€¼ä¸ºè¿™ä¸ªç®±å­ï¼Œå¦åˆ™å°±ä¸ºç©º</p>
<ol>
<li>é¦–å…ˆç§’æ‰¾åˆ°ä»“ä½ï¼ˆhashæ˜ å°„åˆ°æ•°ç»„ä¸‹æ ‡ï¼‰ï¼Œç„¶ååˆ¤æ–­ä»“ä½ä¸Šç¬¬ä¸€ä¸ªç®±å­æ˜¯å¦æ˜¯è¦æ‰¾çš„ï¼Œæ˜¯å°±èµ‹å€¼ç»™<strong>node</strong></li>
<li>å¦‚æœä»“ä½ç¬¬ä¸€ä¸ªç®±å­ä¸æ˜¯è¦åˆ é™¤çš„ï¼Œé‚£ä¹ˆå°±ç»§ç»­ï¼Œå¦‚æœæ˜¯æ ‘ç®±å­å°±è°ƒç”¨æ ‘ç»“æ„çš„æŸ¥æ‰¾ç®±å­çš„æ–¹æ³•ï¼Œé“¾ç®±å­å°±å¾€é“¾å°¾æ‘¸ï¼Œæ‰¾åˆ°å°±ç®—</li>
<li>å¦‚æœæ‰¾åˆ°è¿™ä¹ˆä¸€ä¸ª<strong>node</strong>ï¼Œå¹¶ä¸”è¿™ä¸ª<strong>node</strong>ç®±å­æ˜¯æ ‘ç®±å­ï¼Œé‚£ä¹ˆå°±æŒ‰ç…§çº¢é»‘æ ‘çš„åˆ é™¤ç»“ç‚¹è§„åˆ™å»åˆ é™¤ï¼Œå¦åˆ™å°±ç®€å•çš„é“¾å¼åˆ é™¤</li>
</ol>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ<code>line:28</code>çš„<code>removeTreeNode</code>æ–¹æ³•ä¼šå¯¼è‡´ï¼š<strong>é€†æ ‘åŒ–</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´æ ‘ç®±ç¾¤å·²ç»å°äºé€†æ ‘åŒ–çš„é˜ˆå€¼äº†ï¼Œè¿™æ—¶å€™å°±è¦è®©<strong>æ ‘ç®±ç¾¤</strong>é€†æ ‘åŒ–ä¸º<strong>é“¾ç®±ç¾¤</strong></p>
<p>è‡³äºé€†æ ‘åŒ–ä¹Ÿéå¸¸ç®€å•ï¼Œå› ä¸ºæ ‘åŒ–çš„æ—¶å€™è¿˜ä¿ç•™<strong>prev</strong>å’Œ<strong>next</strong>å…³ç³»ï¼Œæ‰€ä»¥ç›´æ¥é¡ºç€<strong>next</strong>å»æ›¿æ¢ç»“ç‚¹ç»“æ„å°±è¡Œäº†</p>

          <h3 id="e3a4b131">
            <a name="_root-æ€»ç»“" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            æ€»ç»“
          </h3><p>ä¸»è¦ä¹Ÿæ˜¯å¥½å¥½äº†è§£äº†ä¸€ä¸‹<code>HashMap</code>åœ¨å­˜å‚¨ç»“æ„ä¸Šçš„ç‰¹ç‚¹ï¼Œå†ç»†è‡´çš„æ€§èƒ½æ–¹é¢çš„åˆ†æï¼Œç›®å‰è¿˜æ²¡ç²¾åŠ›ç ”ç©¶ï¼Œå…¶ä»–æ–¹æ³•æ¯”å¦‚<code>containsValue(Object value)</code>ã€<code>remove(Object key, Object value)</code>ã€<code>replace(K key, V oldValue, V newValue)</code>ï¼Œå¤„ç†æ€è·¯éƒ½å¤§åŒå°å¼‚</p>
<p>æœ¬ç¯‡å…³é”®åˆ†æäº†å¦‚ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li>HashMapçš„å­˜å‚¨æ¡ä»¶</li>
<li>ä¸»ä»“æ˜¯ä»€ä¹ˆï¼Ÿé“¾ç®±å­æ˜¯ä»€ä¹ˆï¼Ÿæ ‘ç®±å­æ˜¯ä»€ä¹ˆï¼Ÿåˆ°åº•æ˜¯ä»€ä¹ˆç»“æ„ï¼Ÿ</li>
<li>ä»€ä¹ˆæ—¶å€™æ ‘åŒ–ï¼Ÿæ ‘åŒ–åˆ†å‡ æ­¥ï¼Ÿä»€ä¹ˆæ—¶å€™é€†æ ‘åŒ–ï¼Ÿ</li>
<li>æ‰©å®¹é˜ˆå€¼ã€æ ‘åŒ–é˜ˆå€¼æ˜¯ä»€ä¹ˆï¼Ÿåˆ†åˆ«æœ‰ä»€ä¹ˆç”¨ï¼Ÿè´Ÿè½½å› å­åˆæ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ul>
<p><strong>HashMapçš„å­˜å‚¨æ¡ä»¶ï¼š</strong> <strong>KEY</strong>éœ€è¦å®ç°<code>hashcode</code>å’Œ<code>equals</code>æ–¹æ³•ï¼Œå‰è€…ç”¨æ¥æ‰¾ä»“ä½ï¼Œåè€…ç”¨æ¥åˆ¤æ–­æ˜¯å¦é”®å†²çªï¼<code>hashcode</code>å†²çªæ„å‘³ç€å­˜å‚¨ä½ç½®çš„å†²çªï¼Œè¿™å¯¹å®¹å™¨çš„ä½¿ç”¨è€…æ˜¯é€æ˜çš„ï¼Œä½¿ç”¨è€…ä¸å¿…å…³å¿ƒï¼Œè€Œ<code>equals</code>å†²çªæ„å‘³ç€å®¹å™¨ä½¿ç”¨è€…è¯•å›¾æ›¿æ¢æ‰ä»–è§„å®šçš„é”®ä¸Šçš„å€¼ï¼</p>
<p><strong>ä¸»ä»“ï¼š</strong>å°±æ˜¯å®¹å™¨çš„ä¸»å¹²ï¼Œä¹Ÿå°±æ˜¯Nodeæ•°ç»„ï¼Œä¸»ä»“ä¸Šçš„æ¯ä¸€ä¸ªä½ç½®æ˜¯ä»“ä½ï¼Œæ³¨é‡Šä¸­å¤šæ¬¡ä»¥bucketï¼ˆæ¡¶ï¼‰å»æè¿°è¿™ä¸ªæ¦‚å¿µï¼›</p>
<p><strong>é“¾ç®±å­ï¼š</strong>å°±æ˜¯ä¸€èˆ¬çš„é“¾å¼ç»“ç‚¹ï¼Œæ¯ä¸ªä»“ä½ä¸Šä¸€å¼€å§‹æ”¾çš„å°±æ˜¯é“¾ç®±å­ï¼›</p>
<p><strong>æ ‘ç®±å­ï¼š</strong>å°±æ˜¯çº¢é»‘æ ‘çš„ä¸€ä¸ªç»“ç‚¹ï¼Œå½“è¿™ä¸ªä»“ä½å­˜æ”¾è¶…è¿‡8ä¸ªé“¾ç®±å­çš„æ—¶å€™ï¼Œè¿™ä¸ª<strong>é“¾ç®±ç¾¤</strong>å°±ä¼šè½¬å˜ä¸º<strong>æ ‘ç®±ç¾¤</strong>ï¼Œæ ‘ç®±ç¾¤ä¸­æ¯ä¸€ä¸ªç®±å­éƒ½æ˜¯çº¢é»‘æ ‘ç»“ç‚¹ï¼›</p>
<p><strong>æ ‘åŒ–æ—¶æœºï¼š</strong>æœ‰ä¸€ä¸ªé™æ€å˜é‡â€”â€”<strong>æ ‘åŒ–é˜ˆå€¼<code>TREEIFY_THRESHOLD</code></strong>åšå‚è€ƒï¼Œå€¼ä¸º8ï¼Œæ—¶æœºå¦‚ä¸Šï¼›</p>
<p><strong>æ ‘åŒ–æ­¥éª¤ï¼š</strong>å°†é“¾ç®±ç¾¤ä¸­çš„é“¾ç®±ç»“ç‚¹æ›¿æ¢ä¸ºæ ‘ç®±ç»“ç‚¹ï¼Œè¿™æ—¶å€™è¿˜æ˜¯ä¸€æ¡é“¾å¼ç»“æ„ï¼Œç„¶åå°†è¿™ä¸ªé“¾å¼ç»“æ„è½¬æ¢ä¸ºä¸€ä¸ªæ ‘ç»“æ„<code>treeify</code>æ–¹æ³•ï¼›</p>
<p><strong>é€†æ ‘åŒ–ï¼š</strong>å½“æ ‘ç®±ç¾¤ç®±å­æ•°å°‘äº<code>UNTREEIFY_THRESHOLD</code>ï¼Œä¹Ÿå°±æ˜¯6çš„æ—¶å€™ï¼Œå°±ä¼šé€†æ ‘åŒ–ï¼›</p>
<p><strong>æ‰©å®¹é˜ˆå€¼ï¼ˆthresholdï¼‰ï¼š</strong>è¿™ä¸ªå€¼é»˜è®¤æ˜¯å®¹é‡çš„0.75å€ï¼Œæœ€å¥½ä¹Ÿæ˜¯å®¹é‡çš„0.75å€ï¼Œå½“å®¹å™¨è½½é‡è¶…è¿‡è¿™ä¸ªå€¼çš„æ—¶å€™ï¼Œæ¯”å¦‚1024çš„0.75ï¼Œå®¹å™¨å°±éœ€è¦<code>resize()</code>æ‰©å®¹ä¸¤å€ï¼›</p>
<p><strong>è´Ÿè½½å› å­ï¼ˆload factorï¼‰ï¼š</strong>é»˜è®¤æ˜¯0.75ï¼Œå®ƒè¡¨ç¤ºHashMapèƒ½åœ¨å½“å‰å®¹é‡é«˜æ•ˆå·¥ä½œçš„æœ€å¤§è½½é‡å’Œå®¹é‡å€¼æ¯”ï¼Œè½½é‡å’Œå®¹é‡ä¹‹æ¯”å¦‚æœè¾¾åˆ°è´Ÿè½½å› å­ï¼Œé‚£ä¹ˆå°±éœ€è¦æ‰©å®¹</p>

          <h3 id="bbc7371a">
            <a name="_root-æºç åˆ†æå¥½æ–‡ç´¢å¼•" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            æºç åˆ†æå¥½æ–‡ç´¢å¼•
          </h3><ul>
<li>JDK1.7HashMapåˆ†æï¼š<a href="https://www.cnblogs.com/xrq730/p/5030920.html">https://www.cnblogs.com/xrq730/p/5030920.html</a></li>
<li>JDK1.8HashMapåˆ†æï¼š<a href="http://www.importnew.com/20386.html">http://www.importnew.com/20386.html</a></li>
</ul>

    </div>
    <div id="scriptsearcher" class="myhide input-group new_font">
        <input id="searchtext" type="text" class="form-control" placeholder="keywords" autocomplete="off">
        <div class="input-group-append">
            <button id="searchbut" class="btn btn-dark" type="button">Search</button>
        </div>
    </div>

    <div id="bbt" class="myhide new_font">
        <a id="toc" style="display: none;" class="myhide" href="javascript:void(0);" data-toggle="tooltip" data-placement="left" title="show/hide Toc">Toc</a>
        <a id="gohub" href="#" target="_blank" data-toggle="tooltip" data-placement="bottom" title="view this at github">unuse</a>
    </div>

    <div id="share_png_panel" class="myhide">
        <div id="share_curtain"></div>
        <div id="png_box"></div>
        <button id="share_png_paned_close" class="btn btn-dark">Close</button>
    </div>

</body>

</html>