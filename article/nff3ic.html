<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="baidu-site-verification" content="l09YSIpJQW" />
    <meta name="referrer" content="origin">
    <title>blog | youyinnn</title>
    <script src="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@master/myjs/loadscripts.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@master/myjs/jump-1.3.js"></script>
    <link rel="bookmark" href="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@master/img/favicon.ico" />
    <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@master/img/favicon.ico" />
    <link rel="stylesheet" href="/mycss/style.css">

    <script src="/resources/resources.js"></script>
    <script src="/myjs/scriptlist.js"></script>
</head>

<body>

    <ol id="topbar" class="breadcrumb unselectable new_font">
        <p style="color:rgb(214, 214, 214); padding-right: 1rem;">
            <button id="egg" class="egg">ğŸš€</button>&nbsp;&nbsp;&nbsp;&nbsp;&gt;</p>
        <li class="breadcrumb-item">
            <spen id="homebut" href="javaScript:void(0)" class="ah">-home</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="articlesbut" href="javaScript:void(0)" class="ah">-articles</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="scriptbut" href="javaScript:void(0)" class="ah">-scripts</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="todobut" href="javaScript:void(0)" class="ah">-todos</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="resumebut" href="javaScript:void(0)" class="ah">-resume</spen>
        </li>
        <li class="breadcrumb-item dropdown">
            <spen href="javaScript:void(0)" class="ah" role="button" id="friendlinkedbut" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">-friends</spen>
            <div id="fldd" class="dropdown-menu" aria-labelledby="friendlinkedbut" style="border-radius: initial;"></div>
        </li>

        <div id="hb" data-toggle="tooltip" data-placement="bottom" title="show/hide TopBar">

        </div>
    </ol>

    <div id="homepage" class="unselectable new_font myhide">
        <div id="homepage-center">
            <div id="slogan">
                <i id="wolf-logo" style="font-style: normal;" class="mr-4">ğŸŒ‘</i><span id="slogan-text"></span>
            </div>
            <div id="homepage-btn">
                <div id="showmore"> &nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp; About Me & This Blog</div>
                <div id="showhacknical"> &nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp; My Github Analysis</div>
                <div id="toarticles"> &nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp; My Tech Articles</div>
            </div>
        </div>
        <div id="ifwrapper" class="hacknical_hide">
            <iframe id="hacknical_github_analysis" frameborder="0"></iframe>
        </div>
    </div>

    <div id="articles_side_panel" class="unselectable myhide new_font">
        <div id="cates_tree_head">Article Categories</div>
        <div id="cates_tree_body"></div>
        <div id="blog_statistic_head">Blog Statistics</div>
        <table id="blog_statistic_body" class="myhide">
            <tbody>
                <tr>
                    <td style="text-align:right">Online:</td>
                    <td style="text-align:left" id="stat_running"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Article:</td>
                    <td style="text-align:left" id="stat_article_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Chars:</td>
                    <td style="text-align:left" id="stat_typein"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Categories:</td>
                    <td style="text-align:left" id="stat_cate_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Tags:</td>
                    <td style="text-align:left" id="stat_tag_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Last update:</td>
                    <td style="text-align:left" id="stat_last_update"></td>
                </tr>
            </tbody>
        </table>
    </div>
    <div id="docpanel" class="myhide new_font">
        <div id="articlesearch" class="input-group">
            <input id="articlesearchtext" type="text" class="form-control" autocomplete="off" placeholder="search with keywords (algolia)">
            <div id="searchprocessbar">
                <div id="spb-out" class="spb-outter-animate"></div>
                <div id="spb-in" class="spb-inner-animate"></div>
            </div>
            <div class="input-group-append">
                <button id="cleanbut" class="btn btn-light" type="button" title="clear search">cls</button>
                <button id="categories" class="btn btn-light" type="button">cates</button>
                <button id="tags" class="btn btn-light" type="button" title="all tags">tags</button>
                <button id="articlesearchbut" class="btn btn-light" type="button" title="search">sch</button>
            </div>
        </div>
        <div id="searchrscount" class="unselectable"></div>
        <div class="tgs myhide" id="all_cates">
            <span style="font-size: 1rem; font-weight: bold ; padding: 6px;">All categories:</span>
            <br>
        </div>
        <div class="tgs myhide" id="all_tags">
            <span style="font-size: 1rem; font-weight: bold ; padding: 6px;">All tags:</span>
            <br>
        </div>
    </div>

    <div id="sidetoccontainer" class="tochide unselectable new_font">
        <div id="block">
            <div id="percent" data-toggle="tooltip" data-placement="bottom" title="return to the top">0%</div>
        </div>
        <div id="sidetoc" class="unselectable markdown-body editormd-preview-container markdown-toc"></div>
    </div>
    <div id="md" class="myhide markdown-body editormd-html-preview">
        <p><div class="saying mb-4"><div class="saying-quote saying-left-quote">â€œ</div><div class="saying-quote saying-right-quote">â€</div></p>
<p>ä¸Šç¯‡ä»‹ç»äº†ä½¿ç”¨Log4j2ä¹‹å‰çš„å‡†å¤‡å·¥ä½œå’Œç®€å•ä»‹ç»äº†ä¸€ä¸ªHelloWorld</p>
<p>ç°åœ¨æˆ‘ä»¬æ¥äº†è§£é…ç½®ä¸­çš„ç¬¬ä¸€ä¸ªå…³é”®é…ç½®ï¼šAppenders</p>
<p></div></p>
<!-- more -->

<p>å®˜æ–¹æ–‡æ¡£ç»™å‡ºçš„å¯ç”¨çš„Appenderéå¸¸å¤šï¼šæœ‰Asyncï¼ˆå¼‚æ­¥è¾“å‡ºï¼‰ã€Consoleï¼ˆæ§åˆ¶å°è¾“å‡ºï¼‰ã€Fileï¼ˆæ–‡ä»¶è¾“å‡ºï¼‰ã€ç”šè‡³è¿˜æœ‰JDBCå’ŒHTTPç­‰24ç§è¾“å‡ºæºæ–¹å¼ï¼Œç„¶è€Œæˆ‘æ—¥å¸¸ä½¿ç”¨çš„å°±å‡ ä¸ªï¼šConsoleã€RollingFileï¼›ä¸€ä¸ªä½œä¸ºæœ¬åœ°hostè°ƒè¯•çš„æ—¶å€™logï¼Œä¸€ä¸ªä½œä¸ºè¿œç¨‹ä¸»æœºè°ƒè¯•çš„æ—¶å€™å†™logã€‚å…¶ä»–çš„æˆ‘å°±ä¸ä»”ç»†å»ç ”ç©¶äº†ã€‚</p>
<hr>

          <h3 id="256e6fb5">ConsoleAppender</h3><p><code>ConsoleAppender</code>ï¼Œä½¿ç”¨çš„æ˜¯<code>System.out</code>æˆ–è€…<code>System.err</code>ä½œä¸ºè¾“å‡ºæºï¼ŒæŠŠlogæ‰“å°åœ¨æ§åˆ¶å°ä¸Šï¼Œé»˜è®¤çš„æƒ…å†µä¸‹ä½¿ç”¨çš„æ˜¯<code>System.out</code>ã€‚</p>
<pre><code class="language-xml">&lt;Console name=&quot;Console&quot; target=&quot;SYSTEM_OUT&quot;&gt;
    &lt;PatternLayout pattern=&quot;%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n&quot;/&gt;
&lt;/Console&gt;</code></pre>

          <h4 id="2c6c48e9">å¸¸ç”¨å±æ€§</h4><ul>
<li>name ï¼šstringï¼šappenderçš„åå­—</li>
<li>targetï¼šstringï¼šæŒ‡å®šè¾“å‡ºå¯¹è±¡ï¼šå¯é€‰<code>SYSTEM_OUT</code>æˆ–<code>SYSTEM_ERR</code>ï¼Œé»˜è®¤æ˜¯å‰è€…ã€‚</li>
</ul>
<hr>

          <h3 id="658c8761">FileAppender</h3><p>FileAppenderæ˜¯ä¸€ä¸ªè¾“å‡ºæµè¾“å‡ºæºï¼Œå®ƒå¯ä»¥æ ¹æ®ä½ æŒ‡å®šçš„æ–‡ä»¶å‘½åå»åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ã€‚FileAppenderä½¿ç”¨FileManagerï¼ˆç»§æ‰¿è‡ª<code>OutputStreamManager</code>ï¼‰æ¥æ‰§è¡Œæ–‡ä»¶è¾“å…¥è¾“å‡ºã€‚</p>

          <h4 id="2c6c48e9">å¸¸ç”¨å±æ€§</h4><ul>
<li>name ï¼šstringï¼šappenderçš„åå­—</li>
<li>appendï¼šbooleanï¼šé»˜è®¤ä¸ºtrueï¼Œæ­¤æ—¶è¾“å‡ºè®°å½•ä¼šè¢«æ·»åŠ åœ¨åŸæœ‰æ–‡ä»¶çš„æ–‡æœ«ï¼Œå¦åˆ™ä¼šæ¸…ç©ºä¹‹å‰çš„logé‡æ–°è¾“å‡ºã€‚</li>
<li>fileNameï¼šstringï¼šè¾“å‡ºæ–‡ä»¶çš„åå­—</li>
</ul>
<p>è¿˜æœ‰ä¸€äº›å±æ€§åŒ…æ‹¬ï¼šç¼“å†²æµçš„è®¾ç½®ã€æ–‡ä»¶åœ¨linuxç³»ç»Ÿä¸‹çš„ç»„ã€ç”¨æˆ·ã€æƒé™ç­‰ã€‚</p>
<pre><code class="language-xml">&lt;File name=&quot;MyFile&quot; fileName=&quot;logs/app.log&quot;&gt;
  &lt;PatternLayout&gt;
    &lt;Pattern&gt;%d %p %c{1.} [%t] %m%n&lt;/Pattern&gt;
  &lt;/PatternLayout&gt;
&lt;/File&gt;</code></pre>
<hr>

          <h3 id="9eee201b">RandomAccessFileAppender</h3><p>RandomAccessFileAppenderå’Œæ ‡å‡†çš„FileAppenderå¾ˆåƒï¼Œåªä¸è¿‡RandomAccessFileAppenderæ€»æ˜¯ä»¥ç¼“å†²çš„å½¢å¼è¾“å‡ºï¼ˆå¹¶ä¸”ä¸èƒ½å…³é—­ç¼“å†²æµï¼‰ï¼Œåœ¨å…¶å†…éƒ¨å®ç°ä¸­ï¼Œå®ƒä½¿ç”¨<code>ByteBuffer + RandomAccessFile</code>å»ä»£æ›¿äº†<code>BufferedOutputStream</code>ã€‚å®ƒçš„æ€§èƒ½æ¯”FileAppenderèƒ½é«˜å‡º20%~200%ã€‚</p>

          <h4 id="2c6c48e9">å¸¸ç”¨å±æ€§</h4><ul>
<li>name ï¼šstringï¼šappenderçš„åå­—</li>
<li>appendï¼šbooleanï¼šé»˜è®¤ä¸ºtrueï¼Œæ­¤æ—¶è¾“å‡ºè®°å½•ä¼šè¢«æ·»åŠ åœ¨åŸæœ‰æ–‡ä»¶çš„æ–‡æœ«ï¼Œå¦åˆ™ä¼šæ¸…ç©ºä¹‹å‰çš„logé‡æ–°è¾“å‡ºã€‚</li>
<li>fileNameï¼šstringï¼šè¾“å‡ºæ–‡ä»¶çš„åå­—</li>
<li>bufferSizeï¼šingegerï¼šé»˜è®¤æ˜¯256*1024 btyes</li>
</ul>
<pre><code class="language-xml">&lt;RandomAccessFile name=&quot;MyFile2&quot; fileName=&quot;logs/app2.log&quot;&gt;
    &lt;PatternLayout&gt;
        &lt;Pattern&gt;%d %p %c{1.} [%t] %m%n&lt;/Pattern&gt;
    &lt;/PatternLayout&gt;
&lt;/RandomAccessFile&gt;</code></pre>
<hr>

          <h3 id="579dc1f3">RollingFileAppenderï¼ˆé‡ç‚¹ï¼‰</h3><p>RollingFileAppenderæ˜¯æœ€å¸¸ç”¨çš„è¾“å‡ºæµï¼Œå®ƒå¯ä»¥æ ¹æ®<code>TrggeringPolicy(è§¦å‘ç­–ç•¥)</code>å’Œ<code>RolloverPolicy(åˆ‡æ¢ç­–ç•¥)</code>æ¥åˆ‡æ¢ä¸åŒçš„æ—¥å¿—æ–‡ä»¶ï¼Œä»¥è¾¾åˆ°å¯å®šåˆ¶åº¦æ›´é«˜çš„åˆ†ç±»æ—¥å¿—æ–‡ä»¶è¾“å‡ºã€‚</p>
<p>RollingFileAppenderè¦æ±‚æŒ‡å®š<code>TriggeringPolicy</code>å’Œ<code>RolloverStrategy</code>ã€‚è§¦å‘ç­–ç•¥å†³å®šäº†å½“åˆ‡æ¢ç­–ç•¥å®šä¹‰å¥½å¦‚ä½•åˆ‡æ¢çš„æ—¶å€™ï¼Œæ˜¯å¦æ‰§è¡Œåˆ‡æ¢ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šåˆ‡æ¢ç­–ç•¥ï¼Œé‚£ä¹ˆRollingFileAppenderä¼šä½¿ç”¨é»˜è®¤çš„åˆ‡æ¢ç­–ç•¥ã€‚</p>

          <h4 id="2c6c48e9">å¸¸ç”¨å±æ€§</h4><ul>
<li>name ï¼šstringï¼šappenderçš„åå­—</li>
<li>appendï¼šbooleanï¼šé»˜è®¤ä¸ºtrueï¼Œæ­¤æ—¶è¾“å‡ºè®°å½•ä¼šè¢«æ·»åŠ åœ¨åŸæœ‰æ–‡ä»¶çš„æ–‡æœ«ï¼Œå¦åˆ™ä¼šæ¸…ç©ºä¹‹å‰çš„logé‡æ–°è¾“å‡ºã€‚</li>
<li>fileNameï¼šstringï¼šè¾“å‡ºæ–‡ä»¶çš„åå­—</li>
<li>filePatternï¼šstringï¼šåˆ‡æ¢æ—¥å¿—æ–‡ä»¶æ—¶ä½¿ç”¨çš„æ–‡ä»¶åæ¨¡å¼ï¼Œé»˜è®¤çš„åˆ‡æ¢ç­–ç•¥ä¼šä½¿ç”¨æ—¶é—´å’Œæ—¥æœŸä»¥åŠä¸€ä¸ªintæ ‡å·ï¼Œå…¶ä¸­æ—¥æœŸpatternå¯ä»¥å‚è€ƒ<a href="http://download.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html">SimpleDateFormat</a>ï¼Œæ ‡å·ä½¿ç”¨<code>%i</code>åŒ¹é…ã€‚æ¨¡å¼åŒæ ·æ”¯æŒè·å–è¿è¡Œæ—¶çš„å€¼ï¼Œæ‰€ä»¥ä»»ä½•å®æ—¶å–å€¼çš„Lookupsï¼ˆæ¯”å¦‚<a href="https://logging.apache.org/log4j/2.x/manual/lookups.html#DateLookup">DateLookup</a>ï¼‰</li>
<li>filePermissionsï¼šstringï¼šæ–‡ä»¶æƒé™ï¼ŒPOSIXæ ¼å¼ï¼Œä¾‹å¦‚â€œrw-------â€</li>
<li>fileOwnerï¼šstringï¼šæ–‡ä»¶æ‰€æœ‰è€…</li>
<li>fileGroupï¼šstringï¼šæ–‡ä»¶æ‰€å±ç»„</li>
</ul>

          <h4 id="a55e6edc">Triggering Policies è§¦å‘ç­–ç•¥</h4>
          <h5 id="1c2fe44a">Composite Triggering Policy å¤åˆè§¦å‘ç­–ç•¥</h5><p>è¿™ç§è§¦å‘ç­–ç•¥è¿æ¥äº†å¤šä¸ªè§¦å‘ç­–ç•¥ï¼Œå¦‚æœå…¶ä¸­ä¸€é¡¹ç­–ç•¥è¿”å›trueï¼Œåˆ™æ•´ä¸ªå¤åˆè§¦å‘ç­–ç•¥è¿”å›trueï¼ŒCompositeTriggeringPolicyå¯ä»¥ä½¿ç”¨ä¸€ä¸ª<code>Policies</code>å…ƒç´ æ¥ç®€å•é…ç½®ã€‚</p>
<pre><code class="language-xml">&lt;Policies&gt;
  &lt;OnStartupTriggeringPolicy /&gt;
  &lt;SizeBasedTriggeringPolicy size=&quot;20 MB&quot; /&gt;
  &lt;TimeBasedTriggeringPolicy /&gt;
&lt;/Policies&gt;</code></pre>

          <h5 id="e7910d48">Cron Triggering Policies Cronè§¦å‘ç­–ç•¥</h5><p>ä½¿ç”¨cronè¡¨è¾¾å¼æ¥è¿›è¡Œåˆ‡æ¢è§¦å‘</p>
<p>å±æ€§ï¼š</p>
<ul>
<li>scheduleï¼šstringï¼šcronè¡¨è¾¾å¼</li>
<li>evaluateOnStartupï¼šbooleanï¼šåœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™ï¼Œcronè¡¨è¾¾å¼ä¼šå¯¹æ—¥å¿—æ–‡ä»¶æœ€åçš„ä¿®æ”¹æ—¶é—´æˆ³è¿›è¡Œè¯„ä¼°ï¼Œçœ‹æ˜¯å¦ç«‹å³åˆ‡æ¢æ—¥å¿—æ–‡ä»¶ã€‚</li>
</ul>

          <h5 id="67a26c92">On Startup Triggering Policy å¯åŠ¨è§¦å‘ç­–ç•¥</h5><p>é¡¹ç›®JVMå¯åŠ¨çš„æ—¶å€™å³è§¦å‘ç­–ç•¥</p>
<p>å±æ€§ï¼š</p>
<ul>
<li>mixSizeï¼šintegerï¼šå¿…é¡»åˆ‡æ¢çš„æœ€å°æ–‡ä»¶sizeï¼Œå¦‚æœæ˜¯0ï¼Œåˆ™ç«‹å³åˆ‡æ¢ï¼›é»˜è®¤çš„å€¼æ˜¯1ï¼Œé˜²æ­¢åœ¨å½“å‰æ—¥å¿—æ–‡ä»¶ä¸ºç©ºçš„æ—¶å€™åˆ‡æ¢ã€‚</li>
</ul>

          <h5 id="3f19c6c7">SizeBased Triggering Policy æ–‡ä»¶ä½“ç§¯è§¦å‘ç­–ç•¥</h5><p>æ ¹æ®æ–‡ä»¶å¤§å°åˆ‡æ¢</p>
<p>å±æ€§ï¼š</p>
<ul>
<li>sizeï¼šintegerï¼šåˆ°äº†æŸä¸ªsizeä¹‹åå³åˆ‡æ¢ï¼Œéœ€è¦ä½¿ç”¨KBã€MBã€GBç­‰åç¼€æè¿°ï¼Œå¦‚<code>20MB</code></li>
</ul>

          <h5 id="dcae63a6">TimeBased Triggering Policy æ—¶é—´è§¦å‘ç­–ç•¥</h5><p>æ ¹æ®æ—¶é—´åˆ‡æ¢ï¼Œè¿™ç§åˆ‡æ¢ä¼šåœ¨ date/time æ¨¡å¼æ— æ³•è¿ç”¨åœ¨å½“å‰æ¿€æ´»çš„æ–‡ä»¶çš„æ—¶å€™ç”Ÿæ•ˆã€‚è¿™ä¸ªç­–ç•¥æ¥å—ä¸€ä¸ª<code>interval</code>å±æ€§ï¼Œè¿™ä¸ªå±æ€§å›æ ¹æ®å½“å‰çš„time patternä»¥åŠ<code>modulate</code>è¿™ä¸ªå¸ƒå°”å±æ€§æ¥å†³å®šåˆ‡æ¢æ–‡ä»¶çš„é¢‘ç¹ç¨‹åº¦ã€‚</p>
<p>å±æ€§ï¼š</p>
<ul>
<li>intervalï¼šintegerï¼šæ ¹æ®date patterné‡Œç‰¹å®šçš„æ—¶é—´å•ä½å†³å®šå¤šä¹…åˆ‡æ¢ä¸€æ¬¡æ—¥å¿—æ–‡ä»¶ã€‚æ¯”å¦‚date pattrené‡Œæœ€ç²¾ç¡®çš„å•ä½æ˜¯hourï¼Œç„¶åå¢é‡æ˜¯4ï¼Œé‚£ä¹ˆä¼šæ¯4å°æ—¶åˆ‡æ¢ä¸€æ¬¡ï¼Œé»˜è®¤çš„å€¼æ˜¯1ã€‚</li>
<li>modulateï¼šbooleanï¼šå†³å®šå½“ä¸‹ä¸€æ¬¡åˆ‡æ¢æ—¶é—´å‡ºç°åœ¨æ—¶é—´é—´éš”çš„è¾¹ç¼˜çš„æ—¶å€™ï¼Œæ˜¯å¦æ ¡æ­£æ—¶é—´é—´éš”ã€‚æ¯”å¦‚ï¼Œå¦‚æœæ˜¯hourï¼Œå½“å‰æ—¶é—´æ˜¯3amï¼Œç„¶åintervalæ˜¯4ï¼Œé‚£ä¹ˆä¸‹ä¸€æ¬¡åˆ‡æ¢æ—¶é—´æ˜¯4amï¼Œå†ä¸‹ä¸€æ¬¡å°±æ˜¯8amï¼Œå†å°±æ˜¯åˆæ—¶ç­‰ç­‰ã€‚</li>
<li>maxRandomDelayï¼šintegerï¼šå†³å®šå»¶è¿Ÿåˆ‡æ¢çš„æœ€å¤§å»¶è¿Ÿç§’æ•°ã€‚é»˜è®¤æ˜¯0ï¼Œæ²¡æœ‰å»¶è¿Ÿã€‚å½“æœåŠ¡å™¨ä¸­æœ‰å¤šä¸ªé¡¹ç›®é…ç½®äº†åŒä¸€æ—¶é—´è¾“å‡ºæ—¥å¿—çš„æ—¶å€™ä¼šéå¸¸æœ‰ç”¨ï¼Œè¿™ä¼šå‡ç¼“ioå‹åŠ›ï¼ŒåŠ å¿«ioé€Ÿåº¦ã€‚</li>
</ul>

          <h4 id="45d5471c">Rollover Strategies åˆ‡æ¢ç­–ç•¥</h4>
          <h5 id="f06a80cd">Default Rollover Strategy é»˜è®¤çš„åˆ‡æ¢ç­–ç•¥</h5><p>é»˜è®¤çš„åˆ‡æ¢ç­–ç•¥å¯ä»¥åŒæ—¶æ¥æ”¶date/time patternä»¥åŠä¸€ä¸ªä»filePatternå±æ€§ä¸­æŒ‡å®šçš„integerå‚æ•°ã€‚å¦‚æœæä¾›äº†date/time patternï¼Œåˆ™ä¼šè¢«æ›¿æ¢ä¸ºæ—¥æœŸå’Œæ—¶é—´å€¼ã€‚å¦‚æœpatterné‡Œæœ‰integerå€¼ï¼Œé‚£ä¹ˆæ¯æ¬¡åˆ‡æ¢å°±ä¼šå¢åŠ 1ã€‚patterné‡Œè¿˜å¯ä»¥å†™gzã€zipã€bz2ç­‰åç¼€ã€‚</p>
<p>å±æ€§ï¼š</p>
<ul>
<li>fileIndexï¼šstringï¼šå¦‚æœè®¾ç½®äº†maxå±æ€§ï¼Œå¤§çš„indexå€¼çš„æ–‡ä»¶ä¼šæ¯”å°indexå€¼çš„æ–‡ä»¶æ–°ã€‚å¦‚æœè®¾ç½®äº†minï¼Œæ–‡ä»¶é‡å‘½åä»¥åŠindexè®¡æ•°å™¨ä¼šè·Ÿéš&quot;<a href="https://logging.apache.org/log4j/2.x/manual/appenders.html#RolloverStrategies">fixed window</a>&quot;ç­–ç•¥ã€‚</li>
<li>minï¼šintegerï¼šè®¡æ•°å™¨çš„æœ€å°å€¼ï¼Œé»˜è®¤å€¼æ˜¯1</li>
<li>maxï¼šintegerï¼šè®¡æ•°å™¨çš„æœ€å¤§å€¼ï¼Œå¦‚æœè¾¾åˆ°äº†è¿™ä¸ªå€¼ï¼Œé‚£ä¹ˆä¼šåˆ é™¤æ‰æœ€æ—©åˆ›å»ºçš„é‚£ä¸€ä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œé»˜è®¤å€¼æ˜¯7</li>
<li>compressionLevelï¼šintegerï¼šå‹ç¼©ç­‰çº§ï¼Œé’ˆå¯¹å‹ç¼©æ–‡ä»¶è€Œè¨€ï¼Œå–å€¼0-9ï¼Œ0åˆ™æ— å‹ç¼©ï¼Œ1æ˜¯æœ€å¿«çš„é€Ÿåº¦ç”Ÿæˆå‹ç¼©æ–‡ä»¶ï¼Œ9æ˜¯æœ€å¥½çš„å‹ç¼©ç‡</li>
<li>tempCompressedFilePatternï¼šstringï¼šåœ¨å‹ç¼©æœŸé—´ç”Ÿæˆçš„logæ–‡ä»¶åpattern</li>
</ul>
<p><em>åé¢è¿˜æœ‰æ›´å¤šçš„è‡ªå®šä¹‰ç­–ç•¥ç»†èŠ‚ï¼Œæˆ‘å°±ä¸ä¸€ä¸€è¯´äº†ï¼Œæˆ‘æ„Ÿè§‰æ›´è¯¦ç»†çš„æ—¥å¿—å®šåˆ¶æ–¹æ¡ˆæ¯”å¦‚å®šæ—¶åˆ é™¤å’Œæ‰§è¡Œscriptç­‰ï¼Œæ²¡æœ‰ä»€ä¹ˆå¿…è¦ï¼Œå¯èƒ½æ˜¯æˆ‘å½“å‰èƒ½æ¥è§¦åˆ°çš„åœºæ™¯è§„æ¨¡æœ‰é™ã€‚</em></p>
<p>å’ŒFileAppenderä¸€æ ·ï¼ŒRollingFileAppenderä¹Ÿæœ‰å¯¹åº”çš„ç¼“å†²æµç‰ˆæœ¬ã€‚</p>
<hr>

          <h3 id="4ec4a1f7">RollingRandomAccessFileAppenderï¼ˆæœ€å¸¸ç”¨ï¼‰</h3><p>è¿™ä¸ªå°±æ˜¯RollingFileAppenderçš„å‡çº§ç‰ˆï¼Œä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„ç‰ˆæœ¬ï¼Œå®ƒçš„å±æ€§ã€ç­–ç•¥å’Œå‰é¢çš„RollingFileAppenderä»¥åŠRandomAccessFileAppenderä¸€è‡´ï¼Œå‚è€ƒå‰é¢çš„å°±å¥½äº†ã€‚</p>

          <h4 id="ec81af6a">ä¾‹å­</h4>
          <h5 id="d137d16e">1</h5><pre><code class="language-xml">&lt;RollingRandomAccessFile name=&quot;RollingFile&quot; fileName=&quot;logs/a.log&quot;
             filePattern=&quot;logs/$${date:yyyy-MM}/a-%d{yyyy-MM-dd-HH-mm}-%i.log&quot;&gt;
    &lt;PatternLayout&gt;
        &lt;Pattern&gt;%d %p %c{1.} [%t] %m%n&lt;/Pattern&gt;
    &lt;/PatternLayout&gt;
    &lt;Policies&gt;
        &lt;TimeBasedTriggeringPolicy /&gt;
        &lt;SizeBasedTriggeringPolicy size=&quot;250 MB&quot;/&gt;
    &lt;/Policies&gt;
&lt;/RollingRandomAccessFile&gt;</code></pre>
<p>è§¦å‘ç­–ç•¥ï¼š</p>
<p>1ã€æŒ‰ç…§æ—¶é—´åˆ‡æ¢ï¼šç”±äº<code>filePattern</code>å±æ€§ä¸­é…ç½®çš„æœ€ç²¾ç¡®çš„time patternæ˜¯<code>mm</code>å³Minute in hourï¼Œä¸”è¿™æ¡è§¦å‘ç­–ç•¥æ²¡æœ‰æŒ‡å®šintervalï¼Œé‚£ä¹ˆé»˜è®¤æ˜¯1åˆ†é’Ÿåˆ‡æ¢ä¸€æ¬¡ã€‚</p>
<p>2ã€æ ¹æ®sizeåˆ‡æ¢ï¼Œå¦‚æœæŒ‰ç…§ä¸Šä¸€æ¡çš„ç­–ç•¥ï¼Œåœ¨1åˆ†é’Ÿå†…äº§ç”Ÿè¶…è¿‡250MBçš„æ—¥å¿—ï¼Œåˆ™åˆ‡æ¢ï¼Œä¸”<code>%i</code>åŠ ä¸€ã€‚</p>
<p>åˆ‡æ¢ç­–ç•¥ï¼š</p>
<pre><code class="language-js">filePattern=&quot;logs/%d{yyyy-MM}/a-%d{yyyy-MM-dd-HH-mm}-%i.log&quot;</code></pre>
<p>åœ¨logsæ–‡ä»¶å¤¹ä¸‹ï¼Œ<code>%d{yyyy-MM}</code>æŒ‰ç…§æœˆä»½å»ºç«‹ä¸€çº§æ–‡ä»¶å¤¹ï¼Œä¸€æœˆä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œç„¶åæœˆä»½é‡ŒæŒ‰ç…§è§¦å‘ç­–ç•¥çš„çº¦æŸå»æ‰§è¡Œåˆ‡æ¢ç­–ç•¥è¿›è¡Œæ—¥å¿—æ–‡ä»¶çš„åˆ‡æ¢ã€‚</p>

          <h5 id="fa1a82ad">2</h5><pre><code class="language-xml">&lt;RollingRandomAccessFile name=&quot;RollingFile&quot; fileName=&quot;logs/a.log&quot;
             filePattern=&quot;logs/$${date:yyyy-MM}/a-%d{yyyy-MM-dd-HH-mm}-%i.log&quot;&gt;
    &lt;PatternLayout&gt;
        &lt;Pattern&gt;%d %p %c{1.} [%t] %m%n&lt;/Pattern&gt;
    &lt;/PatternLayout&gt;
    &lt;Policies&gt;
        &lt;TimeBasedTriggeringPolicy /&gt;
        &lt;SizeBasedTriggeringPolicy size=&quot;250 MB&quot;/&gt;
    &lt;/Policies&gt;
    &lt;DefaultRolloverStrategy max=&quot;20&quot;/&gt;
&lt;/RollingRandomAccessFile&gt;</code></pre>
<p>æ¯”1å¤šæŒ‡å®šäº†ä¸€ä¸ªé»˜è®¤åˆ‡æ¢ç­–ç•¥å±æ€§<code>max</code>ï¼šæœ€å¤§ä¿ç•™20ä¸ªlogæ–‡ä»¶</p>
<hr>

          <h3 id="cbe0910a">SMTPAppender</h3><p>èƒ½ç»™ä½ å‘é‚®ä»¶çš„Appenderï¼Œè¿™ä¸ªä¹ŸæŒºæœ‰æ„æ€çš„ï¼Œ<a href="https://logging.apache.org/log4j/2.x/manual/appenders.html#SMTPAppender">å‚è€ƒ</a>ã€‚</p>
<hr>
<p>å¸¸ç”¨çš„Appenderå°±ä»‹ç»è¿™ä¹ˆå¤šï¼Œä¸‹ä¸€èŠ‚ä»‹ç»Layout patternã€‚</p>

    </div>
    <div id="scriptsearcher" class="myhide input-group new_font">
        <input id="searchtext" type="text" class="form-control" placeholder="keywords" autocomplete="off">
        <div class="input-group-append">
            <button id="searchbut" class="btn btn-dark" type="button">Search</button>
        </div>
    </div>

    <div id="bbt" class="myhide new_font">
        <a id="toc" style="display: none;" class="myhide" href="javascript:void(0);" data-toggle="tooltip" data-placement="left" title="show/hide Toc">Toc</a>
        <a id="gohub" href="#" target="_blank" data-toggle="tooltip" data-placement="bottom" title="view this at github">unuse</a>
    </div>

    <div id="share_png_panel" class="myhide">
        <div id="share_curtain"></div>
        <div id="png_box"></div>
        <button id="share_png_paned_close" class="btn btn-dark">Close</button>
    </div>

</body>

</html>