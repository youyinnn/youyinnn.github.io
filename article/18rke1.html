<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="baidu-site-verification" content="l09YSIpJQW" />
    <meta name="referrer" content="origin">
    <title>blog | youyinnn</title>
    <script src="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@master/myjs/loadscripts.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@master/myjs/jump-1.2.js"></script>
    <link rel="bookmark" href="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@master/img/favicon.ico" />
    <link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/youyinnn/youyinnn.github.io@master/img/favicon.ico" />
    <link rel="stylesheet" href="/mycss/style.css">

    <script src="/resources/resources.js"></script>
    <script src="/myjs/scriptlist.js"></script>
</head>

<body>

    <ol id="topbar" class="breadcrumb unselectable new_font">
        <p style="color:rgb(214, 214, 214); padding-right: 1rem;">
            <button id="egg" class="egg">ğŸš€</button>&nbsp;&nbsp;&nbsp;&nbsp;&gt;</p>
        <li class="breadcrumb-item">
            <spen id="homebut" href="javaScript:void(0)" class="ah">-home</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="articlesbut" href="javaScript:void(0)" class="ah">-articles</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="scriptbut" href="javaScript:void(0)" class="ah">-scripts</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="todobut" href="javaScript:void(0)" class="ah">-todos</spen>
        </li>
        <li class="breadcrumb-item">
            <spen id="resumebut" href="javaScript:void(0)" class="ah">-resume</spen>
        </li>
        <li class="breadcrumb-item dropdown">
            <spen href="javaScript:void(0)" class="ah" role="button" id="friendlinkedbut" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">-friends</spen>
            <div id="fldd" class="dropdown-menu" aria-labelledby="friendlinkedbut" style="border-radius: initial;"></div>
        </li>

        <div id="hb" data-toggle="tooltip" data-placement="bottom" title="show/hide TopBar">

        </div>
    </ol>

    <div id="homepage" class="unselectable new_font myhide">
        <div id="homepage-center">
            <div id="slogan">
                <i id="wolf-logo" style="font-style: normal;" class="mr-4">ğŸŒ‘</i><span id="slogan-text"></span>
            </div>
            <div id="homepage-btn">
                <div id="showmore"> &nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp; About Me & This Blog</div>
                <div id="showhacknical"> &nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp; My Github Analysis</div>
                <div id="toarticles"> &nbsp;&nbsp;&nbsp;&nbsp;&gt;&nbsp;&nbsp;&nbsp;&nbsp; My Tech Articles</div>
            </div>
        </div>
        <div id="ifwrapper" class="hacknical_hide">
            <iframe id="hacknical_github_analysis" frameborder="0"></iframe>
        </div>
    </div>

    <div id="series" class="unselectable">
        <span>ç³»</span>
        <span>åˆ—</span>
        <span>æ–‡</span>
        <span>ç« </span>
    </div>
    <div id="seriesbox" class="unselectable">

    </div>

    <div id="articles_side_panel" class="unselectable myhide new_font">
        <div id="cates_tree_head">Article Categories</div>
        <div id="cates_tree_body"></div>
        <div id="blog_statistic_head">Blog Statistic</div>
        <table id="blog_statistic_body" class="myhide">
            <tbody>
                <tr>
                    <td style="text-align:right">Online:</td>
                    <td style="text-align:left" id="stat_running"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Article:</td>
                    <td style="text-align:left" id="stat_article_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Chars:</td>
                    <td style="text-align:left" id="stat_typein"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Categories:</td>
                    <td style="text-align:left" id="stat_cate_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Tags:</td>
                    <td style="text-align:left" id="stat_tag_count"></td>
                </tr>
                <tr>
                    <td style="text-align:right">Last update:</td>
                    <td style="text-align:left" id="stat_last_update"></td>
                </tr>
            </tbody>
        </table>
    </div>
    <div id="docpanel" class="myhide new_font">
        <div id="articlesearch" class="input-group">
            <input id="articlesearchtext" type="text" class="form-control" autocomplete="off" placeholder="search">
            <div class="input-group-append">
                <button id="cleanbut" class="btn btn-light" type="button" title="clear search">cls</button>
                <button id="categories" class="btn btn-light" type="button">cates</button>
                <button id="tags" class="btn btn-light" type="button" title="all tags">tags</button>
                <button id="articlesearchbut" class="btn btn-light" type="button" title="search">sch</button>
            </div>
        </div>
        <div class="tgs myhide" id="all_cates">
            <span style="font-size: 1rem; font-weight: bold ; padding: 6px;">All categories:</span>
            <br>
        </div>
        <div class="tgs myhide" id="all_tags">
            <span style="font-size: 1rem; font-weight: bold ; padding: 6px;">All tags:</span>
            <br>
        </div>
    </div>

    <div id="sidetoccontainer" class="tochide unselectable new_font">
        <div id="block">
            <div id="percent" data-toggle="tooltip" data-placement="bottom" title="return to the top">0%</div>
        </div>
        <div id="sidetoc" class="unselectable markdown-body editormd-preview-container markdown-toc"></div>
    </div>
    <div id="md" class="myhide markdown-body editormd-html-preview">
        <p><span id="top"></span></p>

          <h3>
            <a name="_root-â…£. Jettyå¼€å‘æŒ‡å—-21.åµŒå…¥å¼å¼€å‘" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            â…£. Jettyå¼€å‘æŒ‡å—-21.åµŒå…¥å¼å¼€å‘
          </h3><ul>
<li><ol start="21">
<li><a href="#21%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91">åµŒå…¥å¼å¼€å‘</a></li>
</ol>
<ul>
<li><a href="#211jetty%E7%9A%84%E5%B5%8C%E5%85%A5%E5%BC%8Fhello-world">Jettyçš„åµŒå…¥å¼Hello World</a><ul>
<li><a href="#2111%E4%B8%8B%E8%BD%BDjar%E5%8C%85">ä¸‹è½½JaråŒ…</a></li>
<li><a href="#2112hello-world%E6%A0%97%E5%AD%90">Hello Worldæ —å­</a></li>
<li><a href="#2113%E7%BC%96%E8%AF%91hello-world%E6%A0%97%E5%AD%90">ç¼–è¯‘Hello Worldæ —å­</a></li>
<li><a href="#2114%E8%BF%90%E8%A1%8Chandler%E5%92%8Cserver">è¿è¡ŒHandlerå’ŒServer</a></li>
<li><a href="#2115%E4%B8%8B%E4%B8%80%E6%AD%A5">ä¸‹ä¸€æ­¥</a></li>
</ul>
</li>
<li><a href="#212jetty%E7%9A%84%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91">Jettyçš„åµŒå…¥å¼å¼€å‘</a><ul>
<li><a href="#2121%E6%A6%82%E8%BF%B0">æ¦‚è¿°</a></li>
<li><a href="#2122%E5%88%9B%E5%BB%BAserver">åˆ›å»ºServer</a></li>
<li><a href="#2123%E4%BD%BF%E7%94%A8handler">ä½¿ç”¨Handler</a><ul>
<li><a href="#21231%E4%B8%80%E4%B8%AAhandler%E7%9A%84hello-world">ä¸€ä¸ªHandlerçš„Hello World</a></li>
<li><a href="#21232%E8%BF%90%E8%A1%8Chelloworldhandler">è¿è¡ŒHelloWorldHandler</a></li>
<li><a href="#21233handler-collections%E5%92%8Cwrappers">Handler Collectionså’ŒWrappers</a></li>
<li><a href="#21234scoped-handlers">Scoped Handlers</a></li>
<li><a href="#21235resource-handler">Resource Handler</a></li>
</ul>
</li>
<li><a href="#2124%E5%B5%8C%E5%85%A5connectors">åµŒå…¥Connectors</a><ul>
<li><a href="#21241%E4%B8%80%E4%B8%AAconnectors">ä¸€ä¸ªConnectors</a></li>
<li><a href="#21242%E5%A4%9A%E4%B8%AAconnectors">å¤šä¸ªConnectors</a></li>
</ul>
</li>
<li><a href="#2125%E5%B5%8C%E5%85%A5servlets">åµŒå…¥Servlets</a></li>
<li><a href="#2126%E5%B5%8C%E5%85%A5contexts">åµŒå…¥Contexts</a></li>
<li><a href="#2127%E5%B5%8C%E5%85%A5servletcontexts">åµŒå…¥ServletContexts</a></li>
<li><a href="#2128%E5%B5%8C%E5%85%A5web%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F">åµŒå…¥Webåº”ç”¨ç¨‹åº</a></li>
<li><a href="#2129%E5%83%8Fjettyxml%E4%B8%80%E6%A0%B7%E8%BF%9B%E8%A1%8C%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91">åƒJettyXMLä¸€æ ·è¿›è¡ŒåµŒå…¥å¼å¼€å‘</a></li>
</ul>
</li>
<li><a href="#213%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91%E7%9A%84%E6%A0%97%E5%AD%90">åµŒå…¥å¼å¼€å‘çš„æ —å­</a><ul>
<li><a href="#2131%E7%AE%80%E5%8D%95%E7%9A%84%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8">ç®€å•çš„æ–‡ä»¶æœåŠ¡å™¨</a></li>
<li><a href="#2132%E5%8F%AF%E5%88%86%E5%B8%83%E7%9A%84%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8">å¯åˆ†å¸ƒçš„æ–‡ä»¶æœåŠ¡å™¨</a></li>
<li><a href="#2133%E5%A4%9Aconnectors">å¤šConnectors</a></li>
<li><a href="#2134%E5%AE%89%E5%85%A8%E6%96%B9%E9%9D%A2handler%E7%9A%84hello-world">å®‰å…¨æ–¹é¢Handlerçš„Hello World</a></li>
<li><a href="#2135%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84servlet">æœ€ç®€å•çš„Servlet</a></li>
<li><a href="#2136web-application">Web Application</a></li>
<li><a href="#2137web-application%E4%BB%A5%E5%8F%8Ajsp">Web Applicationä»¥åŠJSP</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<p><span id="21åµŒå…¥å¼å¼€å‘"></span></p>

          <h3>
            <a name="_root-21ã€åµŒå…¥å¼å¼€å‘" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21ã€åµŒå…¥å¼å¼€å‘
          </h3><ul>
<li>21.1ã€<a href="#211jetty%E7%9A%84%E5%B5%8C%E5%85%A5%E5%BC%8Fhello-world">Jettyçš„åµŒå…¥å¼Hello World</a></li>
<li>21.2ã€<a href="#212jetty%E7%9A%84%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91">Jettyçš„åµŒå…¥å¼å¼€å‘</a></li>
<li>21.3ã€<a href="#213%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91%E7%9A%84%E6%A0%97%E5%AD%90">åµŒå…¥å¼å¼€å‘çš„æ —å­</a></li>
</ul>
<p><span id="211jettyçš„åµŒå…¥å¼hello-world"></span></p>

          <h4>
            <a name="_root-21.1ã€Jettyçš„åµŒå…¥å¼HelloWorld" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.1ã€Jettyçš„åµŒå…¥å¼HelloWorld
          </h4><ul>
<li>21.1.1ã€<a href="#2111%E4%B8%8B%E8%BD%BDjar%E5%8C%85">ä¸‹è½½JaråŒ…</a></li>
<li>21.1.2ã€<a href="#2112hello-world%E6%A0%97%E5%AD%90">Hello Worldæ —å­</a></li>
<li>21.1.3ã€<a href="#2113%E7%BC%96%E8%AF%91hello-world%E6%A0%97%E5%AD%90">ç¼–è¯‘Hello Worldæ —å­</a></li>
<li>21.1.4ã€<a href="#2114%E8%BF%90%E8%A1%8Chandler%E5%92%8Cserver">è¿è¡ŒHandlerå’ŒServer</a></li>
<li>21.1.5ã€<a href="#2115%E4%B8%8B%E4%B8%80%E6%AD%A5">ä¸‹ä¸€æ­¥</a></li>
</ul>
<p><span id="2111ä¸‹è½½jaråŒ…"></span></p>

          <h5>
            <a name="_root-21.1.1ã€ä¸‹è½½JaråŒ…" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.1.1ã€ä¸‹è½½JaråŒ…
          </h5><p>JettyæŠŠæ•´ä½“åˆ†è§£ä¸ºè®¸å¤šçš„jaråŒ…ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰éœ€å¯¼å…¥ä¾èµ–ã€‚å…¸å‹çš„åšæ³•æ˜¯ä½¿ç”¨Mavenå»ç®¡ç†jaråŒ…ï¼Œç„¶è€Œæœ¬èŠ‚æ•™ç¨‹æ˜¯ä½¿ç”¨çš„æ•´ä½“jaråŒ…ï¼Œå®ƒåŒ…å«äº†æ‰€æœ‰çš„JettyæœåŠ¡ã€‚ä½ å¯ä»¥é€šè¿‡curlæˆ–è€…æµè§ˆå™¨å»æ‰‹åŠ¨ä¸‹è½½è¿™ä¸ªå®Œæ•´çš„jaråŒ…<code>jetty-all.jar</code>ï¼š<a href="http://central.maven.org/maven2/org/eclipse/jetty/aggregate/jetty-all/9.4.6.v20170531/jetty-all-9.4.6.v20170531-uber.jar%E3%80%82">http://central.maven.org/maven2/org/eclipse/jetty/aggregate/jetty-all/9.4.6.v20170531/jetty-all-9.4.6.v20170531-uber.jarã€‚</a></p>
<blockquote>
<p><strong>NOTEï¼š</strong></p>
<p>è¿™ä¸ªåœ°å€æ‹’ç»ä½¿ç”¨wgetå»ä¸‹è½½ï¼Œä½ å¯ä»¥ä½¿ç”¨curlçš„æ–¹å¼ä¸‹è½½ã€‚</p>
</blockquote>
<blockquote>
<p><strong>æ³¨æ„ï¼š</strong></p>
<p>jetty-all.jaråŒ…åªæ˜¯åœ¨æœ¬èŠ‚ä½œä¸¾ä¾‹å‡è®¾çš„å¼•ç”¨ï¼Œåƒä¸‡ä¸è¦åœ¨æ•™ç¨‹ä»¥å¤–çš„åœ°æ–¹ä½¿ç”¨ã€‚ä½ å¯ä»¥åœ¨åé¢çš„Mavenç« èŠ‚äº†è§£åˆ°å¦‚ä½•ä½¿ç”¨Mavenå»ç®¡ç†ä½ çš„é¡¹ç›®ä¾èµ–ã€‚</p>
</blockquote>
<p>æŒ‰ç…§ä»¥ä¸‹çš„æ–¹å¼ä½¿ç”¨curlä¸‹è½½ï¼š</p>
<pre><code>&gt; mkdir Demo
&gt; cd Demo
&gt; curl -o jetty-all-uber.jar http://central.maven.org/maven2/org/eclipse/jetty/aggregate/jetty-all/9.4.6.v20170531/jetty-all-9.4.6.v20170531-uber.jar</code></pre><p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="2112hello-worldæ —å­"></span></p>

          <h5>
            <a name="_root-21.1.2ã€Hello Worldæ —å­" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.1.2ã€Hello Worldæ —å­
          </h5><p>è¿™ä¸ªæ —å­ä¸­åŒ…å«äº†è®¸å¤šå…³äºJettyAPIçš„ç”¨ä¾‹ï¼Œè¿™ä¸ªæ•™ç¨‹ä¼šåœ¨ä¸»å‡½æ•°é‡Œé¢ç”¨åˆ°ä¸€ä¸ªç®€å•çš„Handlerçš„Hello Worldæ¥è¿è¡ŒæœåŠ¡å™¨ï¼š</p>
<pre><code>package org.eclipse.jetty.embedded;

import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.eclipse.jetty.server.Request;
import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.server.handler.AbstractHandler;

public class HelloWorld extends AbstractHandler
{
    @Override
    public void handle( String target,
                        Request baseRequest,
                        HttpServletRequest request,
                        HttpServletResponse response ) throws IOException,
                                                      ServletException
    {
        // Declare response encoding and types
        response.setContentType(&quot;text/html; charset=utf-8&quot;);

        // Declare response status code
        response.setStatus(HttpServletResponse.SC_OK);

        // Write back response
        response.getWriter().println(&quot;&lt;h1&gt;Hello World&lt;/h1&gt;&quot;);

        // Inform jetty that this request has now been handled
        baseRequest.setHandled(true);
    }

    public static void main( String[] args ) throws Exception
    {
        Server server = new Server(8080);
        server.setHandler(new HelloWorld());

        server.start();
        server.join();
    }
}</code></pre><p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="2113ç¼–è¯‘hello-worldæ —å­"></span></p>

          <h5>
            <a name="_root-21.1.3ã€ç¼–è¯‘Hello Worldæ —å­" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.1.3ã€ç¼–è¯‘Hello Worldæ —å­
          </h5><pre><code>&gt; mkdir classes
&gt; javac -d classes -cp jetty-all-uber.jar HelloWorld.java</code></pre><br>

<p><span id="2114è¿è¡Œhandlerå’Œserver"></span></p>

          <h5>
            <a name="_root-21.1.4ã€è¿è¡ŒHandlerå’ŒServer" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.1.4ã€è¿è¡ŒHandlerå’ŒServer
          </h5><pre><code>&gt; java -cp classes:jetty-all-uber.jar org.eclipse.jetty.embedded.HelloWorld</code></pre><br>

<p><span id="2115ä¸‹ä¸€æ­¥"></span></p>

          <h5>
            <a name="_root-21.1.5ã€ä¸‹ä¸€æ­¥" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.1.5ã€ä¸‹ä¸€æ­¥
          </h5><p>å¦‚æœä½ æƒ³äº†è§£æ›´å¤šçš„å†…å®¹ï¼Œè¯·æŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤æ¥ï¼š</p>
<ul>
<li>è·Ÿç€<a href="#212jetty%E7%9A%84%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91">21.2ã€Jettyçš„åµŒå…¥å¼å¼€å‘</a>ç»§ç»­å­¦ä¹ ã€‚</li>
<li>æ¢ç´¢æ•´ä¸ª<a href="#http://www.eclipse.org/jetty/javadoc/9.4.6.v20170531/">Jetty javadoc</a>ã€‚</li>
<li>è€ƒè™‘ä½¿ç”¨<a href="#">Jettyå’ŒMaven</a>å»ç®¡ç†ä½ çš„é¡¹ç›®ä¾èµ–ã€‚</li>
</ul>
<p><a href="#top">å›åˆ°é¡¶éƒ¨</a></p>
<hr>
<p><span id="212jettyçš„åµŒå…¥å¼å¼€å‘"></span></p>

          <h4>
            <a name="_root-21.2ã€Jettyçš„åµŒå…¥å¼å¼€å‘" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.2ã€Jettyçš„åµŒå…¥å¼å¼€å‘
          </h4><ul>
<li>21.2.1ã€<a href="#2121%E6%A6%82%E8%BF%B0">æ¦‚è¿°</a></li>
<li>21.2.2ã€<a href="#2122%E5%88%9B%E5%BB%BAserver">åˆ›å»ºServer</a></li>
<li>21.2.3ã€<a href="#2123%E4%BD%BF%E7%94%A8handler">ä½¿ç”¨Handler</a></li>
<li>21.2.4ã€<a href="#2124%E5%B5%8C%E5%85%A5connectors">åµŒå…¥Connectors</a></li>
<li>21.2.5ã€<a href="#2125%E5%B5%8C%E5%85%A5servlets">åµŒå…¥Servlets</a></li>
<li>21.2.6ã€<a href="#2126%E5%B5%8C%E5%85%A5contexts">åµŒå…¥Contexts</a></li>
<li>21.2.7ã€<a href="#2127%E5%B5%8C%E5%85%A5servletcontexts">åµŒå…¥ServletContexts</a></li>
<li>21.2.8ã€<a href="#2128%E5%B5%8C%E5%85%A5web%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F">åµŒå…¥Webåº”ç”¨ç¨‹åº</a></li>
<li>21.2.9ã€<a href="#2129%E5%83%8Fjettyxml%E4%B8%80%E6%A0%B7%E8%BF%9B%E8%A1%8C%E5%B5%8C%E5%85%A5%E5%BC%8F%E5%BC%80%E5%8F%91">åƒJettyXMLä¸€æ ·è¿›è¡ŒåµŒå…¥å¼å¼€å‘</a></li>
</ul>
<p>Jettyæœ‰ä¸€å¥å£å·â€œä¸è¦æŠŠä½ çš„åº”ç”¨éƒ¨ç½²åˆ°Jettyï¼Œè¦æŠŠJettyéƒ¨ç½²åˆ°ä½ çš„åº”ç”¨ä¸­ï¼â€ï¼ŒJettyè¢«è®¾è®¡æˆæ˜¯å¯ä»¥è¢«å®ä¾‹åŒ–å¹¶ä¸”æ‹¿æ¥ä½¿ç”¨çš„ä¸€ä¸ªç»„ä»¶ï¼Œå°±åƒä¸€ä¸ªJavaçš„POJOå¯¹è±¡ä¸€æ ·ã€‚æŠŠJettyæœåŠ¡åµŒå…¥åˆ°ä½ çš„åº”ç”¨ä¸­ï¼Œè¿™æ„å‘³ç€åµŒå…¥ä¸€ä¸ªHTTPæ¨¡å—è¿›ä½ çš„åº”ç”¨ä¸­å»ã€‚</p>
<p>è¿™ä¸ªæ•™ç¨‹ä¼šä¸€æ­¥æ­¥åœ°æ•™ä½ å¦‚ä½•ç”¨æœ€ç®€å•çš„æ–¹å¼ä½¿ç”¨JettyæœåŠ¡å™¨å»è¿è¡Œå¤šä¸ªWebåº”ç”¨ã€‚æ —å­ä¸­çš„è®¸å¤šä»£ç æ¥è‡ªäºJettyé¡¹ç›®çš„æºç ã€‚</p>
<p><span id="2121æ¦‚è¿°"></span></p>

          <h5>
            <a name="_root-21.2.1ã€æ¦‚è¿°" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.2.1ã€æ¦‚è¿°
          </h5><p>æƒ³è¦åµŒå…¥Jettyï¼Œä»¥ä¸‹æ˜¯æ ‡å‡†çš„æ­¥éª¤ï¼Œåœ¨æ —å­é‡Œé¢ä¼šæœ‰è¯¦ç»†çš„è¯´æ˜ï¼š</p>
<ol>
<li>åˆ›å»ºServerå®ä¾‹</li>
<li>æ·»åŠ /é…ç½®Connectors</li>
<li>æ·»åŠ /é…ç½®Handlersã€Contextsã€Servlets</li>
<li>å¼€å¯Server</li>
<li>æ³¡æ¯å’–å•¡</li>
</ol>
<br>

<p><span id="2122åˆ›å»ºserver"></span></p>

          <h5>
            <a name="_root-21.2.2ã€åˆ›å»ºServer" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.2.2ã€åˆ›å»ºServer
          </h5><p>ä¸‹é¢çš„ä»£ç ä¼šç®€å•çš„å‘ä½ ä»‹ç»ä¸€ä¸ªJettyServerï¼š</p>
<pre><code>package org.eclipse.jetty.embedded;

import org.eclipse.jetty.server.Server;

/**
 * The simplest possible Jetty server.
 */
public class SimplestServer
{
    public static void main( String[] args ) throws Exception
    {
        Server server = new Server(8080);
        server.start();
        server.dumpStdErr();
        server.join();
    }
}</code></pre><p>è¿™ä¼šåœ¨8080ç«¯å£è¿è¡Œä¸€ä¸ªHTTPæœåŠ¡å™¨ï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•æœåŠ¡ï¼Œä»»ä½•è¯·æ±‚éƒ½ä¼šæ˜¯404ã€‚<br><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="2123ä½¿ç”¨handler"></span></p>

          <h5>
            <a name="_root-21.2.3ã€ä½¿ç”¨Handler" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.2.3ã€ä½¿ç”¨Handler
          </h5><ul>
<li>21.2.3.1ã€<a href="#21231%E4%B8%80%E4%B8%AAhandler%E7%9A%84hello-world">ä¸€ä¸ªHandlerçš„Hello World</a></li>
<li>21.2.3.2ã€<a href="#21232%E8%BF%90%E8%A1%8Chelloworldhandler">è¿è¡ŒHelloWorldHandler</a></li>
<li>21.2.3.3ã€<a href="#21233handler-collections%E5%92%8Cwrappers">Handler Collectionså’ŒWrappers</a></li>
<li>21.2.3.4ã€<a href="#21234scoped-handlers">Scoped Handlers</a></li>
<li>21.2.3.5ã€<a href="#21235resource-handler">Resource Handler</a></li>
</ul>
<p>ä¸ºäº†å¯¹è¯·æ±‚åšå‡ºå“åº”ï¼ŒJettyè¦æ±‚ä½ åœ¨serveré‡Œé¢è®¾ç½®ä¸€ä¸ªHandlerï¼Œè¿™ä¸ªHandlerå¯ä»¥ï¼š</p>
<ul>
<li>æ£€æŸ¥/ä¿®æ”¹HTTPè¯·æ±‚</li>
<li>ç”Ÿæˆä¸€ä¸ªå®Œæ•´çš„HTTPå“åº”</li>
<li>è°ƒç”¨å¦å¤–ä¸€ä¸ªHandlerï¼ˆå‚è§APIï¼š<a href="http://www.eclipse.org/jetty/javadoc/9.4.6.v20170531/org/eclipse/jetty/server/handler/HandlerWrapper.html">HandlerWrapper</a>ï¼‰</li>
<li>é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªHandleræ¥è°ƒç”¨ï¼ˆå‚è§APIï¼š<a href="http://www.eclipse.org/jetty/javadoc/9.4.6.v20170531/org/eclipse/jetty/server/handler/HandlerCollection.html">HandlerCollection</a>ï¼‰</li>
</ul>
<p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="21231ä¸€ä¸ªhandlerçš„hello-world"></span></p>

          <h6>
            <a name="_root-21.2.3.1ã€ä¸€ä¸ªHandlerçš„Hello World" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.2.3.1ã€ä¸€ä¸ªHandlerçš„Hello World
          </h6><p>è¿™æ˜¯<code>HelloHandler.java</code>ä»£ç ï¼š</p>
<pre><code>package org.eclipse.jetty.embedded;

import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.eclipse.jetty.server.Request;
import org.eclipse.jetty.server.handler.AbstractHandler;

public class HelloHandler extends AbstractHandler
{
    final String greeting;
    final String body;

    public HelloHandler()
    {
        this(&quot;Hello World&quot;);
    }

    public HelloHandler( String greeting )
    {
        this(greeting, null);
    }

    public HelloHandler( String greeting, String body )
    {
        this.greeting = greeting;
        this.body = body;
    }

    public void handle( String target,
                        Request baseRequest,
                        HttpServletRequest request,
                        HttpServletResponse response ) throws IOException,
                                                      ServletException
    {
        response.setContentType(&quot;text/html; charset=utf-8&quot;);
        response.setStatus(HttpServletResponse.SC_OK);

        PrintWriter out = response.getWriter();

        out.println(&quot;&lt;h1&gt;&quot; + greeting + &quot;&lt;/h1&gt;&quot;);
        if (body != null)
        {
            out.println(body);
        }

        baseRequest.setHandled(true);
    }
}</code></pre><p>ä¼ åˆ°handleæ–¹æ³•çš„å‚æ•°æ˜¯ï¼š</p>
<ul>
<li>targetï¼šå‘èµ·è¯·æ±‚çš„ç›®æ ‡ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªURLæˆ–è€…å‘é€è€…çš„nameå€¼ã€‚</li>
<li>baseRequestï¼šJettyçš„å¯å˜è¯·æ±‚å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯æœªç»åŒ…è£…çš„ã€‚</li>
<li>requestï¼šä¸å¯å˜çš„è¯·æ±‚å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å¯èƒ½ç»è¿‡filteræˆ–è€…servletåŒ…è£…è¿‡ã€‚</li>
<li>responseï¼šå“åº”ï¼Œè¿™ä¸ªå¯¹è±¡å¯èƒ½ç»è¿‡filteræˆ–è€…servletåŒ…è£…è¿‡ã€‚</li>
</ul>
<p>handlerå¯ä»¥åœ¨å“åº”çš„bodyç”Ÿæˆä¹‹å‰è¿›è¡Œå“åº”çš„statusè®¾ç½®ã€content-typeè®¾ç½®ã€æŠŠè¯·æ±‚æ ‡è®°ä¸ºå·²å¤„ç†ã€‚</p>
<p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="21232è¿è¡Œhelloworldhandler"></span></p>

          <h6>
            <a name="_root-21.2.3.2ã€è¿è¡ŒHelloWorldHandler" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.2.3.2ã€è¿è¡ŒHelloWorldHandler
          </h6><p>ä¸ºäº†Handlerèƒ½å¤Ÿå¤„ç†HTTPè¯·æ±‚ï¼Œä½ å¿…é¡»æŠŠå®ƒæ·»åŠ åˆ°Serverå®ä¾‹ä¸­ï¼Œä¸‹é¢è¿™ä¸ª<code>OneHandler.java</code>ä»£ç å°±ä¼šå‘ä½ å±•ç¤ºJettyæœåŠ¡å™¨å¦‚ä½•æ‰èƒ½ä½¿ç”¨HelloWorldHandlerï¼š</p>
<pre><code>package org.eclipse.jetty.embedded;

import org.eclipse.jetty.server.HttpConnectionFactory;
import org.eclipse.jetty.server.Server;

public class OneHandler
{
    public static void main( String[] args ) throws Exception
    {
        Server server = new Server(8080);
        server.setHandler(new HelloHandler());

        server.start();
        server.join();
    }
}</code></pre><p>å½“æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªhandlerså¤„ç†æ‰€æœ‰çš„è¯·æ±‚çš„æ—¶å€™ï¼Œä¸€äº›hanldersä¼šé€‰æ‹©å…¶ä»–æŒ‡å®šçš„handlersï¼ˆæ¯”å¦‚ï¼Œä¸€ä¸ªContextHandlerCollectionä¼šæ ¹æ®context pathå»é€‰æ‹©ContextHandlerï¼‰ï¼›</p>
<p>å…¶ä»–handlersåˆ™ä½¿ç”¨ä¸šåŠ¡é€»è¾‘å»ç”Ÿæˆå¯¹åº”çš„å“åº”ï¼ˆæ¯”å¦‚è¯´ï¼ŒServletHandlerä¼ é€’è¯·æ±‚åˆ°ä¸€ä¸ªwebåº”ç”¨Servletï¼‰ï¼›</p>
<p>è¿˜æœ‰çš„å…¶ä»–handlersä¼šå¤„ç†ä¸€äº›ä¸šåŠ¡æ— å…³çš„è¯·æ±‚å“åº”ï¼ˆæ¯”å¦‚ï¼ŒRequestLogHandleræˆ–è€…æ˜¯StatisticsHandlerï¼‰ã€‚</p>
<p>åé¢çš„éƒ¨åˆ†ä¼šå‘Šè¯‰ä½ æ€ä¹ˆæ‰èƒ½æŠŠhandlersè¿æ¥èµ·æ¥ç»„æˆä¸€ä¸ªåˆ‡é¢ï¼Œä½ å¯ä»¥åœ¨Jettyçš„<code>org.eclipse.jetty.server.handler</code>ç±»ä¸­æ‰¾åˆ°æ›´å¤šçš„æœ‰ç”¨çš„handlerså®ä¾‹ã€‚</p>
<p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="21233handler-collectionså’Œwrappers"></span></p>

          <h6>
            <a name="_root-21.2.3.3ã€Handler Collectionså’ŒWrappers" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.2.3.3ã€Handler Collectionså’ŒWrappers
          </h6><p>ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚å¤„ç†æ˜¯ä»å¤šä¸ªHandlersä¸­å»ºç«‹çš„ï¼Œä½ å¯ç”¨ä»¥å¤šç§æ–¹å¼å°†å¤šä¸ªHandlerè¿æ¥èµ·æ¥ï¼ŒJettyæä¾›äº†å‡ ç§å®ç°äº†<code>HandlerContainer</code>çš„å®ä¾‹ï¼š</p>
<blockquote>
<p><em>è¯‘è€…æ–‡å¤–è¡¥å……ï¼šHandlerContaineræ˜¯Handlerçš„å®¹å™¨ï¼Œä½ å¯ä»¥æŠŠä¸€å¥—ä¸šåŠ¡çš„Handleræ”¾åœ¨ä¸€ä¸ªå®¹å™¨é‡Œé¢ï¼Œå†æŠŠè¿™ä¸ªå®¹å™¨æ·»åŠ åˆ°Serverä¸­ï¼ŒHandlerå®¹å™¨çš„æœ¬è´¨ä¹Ÿæ˜¯ä¸€ä¸ªHandlerã€‚</em></p>
</blockquote>
<ul>
<li><p>HandlerCollection<br>æŒæœ‰ä¸€ä¸ªå«æœ‰å…¶ä»–Handlerçš„collectionï¼Œå¤„ç†è¯·æ±‚çš„æ—¶å€™ä¼šè°ƒç”¨collectioné¡ºåºä¸­çš„æ¯ä¸€ä¸ªhandlerã€‚ä½ å¯ç”¨ä½¿ç”¨å®ƒæŠŠä¸€äº›ä½œç»Ÿè®¡ç”¨çš„handlerså’Œä¸€äº›ä½œæ—¥å¿—ç”¨çš„handlersç»ƒæˆä¸€ä¸²ï¼Œç»Ÿä¸€ç”Ÿæˆå“åº”ã€‚</p>
</li>
<li><p>HandlerList<br>æŒæœ‰ä¸€ä¸ªå«æœ‰å…¶ä»–Handlerçš„collectionï¼Œå’ŒHandlerCollectionä¸åŒçš„æ˜¯ï¼Œå¦‚æœæŸä¸ªhandlerè¿”å›å¼‚å¸¸æˆ–è€…å“åº”å·²ç»è¢«ç¡®è®¤æˆ–è€…<code>request.isHandled()</code>æ–¹æ³•è¿”å›trueçš„æ—¶å€™æ‰ä¼šåœæ­¢ã€‚ä½ å¯ç”¨ä½¿ç”¨è¿™ç§è¿æ¥æ–¹å¼å»è¿æ¥æŒ‰ç…§æ¡ä»¶å¤„ç†çš„handlerï¼Œæ¯”å¦‚åŒ¹é…ä¸åŒçš„è™šæ‹Ÿä¸»æœºã€‚</p>
</li>
</ul>
<blockquote>
<p><em>è¯‘è€…æ–‡å¤–è¡¥å……ï¼šå¼‚å¸¸å°±æ˜¯handlerå†…æŠ¥é”™ï¼›å“åº”è¢«ç¡®è®¤åº”è¯¥æ˜¯æ•´æ¡é“¾è·‘åˆ°åº•äº†ï¼›è€ŒisHandled()åˆ™æ˜¯æŸä¸ªåœ¨handleré‡Œé¢è°ƒç”¨<code>baseRequest.setHandled(true)</code>æ–¹æ³•ã€‚</em></p>
</blockquote>
<ul>
<li>HandlerWrapper<br>ä¸€ä¸ªHandlerçš„åŸºç±»ï¼Œä½ å¯ç”¨å®ƒæ¥æŠŠå¾ˆå¤šhandlerä»¥è‰¯å¥½çš„é“¾å¼å¤„ç†è¿åœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªAOPåˆ‡é¢ã€‚æ¯”å¦‚è¯´ä¸€ä¸ªæ ‡å‡†çš„Webç¨‹åºæ˜¯ç”±ä¸€ä¸ªcontext handlersã€ä¸€ä¸ªsession handlersã€ä¸€ä¸ªsecurity handlerså’Œä¸€ä¸ªservlet handlersç»„æˆã€‚</li>
</ul>
<blockquote>
<p><em>è¯‘è€…æ–‡å¤–è¡¥å……ï¼šåœ¨å…¶Javadocä¸­å®šä¹‰æ‰€æè¿°ï¼š<code>HandlerWrapper</code>è™½ç„¶æ‹¥æœ‰Handlerä¸€æ ·çš„è¡Œä¸ºï¼Œä½†æ˜¯å®ƒæ›´åŠ ä»£è¡¨ç€Handleræ–¹æ³•å’Œ<code>LifeCycle</code>æ¥å£ï¼Œå®ƒä¸åƒ<code>HandlerCollection</code>é‚£æ ·ä¸“æ³¨å®ç°ä¸ºä¸€ä¸ªHandlerå®¹å™¨ï¼Œè¿™ä¸ªåŸºç±»å¸¸å¸¸è¢«ç”¨æ¥å®ç°ä¸ºå…·æœ‰è£…é¥°æ¨¡å¼çš„å®¹å™¨ã€‚</em></p>
</blockquote>
<ul>
<li>ConetextHandlerCollection<br>ä¸€ä¸ªä¸“é—¨çš„HandlerCollectionï¼Œå®ƒç”¨è¯·æ±‚URLçš„æœ€é•¿çš„å‰ç¼€æ¥é€‰æ‹©åŒ…å«è¿™ä¸ªå‰ç¼€çš„ContextHandlerå»å¤„ç†è¯·æ±‚ã€‚</li>
</ul>
<blockquote>
<p><em>è¯‘è€…æ–‡å¤–è¡¥å……ï¼šå®ƒæ˜¯ç»§æ‰¿äº<code>HandlerCollection</code>çš„ï¼Œåœ¨å…¶Javadocä¸­å®šä¹‰æ‰€æè¿°ï¼šè¿™ä¸ª<code>HandlerCollection</code>çš„å­ç±»å¯ä»¥å¯¹contextså’Œè¿™ä¸ªå®¹å™¨é‡Œé¢åŒ…å«çš„handlersåŸºäºcontext pathå’Œ<code>ContextHandlers</code>ç±»çš„å…³ç³»ç”Ÿæˆä¸€ä¸€å¯¹åº”çš„æ˜ å°„ã€‚contextså¹¶ä¸éœ€è¦ç›´æ¥è£…è¿›è¿™ä¸ªå®¹å™¨ä¸­ï¼Œä½ åªéœ€è¦æŠŠhandlersè£…è¿›å»å°±å¯ä»¥äº†ã€‚å¤šä¸ªcontextså¯èƒ½ä¼šæœ‰ä¸€æ ·çš„context pathï¼Œå®ƒä»¬ä¼šæŒ‰ç…§é¡ºåºè¢«è°ƒç”¨ç›´åˆ°å…¶ä¸­ä¸€ä¸ªhandlerå¤„ç†äº†è¿™æ¬¡è¯·æ±‚ã€‚</em></p>
</blockquote>
<p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="21234scoped-handlers"></span></p>

          <h6>
            <a name="_root-21.2.3.4ã€Scoped Handlers" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.2.3.4ã€Scoped Handlers
          </h6><p>è®¸å¤šæ ‡å‡†Servletå®¹å™¨ï¼ŒJettyæ˜¯ç”¨<code>HandlerWrapper</code>å®ç°çš„ï¼Œå®ƒæŠŠå¾ˆå¤šhandlerä»¥è‰¯å¥½çš„é“¾å¼å¤„ç†è¿åœ¨ä¸€èµ·ï¼š<code>ContextHandler</code>-<code>SessionHandler</code>-<code>SecurityHandler</code>-<code>ServletHandler</code>ã€‚ç„¶è€Œï¼Œå› ä¸ºServletè§„èŒƒçš„ç‰¹æ€§ï¼Œè¿™ç§é“¾å¼å¤„ç†å¹¶ä¸èƒ½å°±è¿™ä¹ˆå•çº¯çš„å°±æŠŠhandleråµŒå¥—èµ·æ¥ï¼Œå› ä¸ºå¤–å±‚handleræœ‰æ—¶å€™ä¼šéœ€è¦å†…å±‚handlerå¤„ç†è¿‡çš„ä¿¡æ¯ã€‚æ¯”å¦‚è¯´å½“ContextHandlerè°ƒç”¨åº”ç”¨çš„ç›‘å¬å™¨ä»¥é€šçŸ¥æœ‰è¯·æ±‚è¿›åˆ°contextçš„æ—¶å€™ï¼ŒServletHandlerå¿…é¡»æå‰çŸ¥é“è¯·æ±‚è¯¥è½¬å‘åˆ°å“ªä¸€ä¸ªservletï¼Œè¿™æ ·æ‰å¥½è¿”å›æ­£ç¡®çš„servletPathå€¼ã€‚</p>
<p><code>HandlerWrapper</code>æ˜¯<code>ScopedHandler</code>æŠ½è±¡ç±»çš„çˆ¶ç±»ï¼Œè¿™ä¸ªæŠ½è±¡ç±»æä¾›äº†ä¸€ä¸ªè‰¯å¥½çš„é“¾å¼èŒƒå›´ã€‚æ¯”å¦‚è¯´ä¸€ä¸ªServletHandleråµŒå¥—åœ¨ContextHandlerä¸­ï¼Œæ‰§è¡ŒåµŒå¥—çš„é¡ºåºå¦‚ä¸‹ï¼š</p>
<pre><code>Server.handle(...)
  ContextHandler.doScope(...)
    ServletHandler.doScope(...)
      ContextHandler.doHandle(...)
        ServletHandler.doHandle(...)
          SomeServlet.service(...)</code></pre><p>è¿™æ ·ä¸€æ¥ï¼Œå½“ContextHandlerå¤„ç†åˆ°è¯·æ±‚åï¼Œåœ¨æŒ‡å®šçš„ServletHandleré‡Œé¢ä¹Ÿä¼šå¤„ç†ä¸€éã€‚</p>
<blockquote>
<p><em>è¯‘è€…æ–‡å¤–è¡¥å……ï¼š<code>ServletHandler</code>å’Œ<code>ContextHandler</code>éƒ½æ˜¯<code>ScopedHandler</code>çš„å…·ä½“å®ç°ã€‚</em></p>
</blockquote>
<p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="21235resource-handler"></span></p>

          <h6>
            <a name="_root-21.2.3.5ã€Resource Handler" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.2.3.5ã€Resource Handler
          </h6><p>FileServeræ —å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Resource Handlerå»ä¸ºå½“å‰å·¥ä½œç›®å½•ä¸‹çš„é™æ€èµ„æºæœåŠ¡ï¼š</p>
<pre><code>package org.eclipse.jetty.embedded;

import org.eclipse.jetty.server.Handler;
import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.server.handler.DefaultHandler;
import org.eclipse.jetty.server.handler.HandlerList;
import org.eclipse.jetty.server.handler.ResourceHandler;

/**
 * Simple Jetty FileServer.
 * This is a simple example of Jetty configured as a FileServer.
 */
public class FileServer
{
    public static void main(String[] args) throws Exception
    {
        // åˆ›å»ºJettyçš„serveråˆ°8080ç«¯å£
        // å¦‚æœä½ è®¾ç½®çš„ç«¯å£å·ä¸º0 é‚£ä¹ˆJettyä¼šéšæœºä¸ºä½ é€‰æ‹©ä¸€ä¸ªå½“å‰ç³»ç»Ÿå¯ç”¨çš„ç«¯å£å·
        // ä½ å¯ä»¥åœ¨å¯åŠ¨çš„æ—¶å€™é€šè¿‡logçœ‹åˆ°éšæœºé€‰æ‹©çš„ç«¯å£å·
        // æˆ–è€…ä½¿ç”¨æµ‹è¯•æ¡ˆä¾‹æ¥è·å–
        Server server = new Server(8080);

        // åˆ›å»ºResourceHandler
        // è¿™ä¼šä¸ºç»™å®šçš„èµ„æºæ–‡ä»¶å¤„ç†è¯·æ±‚
        // è¿™æ˜¯Jetty Handlerå¯¹è±¡ æ‰€ä»¥ä½ å¯ä»¥æŠŠå®ƒæ”¾åœ¨é“¾å¼å¤„ç†è¿‡ç¨‹ä¸­
        // ä½ å¯ä»¥åœ¨å…¶ä»–æ —å­ä¸­çœ‹åˆ°è¿™ä¸ªç”¨æ³•
        ResourceHandler resource_handler = new ResourceHandler();

        // é…ç½®ResourceHandler
        // è®¾ç½®resource base æ¥è¡¨æ˜åº”è¯¥æœåŠ¡äºé‚£ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶
        // åœ¨å½“å‰çš„æ —å­ä¸­ resource base è®¾ç½®çš„æ˜¯å½“å‰ç›®å½•
        // é™¤æ­¤ä¹‹å¤–å®ƒè¿˜å¯ä»¥è®¾ç½®åˆ°å…¶ä»–ä»»ä½•JVMå¯ä»¥è®¿é—®åˆ°çš„ç›®å½•
        resource_handler.setDirectoriesListed(true);
        resource_handler.setWelcomeFiles(new String[]{ &quot;index.html&quot; });
        resource_handler.setResourceBase(&quot;.&quot;);

        // Add the ResourceHandler to the server.
        HandlerList handlers = new HandlerList();
        handlers.setHandlers(new Handler[] { resource_handler, new DefaultHandler() });
        server.setHandler(handlers);

        // Start things up! By using the server.join() the server thread will join with the current thread.
        // See &quot;http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.html#join()&quot; for more details.
        server.start();
        server.join();
    }
}</code></pre><p>ä½ ä¼šæ³¨æ„åˆ°æœ‰ä¸€ä¸ªHandlerListå¯¹è±¡ï¼Œé‡Œé¢é“¾æ¥äº†ResourceHandlerå’ŒDefaultHandlerï¼Œè¿™æ ·DefaultHandlerä¼šåœ¨è®¿é—®åˆ°ä¸å­˜åœ¨èµ„æºçš„æƒ…å†µä¸‹ç”Ÿæˆ404å“åº”ã€‚</p>
<p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="2124åµŒå…¥connectors"></span></p>

          <h5>
            <a name="_root-21.2.4ã€åµŒå…¥Connectors" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.2.4ã€åµŒå…¥Connectors
          </h5><ul>
<li>21.2.4.1ã€<a href="#21241%E4%B8%80%E4%B8%AAconnectors">ä¸€ä¸ªConnectors</a></li>
<li>21.2.4.2ã€<a href="#21242%E5%A4%9A%E4%B8%AAconnectors">å¤šä¸ªConnectors</a></li>
</ul>
<p>åœ¨ä¸Šä¸€ä¸ªæ —å­ä¸­ï¼Œ<code>Server</code>é€šè¿‡ç«¯å£å·åœ¨å†…éƒ¨åˆ›å»ºäº†ä¸€ä¸ªé»˜è®¤çš„Connectoræ¥ç›‘å¬æ‰€æœ‰é€šè¿‡è¿™ä¸ªç«¯å£å·è¿›æ¥çš„è¯·æ±‚ã€‚ç„¶è€Œï¼Œä¸€èˆ¬æˆ‘ä»¬ç”¨Jettyä½œåµŒå…¥å¼å¼€å‘çš„æ—¶å€™ï¼Œæ­£ç¡®çš„åšæ³•æ˜¯æ˜¾ç¤ºåœ°å»é…ç½®ä¸€ä¸ªæˆ–å¤šä¸ªconnectoræä¾›ç»™<code>Server</code>å®ä¾‹ã€‚</p>
<p><span id="21241ä¸€ä¸ªconnectors"></span></p>

          <h6>
            <a name="_root-21.2.4.1ã€ä¸€ä¸ªConnectors" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.2.4.1ã€ä¸€ä¸ªConnectors
          </h6><p>ä¸¾ä¸ªä¾‹å­ï¼Œ<code>OneConnector.java</code>ï¼Œå®ä¾‹åŒ–ã€é…ç½®ã€æ·»åŠ å¥½äº†ä¸€ä¸ªç®€å•çš„HTTP Connectorå®ä¾‹ï¼Œå¹¶æŠŠè¿™ä¸ªå®ä¾‹æ·»åŠ åˆ°serverä¸­ï¼š</p>
<pre><code>package org.eclipse.jetty.embedded;

import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.server.ServerConnector;

/**
 * A Jetty server with one connectors.
 */
public class OneConnector
{
    public static void main( String[] args ) throws Exception
    {
        // The Server
        Server server = new Server();

        // HTTP connector
        ServerConnector http = new ServerConnector(server);
        http.setHost(&quot;localhost&quot;);
        http.setPort(8080);
        http.setIdleTimeout(30000);

        // Set the connector
        server.addConnector(http);

        // Set a handler
        server.setHandler(new HelloHandler());

        // Start the server
        server.start();
        server.join();
    }
}</code></pre><p>ä¸Šæ —çš„connectorå¯ä»¥å¤„ç†HTTPåè®®çš„è¯·æ±‚ï¼Œè¿™æ ·çš„å®ç°æ–¹å¼æ˜¯<code>ServerConnector</code>ç±»çš„é»˜è®¤æ–¹å¼æ˜¯ä¸€æ ·çš„ã€‚</p>
<p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="21242å¤šä¸ªconnectors"></span></p>

          <h6>
            <a name="_root-21.2.4.2ã€å¤šä¸ªConnectors" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.2.4.2ã€å¤šä¸ªConnectors
          </h6><p>å¦‚æœæƒ³è¦é…ç½®å¤šä¸ªconnectorsçš„æ—¶å€™ï¼ˆæ¯”å¦‚HTTP+HTTPSï¼‰ï¼Œå¯èƒ½éœ€è¦å…±äº«ä¸€äº›ä¸ºHTTPè¿æ¥é…ç½®è¿‡çš„å‚æ•°ã€‚ä¸ºäº†åšåˆ°è¿™ä¸€ç‚¹ï¼Œä½ éœ€è¦æ˜¾ç¤ºåœ°ä½¿ç”¨<code>ConnectionFactory</code>å®ä¾‹å»é…ç½®<code>ServerConnector</code>ç±»ï¼Œç„¶åæä¾›å®ƒä»¬é€šç”¨çš„HTTPé…ç½®ã€‚</p>
<blockquote>
<p><em>è¯‘è€…æ–‡å¤–è¡¥å……ï¼šè¿™é‡Œæ–‡æ¡£å¹¶æ²¡æœ‰ç»™å‡ºç¤ºä¾‹ä»£ç ï¼Œä»£ç çš„ä¸‹è½½é“¾æ¥ä¹ŸæŒ‚äº†ï¼Œåé¢ä»…æœ‰ä¸€æ®µå…³äºè¿™ä¸ªå¤šè¿æ¥æ —å­çš„æè¿°ï¼Œæˆ‘å°±ä¸ç¿»è¯‘äº†ã€‚å…³äºè¿™å¤šé“¾æ¥çš„ç¤ºä¾‹ä»£ç ï¼Œâ€œå·²å¾€ä¹‹ä¸è°â€å‰è¾ˆçš„åšå®¢é‡Œé¢æœ‰ï¼Œå¤§å®¶å¯ä»¥åœ¨<a href="http://www.cnblogs.com/yiwangzhibujian/p/5845623.html">è¿™é‡Œ</a>å»å‚è€ƒã€‚</em></p>
</blockquote>
<blockquote>
<p><em>æ —å­æè¿°åŸæ–‡ï¼šThe ManyConnectors example, configures a server with two <code>ServerConnector</code> instances: the http connector has a <code>HTTPConnectionFactory</code> instance; the https connector has a <code>SslConnectionFactory</code> chained to a <code>HttpConnectionFactory</code>. Both <code>HttpConnectionFactory</code> are configured based on the same <code>HttpConfiguration</code> instance, however the HTTPS factory uses a wrapped configuration so that a <code>SecureRequestCustomizer</code> can be added.</em></p>
</blockquote>
<p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="2125åµŒå…¥servlets"></span></p>

          <h5>
            <a name="_root-21.2.5ã€åµŒå…¥Servlets" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.2.5ã€åµŒå…¥Servlets
          </h5><p>Servletæ˜¯ä¸ºHTTPè¯·æ±‚æä¾›ä¸šåŠ¡é€»è¾‘çš„æ ‡å‡†è§£å†³æ–¹æ¡ˆã€‚Servleté™¤äº†å®ƒé‡Œé¢çš„requestå¯¹è±¡æ˜¯ä¸å¯å˜çš„ä¹‹å¤–ï¼Œåœ¨å…¶ä»–æ–¹é¢å’ŒJettyçš„Handlerå¾ˆåƒã€‚åœ¨Jettyé‡Œé¢Servleté€šè¿‡<code>ServletHandler</code>ç±»å»æ¥å…¥å¤„ç†ã€‚è¿™ä¸ªç±»ä½¿ç”¨æ ‡å‡†çš„è·¯å¾„æ˜ å°„å»ä¸ºè¯·æ±‚åŒ¹é…ä¸€ä¸ªServletï¼Œä½ è¿˜éœ€è¦è®¾ç½®è¯·æ±‚çš„<code>servletPath</code>å’Œ<code>pathInfo</code>ï¼Œç„¶åé€šè¿‡ä¸€äº›Filterså¤„ç†ä¹‹åï¼ŒæŠŠè¯·æ±‚ä¼ é€’åˆ°servletï¼Œä»¥ç”Ÿæˆé¡¹å“åº”ã€‚</p>
<p>ä»¥ä¸‹çš„æ —å­å±•ç¤ºäº†ä¸€ä¸ªç®€ç­”çš„Servlet mappingè¿‡ç¨‹</p>
<pre><code>package org.eclipse.jetty.embedded;

import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.servlet.ServletHandler;

public class MinimalServlets
{
    public static void main( String[] args ) throws Exception
    {
        Server server = new Server(8080);

        // ServletHandleræ˜¯æœ€æœ€æœ€ç®€å•çš„æ–¹å¼å»åˆ›å»ºcontext handler
        // æ¥è¿”å›ä¸€ä¸ªServletå®ä¾‹
        // è¿™ä¸ªhandleréœ€è¦æ³¨å†ŒServletå¯¹è±¡
        ServletHandler handler = new ServletHandler();
        server.setHandler(handler);

        // é€šè¿‡è¿™ä¸ªç±» Jettyå¯ä»¥å®ä¾‹åŒ–ä¸€ä¸ªServletå®ä¾‹å¹¶æŠŠå®ƒåµŒå…¥åˆ°ç»™å®šçš„context pathä¸Š

        // é‡è¦ï¼š
        // è¿™æ˜¯ä¸€ä¸ªåŸç”Ÿçš„Servlet
        // ä¸æ˜¯å¹³å¸¸çš„é‚£ç§è¢«`@WebServlet`æˆ–è€…web.xmlæˆ–è€…å…¶ä»–ç±»ä¼¼æ–¹å¼é…ç½®è¿‡çš„Servlet
        handler.addServletWithMapping(HelloServlet.class, &quot;/*&quot;);

        // å¼€å¯
        server.start();

        // server.join()æ–¹æ³•ä¼šè®©å½“å‰çº¿ç¨‹joinå¹¶ä¸”wait
        server.join();
    }

    @SuppressWarnings(&quot;serial&quot;)
    public static class HelloServlet extends HttpServlet
    {
        @Override
        protected void doGet( HttpServletRequest request,
                              HttpServletResponse response ) throws ServletException,
                                                            IOException
        {
            response.setContentType(&quot;text/html&quot;);
            response.setStatus(HttpServletResponse.SC_OK);
            response.getWriter().println(&quot;&lt;h1&gt;Hello from HelloServlet&lt;/h1&gt;&quot;);
        }
    }
}</code></pre><p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="2126åµŒå…¥contexts"></span></p>

          <h5>
            <a name="_root-21.2.6ã€åµŒå…¥Contexts" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.2.6ã€åµŒå…¥Contexts
          </h5><p>ä¸€ä¸ª<code>ContextHandler</code>æ˜¯ä¸€ä¸ª<code>ScopedHandler</code>ï¼Œåªæœ‰è¯·æ±‚è¿‡æ¥çš„URLå‰ç¼€å’Œæˆ‘ä»¬è®¾å®šçš„context pathç›¸åŒ¹é…æ‰ä¼šå“åº”ã€‚è¯·æ±‚åŒ¹é…åˆ°å®ƒä»¬å¯¹åº”çš„context pathä¹‹åï¼Œä¼šæœ‰å®ƒä»¬å¯¹åº”çš„pathæ–¹æ³•ï¼Œå¹¶ä¸”contextèŒƒå›´å†…çš„èµ„æºæ˜¯å¯ç”¨çš„ï¼Œä»¥ä¸‹æ˜¯å¯èƒ½çš„èŒƒå›´æƒ…å†µï¼š</p>
<ul>
<li>å½“è¯·æ±‚åˆ°æŸä¸ªcontextçš„æ—¶å€™ï¼ŒåŠ è½½è¿™ä¸ªcontextçš„ç±»åŠ è½½å™¨èŒƒå›´æ˜¯å¯ç”¨çš„ã€‚</li>
<li>é€šè¿‡<code>ServletContext</code>APIè®¾ç½®çš„attributeé›†åˆéƒ½å¯ç”¨è¢«ä½¿ç”¨ã€‚</li>
<li>é€šè¿‡<code>ServletContext</code>APIè®¾ç½®çš„paramentersé›†åˆéƒ½å¯ç”¨è¢«ä½¿ç”¨ã€‚</li>
<li>é€šè¿‡<code>ServletContext</code>APIè®¾ç½®çš„ç”¨åšé™æ€èµ„æºè¯·æ±‚çš„Resourceåº“ä¸­çš„èµ„æºéƒ½å¯ç”¨è¢«ä½¿ç”¨ã€‚</li>
<li>è™šæ‹Ÿæœºçš„åå­—é›†åˆéƒ½å¯ç”¨è¢«ä½¿ç”¨ã€‚</li>
</ul>
<p>ä¸‹é¢è¿™ä¸ªæ —å­å°±æ˜¯é€šè¿‡åŒ…è£…<code>HelloHandler</code>æ¥å±•ç¤ºå¦‚ä½•å»ºç«‹contextï¼š</p>
<pre><code>package org.eclipse.jetty.embedded;

import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.server.handler.ContextHandler;

public class OneContext
{
    public static void main( String[] args ) throws Exception
    {
        Server server = new Server( 8080 );

        // åœ¨&quot;/hello&quot;ä¸Šæ·»åŠ ä¸€ä¸ªhandler
        ContextHandler context = new ContextHandler();
        context.setContextPath( &quot;/hello&quot; );
        context.setHandler( new HelloHandler() );

        // ç°åœ¨å¯ä»¥è®¿é—® http://localhost:8080/hello

        server.setHandler( context );

        // Start the server
        server.start();
        server.join();
    }
}</code></pre><p>å½“æœ‰è®¸å¤šcontextçš„æ—¶å€™ï¼Œä½ å¯ä»¥åµŒå…¥ä¸€ä¸ª<code>ContextHandlerCollection</code>æ¥æœ‰æ•ˆåœ°æ£€æŸ¥è¯·æ±‚URIï¼Œç„¶åé€‰æ‹©åŒ¹é…çš„ContextHandleræ¥å¤„ç†è¯·æ±‚ã€‚ä¸‹é¢è¿™ä¸ªæ —å­å°±æ˜¯å‘Šè¯‰ä½ å¦‚ä½•é…ç½®å¤šå°‘contextï¼š</p>
<pre><code>package org.eclipse.jetty.embedded;

import org.eclipse.jetty.server.Handler;
import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.server.handler.ContextHandler;
import org.eclipse.jetty.server.handler.ContextHandlerCollection;

public class ManyContexts
{
    public static void main( String[] args ) throws Exception
    {
        Server server = new Server(8080);

        ContextHandler context = new ContextHandler(&quot;/&quot;);
        context.setContextPath(&quot;/&quot;);
        context.setHandler(new HelloHandler(&quot;Root Hello&quot;));

        ContextHandler contextFR = new ContextHandler(&quot;/fr&quot;);
        contextFR.setHandler(new HelloHandler(&quot;Bonjoir&quot;));

        ContextHandler contextIT = new ContextHandler(&quot;/it&quot;);
        contextIT.setHandler(new HelloHandler(&quot;Bongiorno&quot;));

        ContextHandler contextV = new ContextHandler(&quot;/&quot;);
        contextV.setVirtualHosts(new String[] { &quot;127.0.0.2&quot; });
        contextV.setHandler(new HelloHandler(&quot;Virtual Hello&quot;));

        ContextHandlerCollection contexts = new ContextHandlerCollection();
        contexts.setHandlers(new Handler[] { context, contextFR, contextIT,
                contextV });

        server.setHandler(contexts);

        server.start();
        server.join();
    }
}</code></pre><p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="2127åµŒå…¥servletcontexts"></span></p>

          <h5>
            <a name="_root-21.2.7ã€åµŒå…¥ServletContexts" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.2.7ã€åµŒå…¥ServletContexts
          </h5><p><code>ServletContextHandler</code>çš„<code>ContextHandler</code>çš„ä¸€ä¸ªé‡è¦å­ç±»ï¼Œå®ƒæ”¯æŒæ ‡å‡†çš„Servletå’Œsessionsæœºåˆ¶ã€‚æ¥ä¸‹æ¥çš„æ —å­å®ä¾‹åŒ–äº†ä¸€ä¸ª<code>DefaultServlet</code>æ¥ä¸º/tmp/ç›®å½•ä¸‹çš„é™æ€èµ„æºæœåŠ¡ï¼Œè¿˜æœ‰ä¸€ä¸ª<code>DumpServlet</code>ï¼Œå®ƒè´Ÿè´£åˆ›å»ºsessionå’Œä¼ å‚¨è¯·æ±‚ä¸­çš„ä¸€äº›åŸºæœ¬ç»†èŠ‚ï¼š</p>
<pre><code>package org.eclipse.jetty.embedded;

import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.servlet.DefaultServlet;
import org.eclipse.jetty.servlet.ServletContextHandler;

public class OneServletContext
{
    public static void main( String[] args ) throws Exception
    {
        Server server = new Server(8080);

        ServletContextHandler context = new ServletContextHandler(
                ServletContextHandler.SESSIONS);
        context.setContextPath(&quot;/&quot;);
        context.setResourceBase(System.getProperty(&quot;java.io.tmpdir&quot;));
        server.setHandler(context);

        // Add dump servlet
        context.addServlet(DumpServlet.class, &quot;/dump/*&quot;);
        // Add default servlet
        context.addServlet(DefaultServlet.class, &quot;/&quot;);

        server.start();
        server.join();
    }
}</code></pre><br>

<blockquote>
<p><em>è¯‘è€…æ–‡å¤–è¡¥å……ï¼šè¿™é‡Œçš„<code>DumpServlet</code>åªæ˜¯ç¤ºä¾‹ï¼Œä¸æ˜¯JettyAPIæä¾›çš„å®ä¾‹ã€‚è¿™é‡Œçš„<code>setResourceBase()</code>æ–¹æ³•å¾ˆé‡è¦ï¼Œè¿™è·Ÿæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨TomcatæœåŠ¡å™¨ï¼Œè€Œæˆ‘ä»¬çš„èµ„æºè·¯å¾„é»˜è®¤å°±æ˜¯é¡¹ç›®ä¸‹çš„webappç›®å½•æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬éœ€è¦é è¿™ä¸ªæ¥è®¾ç½®Jettyï¼Œä»¥è¾¾åˆ°åŒæ ·çš„æ•ˆæœã€‚</em></p>
</blockquote>
<p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="2128åµŒå…¥webåº”ç”¨ç¨‹åº"></span></p>

          <h5>
            <a name="_root-21.2.8ã€åµŒå…¥Webåº”ç”¨ç¨‹åº" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.2.8ã€åµŒå…¥Webåº”ç”¨ç¨‹åº
          </h5><p>ä¸€ä¸ª<code>WebAppContext</code>æ˜¯ä¸€ä¸ª<code>ServletContextHandler</code>çš„æ‹“å±•ï¼Œå®ƒä½¿ç”¨æ ‡å‡†å¸ƒå±€å’Œ<code>web.xml</code>æ¥é…ç½®ä½¿ç”¨æ³¨è§£æˆ–è€…åœ¨web.xmlä¸­é…ç½®çš„Servletã€filterså’Œå…¶ä»–åŠŸèƒ½ã€‚ä¸‹é¢è¿™ä¸ªæ —å­é…ç½®äº†ä¸€ä¸ªJettyçš„æµ‹è¯•webappã€‚Webåº”ç”¨å¯ä»¥ä½¿ç”¨å®¹å™¨æä¾›çš„èµ„æºï¼Œåœ¨è¿™ä¸ªæ —å­é‡Œé¢çš„<code>LoginService</code>æ­£æ˜¯è¿™æ ·é…ç½®çš„ï¼š</p>
<pre><code>package org.eclipse.jetty.embedded;

import java.io.File;
import java.lang.management.ManagementFactory;

import org.eclipse.jetty.jmx.MBeanContainer;
import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.server.handler.AllowSymLinkAliasChecker;
import org.eclipse.jetty.webapp.WebAppContext;

public class OneWebApp
{
    public static void main( String[] args ) throws Exception
    {
        Server server = new Server(8080);

        // è®¾ç½®JMX
        MBeanContainer mbContainer = new MBeanContainer(
                ManagementFactory.getPlatformMBeanServer());
        server.addBean(mbContainer);

        // WebAppContextå¯¹è±¡æ˜¯ç”¨æ¥æ§åˆ¶å®ƒè‡ªå·±èµ–ä»¥ç”Ÿå­˜çš„ç¯å¢ƒçš„ã€‚
        // åœ¨è¿™ä¸ªæ —å­é‡Œé¢ï¼Œcontext pathè®¾ç½®ä¸ºâ€œ/â€
        // è¿™æ ·å®ƒå°±å¯ä»¥å¤„ç†æ ¹contextä¸‹çš„è¯·æ±‚äº†
        // æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°å®ƒè®¾ç½®äº†warçš„ä½ç½®
        // æ•´ä¸ªhostçš„å…¶ä»–é…ç½®éƒ½æ˜¯å¯ç”¨çš„å¯é…ç½®çš„
        // ä½ å¯ç”¨é…ç½®æ³¨è§£æ‰«æçš„æ”¯æŒï¼ˆéœ€è¦é€šè¿‡PlusConfigurationï¼‰
        // è¿˜å¯ç”¨é€‰æ‹©webappåœ¨å“ªé‡Œè‡ªåŠ¨è§£å‹
        WebAppContext webapp = new WebAppContext();
        webapp.setContextPath(&quot;/&quot;);
        File warFile = new File(
                &quot;../../tests/test-jmx/jmx-webapp/target/jmx-webapp&quot;);
        webapp.setWar(warFile.getAbsolutePath());

        // ä¸€ä¸ªWebAppContextæ˜¯ä¸€ä¸ªContextHandler
        // æ‰€ä»¥å®ƒä¹Ÿéœ€è¦è¢«é…ç½®åˆ°serveré‡Œé¢è¿™æ ·serveræ‰ä¼šçŸ¥é“è¯·æ±‚å°†è¢«é€å¾€å“ªé‡Œ
        server.setHandler(webapp);

        // Start things up!
        server.start();

        server.dumpStdErr();

        server.join();
    }
}</code></pre><br>

<blockquote>
<p><em>è¯‘è€…æ–‡å¤–è¡¥å……ï¼šæ —å­ä¸­çš„JMXæ˜¯ä¸€ç§é¢å¤–ç»„ä»¶ï¼Œä¸æ˜¯Jettyçš„æœåŠ¡ã€‚ä½ å¯ä»¥å‡†å¤‡ä¸€äº›waråŒ…è‡ªå·±æµ‹è¯•ã€‚ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨waråŒ…ï¼Œç›´æ¥ä½¿ç”¨æœ‰æ ‡å‡†webåº”ç”¨å¸ƒå±€çš„ç›®å½•ã€‚å¦‚æœä½ æƒ³è¦Jettyæ”¯æŒServletæ³¨è§£é…ç½®ï¼Œä½ å¯ä»¥åœ¨<a href="">è¿™é‡Œ</a>äº†è§£åˆ°æ›´å¤šã€‚</em></p>
</blockquote>
<br>
<span id="2129åƒjettyxmlä¸€æ ·è¿›è¡ŒåµŒå…¥å¼å¼€å‘"></span>
##### 21.2.9ã€åƒJettyXMLä¸€æ ·è¿›è¡ŒåµŒå…¥å¼å¼€å‘

<p>å…¸å‹çš„JettyæœåŠ¡å™¨é…ç½®çš„åšæ³•æ˜¯é€šè¿‡Jetty.xmlæ–‡ä»¶è¿›è¡Œé…ç½®ã€‚ç„¶è€ŒJetty XMLé…ç½®åªæ˜¯ä¸€ä¸ªç®€å•çš„æ¸²æŸ“ï¼Œå®ƒåœ¨èµ·åˆ°é…ç½®ä½œç”¨çš„åŒæ—¶è¿˜å‘ä½ å±•ç¤ºäº†åœ¨ä»£ç é‡Œé¢æ˜¯å¦‚ä½•é…ç½®çš„ã€‚ç…§ç€jetty.xmlçš„åšæ³•ï¼Œä½ å¾ˆç®€å•å°±å¯ä»¥åœ¨ä»£ç é‡Œé¢é…ç½®JettyServerã€‚</p>
<blockquote>
<p><em>è¯‘è€…æ–‡å¤–è¡¥å……ï¼šæ–‡æ¡£åé¢è¿™è´´å‡ºäº†ä»£ç å±•ç¤ºå¦‚ä½•åœ¨ä»£ç åƒJettyXMLé…ç½®ä¸€æ ·åšJettyServerçš„é…ç½®ï¼Œè¿™é‡Œå¯¹æˆ‘çš„å­¦ä¹ ä»·å€¼ä¸å¤§ï¼Œæ‰€ä»¥æˆ‘å°±ä¸è´´äº†ï¼Œå¤§å®¶æœ‰å…´è¶£è‡ªå·±å»åŸæ–‡çœ‹ã€‚</em></p>
</blockquote>
<br>

<p><a href="#top">å›åˆ°é¡¶éƒ¨</a></p>
<hr>
<p><span id="213åµŒå…¥å¼å¼€å‘çš„æ —å­"></span></p>

          <h4>
            <a name="_root-21.3ã€åµŒå…¥å¼å¼€å‘çš„æ —å­" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.3ã€åµŒå…¥å¼å¼€å‘çš„æ —å­
          </h4><p>Jettyåœ¨å„ç§å„æ ·çš„åº”ç”¨ä¸­æœ‰ç€éå¸¸ä¸°å¯Œçš„åµŒå…¥å¼å¼€å‘å†å²ã€‚è¿™ä¸ªéƒ¨åˆ†æˆ‘ä»¬ä¼šå‘ä½ ä»‹ç»ä¸€äº›ç®€å•åº”ç”¨çš„åµŒå…¥å¼å¼€å‘çš„æ —å­ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨æˆ‘ä»¬çš„<a href="https://github.com/jetty-project?utf8=%E2%9C%93&amp;q=&amp;type=&amp;language=">gitä»“åº“</a>æ‰¾åˆ°è®¸å¤šçš„JettyåµŒå…¥å¼å¼€å‘çš„ç¤ºä¾‹é¡¹ç›®ã€‚</p>
<ul>
<li>21.3.1ã€<a href="#2131%E7%AE%80%E5%8D%95%E7%9A%84%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8">ç®€å•çš„æ–‡ä»¶æœåŠ¡å™¨</a></li>
<li>21.3.2ã€<a href="#2132%E5%8F%AF%E5%88%86%E5%B8%83%E7%9A%84%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8">å¯åˆ†å¸ƒçš„æ–‡ä»¶æœåŠ¡å™¨</a></li>
<li>21.3.3ã€<a href="#2133%E5%A4%9Aconnectors">å¤šConnectors</a></li>
<li>21.3.4ã€<a href="#2134%E5%AE%89%E5%85%A8%E6%96%B9%E9%9D%A2handler%E7%9A%84hello-world">å®‰å…¨æ–¹é¢Handlerçš„Hello World</a></li>
<li>21.3.5ã€<a href="#2135%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84servlet">æœ€ç®€å•çš„Servlet</a></li>
<li>21.3.6ã€<a href="#2136web-application">Web Application</a></li>
<li>21.3.7ã€<a href="#2137web-application%E4%BB%A5%E5%8F%8Ajsp">Web Applicationä»¥åŠJSP</a></li>
</ul>
<p><span id="2131ç®€å•çš„æ–‡ä»¶æœåŠ¡å™¨"></span></p>

          <h5>
            <a name="_root-21.3.1ã€ç®€å•çš„æ–‡ä»¶æœåŠ¡å™¨" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.3.1ã€ç®€å•çš„æ–‡ä»¶æœåŠ¡å™¨
          </h5><p>è¿™ä¸ªæ —å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨Jettyåˆ›å»ºä¸€ä¸ªç®€å•çš„æ–‡ä»¶æœåŠ¡å™¨ã€‚è¿™å¯¹äºä½ æƒ³è¦ä¸€ä¸ªå…·æœ‰è·å–æ–‡ä»¶åŠŸèƒ½çš„æœåŠ¡å™¨æ¥è¯´æ˜¯ä¸€ä¸ªéå¸¸é€‚åˆçš„æ —å­ï¼Œå®ƒå¯ä»¥éå¸¸ç®€å•çš„å°±é…ç½®å¥½å¹¶ä¸”ä¸ºæŒ‡å®šèµ„æºç›®å½•ä¸‹çš„æ–‡ä»¶è¿›è¡ŒæœåŠ¡ã€‚ä½ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œæ²¡æœ‰ä»»ä½•çš„ä¸šåŠ¡é€»è¾‘æ¥åšæ–‡ä»¶ç¼“å­˜ï¼ŒåŒæ ·æœåŠ¡å™¨è®¾ç½®å’Œå“åº”å¤´é‡Œé¢ä¹Ÿæ²¡æœ‰ã€‚</p>
<pre><code>package org.eclipse.jetty.embedded;

import org.eclipse.jetty.server.Handler;
import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.server.handler.DefaultHandler;
import org.eclipse.jetty.server.handler.HandlerList;
import org.eclipse.jetty.server.handler.ResourceHandler;

/**
 * Simple Jetty FileServer.
 * This is a simple example of Jetty configured as a FileServer.
 */
public class FileServer
{
    public static void main(String[] args) throws Exception
    {
        Server server = new Server(8080);

        // åˆ›å»ºResoueceHandler
        // è¿™ä¸ªå¯¹è±¡ä¼šå¤„ç†å¯¹èµ„æºæ–‡ä»¶çš„è¯·æ±‚
        // è¿™æ˜¯Jettyçš„Handlerå¯¹è±¡ æ‰€ä»¥å®ƒå¯ä»¥å’Œå…¶å®ƒHandleråœ¨ä¸€èµ·åšé“¾å¼å¤„ç†
        ResourceHandler resource_handler = new ResourceHandler();

        // é…ç½®ResoueceHandler
        // è®¾ç½®èµ„æºçš„baseæ¥è¡¨æ˜æœåŠ¡å™¨è¦æœåŠ¡äºå“ªä¸ªè·¯å¾„ä¸‹çš„æ–‡ä»¶
        // æœ¬ä¾‹æ˜¯è®¾ç½®ä¸ºå½“å‰ç›®å½• ä½ å¯ä»¥è®¾ç½®jvmå¯ä»¥è®¿é—®åˆ°çš„ä»»ä½•åœ°æ–¹
        resource_handler.setDirectoriesListed(true);
        resource_handler.setWelcomeFiles(new String[]{ &quot;index.html&quot; });
        resource_handler.setResourceBase(&quot;.&quot;);

        // Add the ResourceHandler to the server.
        HandlerList handlers = new HandlerList();
        handlers.setHandlers(new Handler[] { resource_handler, new DefaultHandler() });
        server.setHandler(handlers);

        server.start();
        server.join();
    }
}</code></pre><p>ç„¶åæ‰“å¼€8080ç½‘é¡µä½ å°±å¯ä»¥çœ‹åˆ°å½“å‰ç›®å½•çš„æƒ…å†µäº†ã€‚</p>
<p>è¿™é‡Œä½ ä¼šä½¿ç”¨åˆ°çš„Mavenä¾èµ–åæ ‡ï¼š</p>
<pre><code>&lt;dependency&gt;
  &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
  &lt;artifactId&gt;jetty-server&lt;/artifactId&gt;
  &lt;version&gt;${project.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre><blockquote>
<p><em>è¯‘è€…æ–‡å¤–è¡¥å……ï¼šæ —å­ä¸­è®¾ç½®çš„index.htmlæ˜¯æ¥æç¬‘çš„ï¼Œæ²¡ä»€ä¹ˆåµç”¨ã€‚å½“ç„¶å¦‚æœä½ å½“å‰ç›®å½•ä¸‹æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œä»£ç é‡Œé¢å°±æ­£å¥½æŠŠè¿™ä¸ªæ–‡ä»¶é…ç½®ä¸ºæ¬¢è¿é¡µé¢ï¼Œä½†æ˜¯å³ä½¿ä½ æ²¡ä½¿ç”¨ä»£ç è®¾ç½®ä¸ºæ¬¢è¿é¡µé¢ï¼Œåªè¦ä½ å½“å‰ç›®å½•ä¸‹æœ‰è¿™ä¸ªé¡µé¢ï¼Œä¹Ÿä¼šé»˜è®¤åˆ·è¿™ä¸ªé¡µé¢ï¼Œæ‰€ä»¥æˆ‘å»ºè®®ç›®å½•ä¸‹æœ€å¥½ä¸è¦æœ‰index.htmlæ–‡ä»¶ï¼Œç„¶å<code>setWelcomeFiles(null)</code>ï¼Œè¿™æ ·å°±ä¼šç›´æ¥è¿›å…¥æ–‡ä»¶ç³»ç»Ÿã€‚</em></p>
</blockquote>
<p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="2132å¯åˆ†å¸ƒçš„æ–‡ä»¶æœåŠ¡å™¨"></span></p>

          <h5>
            <a name="_root-21.3.2ã€å¯åˆ†å¸ƒçš„æ–‡ä»¶æœåŠ¡å™¨" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.3.2ã€å¯åˆ†å¸ƒçš„æ–‡ä»¶æœåŠ¡å™¨
          </h5><p>è¿™ä¸ªæ —å­æ˜¯åŸºäºä¸Šæ —æ¥å‘ä½ å±•ç¤ºå¦‚ä½•æŠŠå¤šä¸ª<code>ResourceHandler</code>é“¾å¼å¤„ç†åˆ°ä¸€èµ·ï¼Œè®©ä½ å¯ä»¥é›†ä¸­å¤šä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶åˆ°ä¸€ä¸ªcontext pathä¸‹ï¼Œè¿˜å‘ä½ å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨<code>ContextHandlers</code>æŠŠè¿™äº›pathè¿åœ¨ä¸€èµ·ï¼š</p>
<pre><code>package org.eclipse.jetty.embedded;

import java.io.File;

import org.eclipse.jetty.server.Connector;
import org.eclipse.jetty.server.Handler;
import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.server.ServerConnector;
import org.eclipse.jetty.server.handler.ContextHandler;
import org.eclipse.jetty.server.handler.ContextHandlerCollection;
import org.eclipse.jetty.server.handler.ResourceHandler;
import org.eclipse.jetty.toolchain.test.MavenTestingUtils;
import org.eclipse.jetty.util.resource.Resource;

/**
 * A {@link ContextHandlerCollection} handler may be used to direct a request to
 * a specific Context. The URI path prefix and optional virtual host is used to
 * select the context.
 */
public class SplitFileServer
{
    public static void main( String[] args ) throws Exception
    {
        Server server = new Server();
        ServerConnector connector = new ServerConnector(server);
        connector.setPort(8090);
        server.setConnectors(new Connector[] { connector });

        // åˆ›å»ºä¸€ä¸ªContext Handler å’ŒResourceHandler
        // ContextHandlerè®¾ç½®ä¸ºâ€œ/â€ ä½†ä½ å¯ä»¥è®¾ç½®å…¶å®ƒä½ æƒ³è¦çš„è·¯å¾„
        // ä½ éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬è®¾ç½®ResourceBaseä½¿ç”¨çš„æ˜¯maven testing utilitieså·¥å…·
        // æ¥è·å–èµ„æºçš„ç›®å½• ä½ å¯ä»¥ä¸éœ€è¦è¿™æ ·åš ä½ å¯ä»¥ç®€å•çš„æä¾›ä¸€ä¸ªèƒ½æ‰¾å¾—åˆ°çš„è·¯å¾„å°±å¯ä»¥äº†
        ResourceHandler rh0 = new ResourceHandler();

        ContextHandler context0 = new ContextHandler();
        context0.setContextPath(&quot;/&quot;);
        File dir0 = MavenTestingUtils.getTestResourceDir(&quot;dir0&quot;);
        context0.setBaseResource(Resource.newResource(dir0));
        context0.setHandler(rh0);

        // é‡å¤ä¸Šè¿°çš„å·¥ä½œ æŒ‡å®šä¸€ä¸ªä¸åŒçš„ç›®å½•
        ResourceHandler rh1 = new ResourceHandler();

        ContextHandler context1 = new ContextHandler();
        context1.setContextPath(&quot;/&quot;);
        File dir1 = MavenTestingUtils.getTestResourceDir(&quot;dir1&quot;);
        context1.setBaseResource(Resource.newResource(dir1));
        context1.setHandler(rh1);

        // åˆ›å»ºä¸€ä¸ªContextHandlerCollection
        // æŠŠcontext handler è®¾ç½®è¿›å»
        // jettyç¨‹åºä¼šæŠŠcontextå’Œå¯¹åº”çš„å†…å®¹ç›¸åŒ¹é…
        ContextHandlerCollection contexts = new ContextHandlerCollection();
        contexts.setHandlers(new Handler[] { context0, context1 });

        server.setHandler(contexts);

        // Start things up!
        server.start();

        // è½¬å‚¨æœåŠ¡å™¨çŠ¶æ€
        System.out.println(server.dump());
        server.join();
    }
}</code></pre><p>è¿™é‡Œä½ ä¼šä½¿ç”¨åˆ°çš„Mavenä¾èµ–åæ ‡ï¼š</p>
<pre><code>&lt;dependency&gt;
  &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
  &lt;artifactId&gt;jetty-server&lt;/artifactId&gt;
  &lt;version&gt;${project.version}&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.eclipse.jetty.toolchain&lt;/groupId&gt;
  &lt;artifactId&gt;jetty-test-helper&lt;/artifactId&gt;
  &lt;version&gt;2.2&lt;/version&gt;
&lt;/dependency&gt;</code></pre><blockquote>
<p><em>è¯‘è€…æ–‡å¤–è¡¥å……ï¼šç†Ÿæ‚‰handlerçš„äººé©¬ä¸Šå°±çŸ¥é“è¿™äº›é…ç½®æ˜¯æ€ä¹ˆè‚¥äº‹äº†ã€‚é‡Œé¢è¿˜æœ‰ä¸ª<code>server.dump()</code>æˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆè‚¥äº‹ã€‚</em></p>
</blockquote>
<p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="2133å¤šconnectors"></span></p>

          <h5>
            <a name="_root-21.3.3ã€å¤šConnectors" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.3.3ã€å¤šConnectors
          </h5><p>è¿™éƒ¨åˆ†å±•ç¤ºå¦‚ä½•ä½¿ç”¨å¤šè¿æ¥æ¥å¤„ç†ä¸åŒçš„è¯·æ±‚ï¼Œå¦‚httpå’Œhttpsã€‚</p>
<blockquote>
<p><em>è¯‘è€…æ–‡å¤–è¡¥å……ï¼šè¿™éƒ¨åˆ†æˆ‘çš„å­¦ä¹ éœ€æ±‚ä¸å¤§ï¼Œä»£ç ä¹Ÿå°±ä¸è´´äº†ä¸ç¿»è¯‘äº†ï¼Œå¯èƒ½æ—¥åæœ‰éœ€æ±‚äº†ä¼šå†æ¥è¡¥å……çš„ï¼Œå¤§å®¶æœ‰éœ€è¦å»çš„å»å‚é˜…<a href="http://www.eclipse.org/jetty/documentation/9.4.6.v20170531/embedded-examples.html">åŸæ–‡</a>ã€‚</em></p>
</blockquote>
<p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="2134å®‰å…¨æ–¹é¢handlerçš„hello-world"></span></p>

          <h5>
            <a name="_root-21.3.4ã€å®‰å…¨æ–¹é¢Handlerçš„Hello World" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.3.4ã€å®‰å…¨æ–¹é¢Handlerçš„Hello World
          </h5><p>è¿™ä¸ªæ —å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ä¸€ä¸ªè´Ÿè´£å®‰å…¨çš„handleræ¥åŒ…è£…å¦å¤–ä¸€ä¸ªhandlerã€‚è¿™é‡Œæœ‰ä¸€ä¸ªç®€å•çš„Hello Handlerï¼Œå®ƒè¿”å›ä¸€å¥é—®å€™è¯­ï¼Œä½†æ˜¯åœ¨è¿™ä¹‹å‰ä½ å¿…é¡»å…ˆé€šè¿‡èº«ä»½éªŒè¯ã€‚å¦ä¸€ä¸ªéœ€è¦æ³¨æ„çš„æ˜¯è¿™ä¸ªæ —å­æ˜¯ä½¿ç”¨çš„<code>ConstraintSecurityHandler</code>ï¼Œå®ƒå¯ä»¥åœ¨servletAPIä¸­æä¾›å®‰å…¨æ˜ å°„æ”¯æŒï¼Œæˆ‘ä»¬ç®€å•çš„å±•ç¤ºäº†ä¸€ä¸‹å®ƒçš„ç”¨æ³•ï¼Œä½†æ˜¯<code>Constraint</code>è¿˜å¯ä»¥æä¾›æ›´å¼ºå¤§çš„åŠŸèƒ½ã€‚å¦‚æœä½ ä¸éœ€è¦ï¼Œé‚£ä¹ˆä½ å¯ä»¥ä¸ä½¿ç”¨å®ƒè€Œä»…ä»…ä½¿ç”¨<code>SecurityHandler</code>ã€‚</p>
<blockquote>
<p><em>è¯‘è€…æ–‡å¤–è¡¥å……ï¼šè¿™éƒ¨åˆ†æˆ‘çš„å­¦ä¹ éœ€æ±‚ä¸å¤§ï¼Œä»£ç ä¹Ÿå°±ä¸è´´äº†ä¸ç¿»è¯‘äº†ï¼Œå¯èƒ½æ—¥åæœ‰éœ€æ±‚äº†ä¼šå†æ¥è¡¥å……çš„ï¼Œå¤§å®¶æœ‰éœ€è¦å»çš„å»å‚é˜…<a href="http://www.eclipse.org/jetty/documentation/9.4.6.v20170531/embedded-examples.html">åŸæ–‡</a>ã€‚</em></p>
</blockquote>
<p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="2135æœ€ç®€å•çš„servlet"></span></p>

          <h5>
            <a name="_root-21.3.5ã€æœ€ç®€å•çš„Servlet" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.3.5ã€æœ€ç®€å•çš„Servlet
          </h5><p>è¿™ä¸ªæ —å­å±•ç¤ºäº†æœ€ç®€å•æœ€ç®€å•çš„åœ¨Jettyä¸­éƒ¨ç½²servletçš„æ–¹å¼ã€‚ä½ éœ€è¦æ³¨æ„åˆ°çš„æ˜¯ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ä¸€ä¸ªä¸¥æ ¼æ„ä¹‰ä¸Šçš„servletï¼Œå¹¶ä¸æ˜¯webåº”ç”¨çš„contextä¸­çš„servletï¼Œè¿™ç§ä¼šåœ¨åé¢æåˆ°ã€‚è¿™æ˜¯ä¸€ä¸ªå•çº¯çš„servletï¼Œå®ƒä»…ä»…æ˜¯éƒ¨ç½²å’ŒæŒ‚è½½åœ¨contextä¸Šï¼Œè®©æˆ‘ä»¬å¯ä»¥è¯·æ±‚è€Œå·²ã€‚è¿™ä¸ªæ —å­å®Œç¾çš„å±•ç°äº†å½“ä½ æœ‰ä¸€ä¸ªç®€å•çš„servletï¼Œè€Œä½ æ­£éœ€è¦å¯¹ä»–è¿›è¡Œå•å…ƒæµ‹è¯•çš„æ—¶å€™ï¼Œä½ åªéœ€è¦æŠŠå®ƒæŒ‚è½½åˆ°contextä¸­ï¼Œç„¶åä½¿ç”¨ä½ æœ€å–œæ¬¢çš„httpå®¢æˆ·ç«¯åº“å»å‘èµ·è¯·æ±‚ã€‚ï¼ˆå¯ä»¥å‚è€ƒJettyçš„HTTP Clientï¼‰</p>
<pre><code>package org.eclipse.jetty.embedded;

import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.servlet.ServletHandler;

public class MinimalServlets
{
    public static void main( String[] args ) throws Exception
    {
        Server server = new Server(8080);

        ServletHandler handler = new ServletHandler();
        server.setHandler(handler);

        // é€šè¿‡è¿™ä¸ªç±»å®ä¾‹ä½ å¯ä»¥æŠŠservletæŒ‚è½½åˆ°contexté‡Œ

        // é‡è¦:
        // è¿™æ˜¯ä¸€ä¸ªåŸç”Ÿçš„servletï¼Œä¸æ˜¯åƒä»¥å‰é‚£ç§è¢«web.xmlæˆ–è€…æ³¨è§£é…ç½®çš„servlet
        handler.addServletWithMapping(HelloServlet.class, &quot;/*&quot;);

        server.start();
        server.join();
    }

    @SuppressWarnings(&quot;serial&quot;)
    public static class HelloServlet extends HttpServlet
    {
        @Override
        protected void doGet( HttpServletRequest request,
                              HttpServletResponse response ) throws ServletException,
                                                            IOException
        {
            response.setContentType(&quot;text/html&quot;);
            response.setStatus(HttpServletResponse.SC_OK);
            response.getWriter().println(&quot;&lt;h1&gt;Hello from HelloServlet&lt;/h1&gt;&quot;);
        }
    }
}</code></pre><p>é€šè¿‡è¿™ä¸ªæ —å­ï¼Œä½ å¯ä»¥éå¸¸ç®€å•çš„å°±é…ç½®ä¸€ä¸ªservletåˆ°httpæœåŠ¡å™¨ä¸­ï¼Œä½œä¸ºç®€å•çš„æµ‹è¯•å•å…ƒã€‚</p>
<p>è¿™é‡Œä½ ä¼šä½¿ç”¨åˆ°çš„Mavenä¾èµ–åæ ‡ï¼š</p>
<pre><code>&lt;dependency&gt;
  &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
  &lt;artifactId&gt;jetty-servlet&lt;/artifactId&gt;
  &lt;version&gt;${project.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre><p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="2136web-application"></span></p>

          <h5>
            <a name="_root-21.3.6ã€Web Application" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.3.6ã€Web Application
          </h5><p>è¿™é‡Œä¼šå‘ä½ å±•ç¤ºå¦‚ä½•ä½¿ç”¨ä¸€ä¸ªåµŒå…¥å¼çš„JettyæœåŠ¡å™¨å»éƒ¨ç½²ä¸€ä¸ªç®€å•çš„webåº”ç”¨ã€‚è¿™å¯¹ä½ æƒ³è¦ä»¥ç¼–ç¨‹çš„æ–¹å¼ç®¡ç†æœåŠ¡å™¨çš„ç”Ÿå‘½å‘¨æœŸéå¸¸æœ‰å¸®åŠ©ï¼Œä¸ç®¡æ˜¯ç”Ÿäº§é¡¹ç›®æˆ–è€…æ˜¯éƒ¨ç½²å’Œè°ƒè¯•ä¸€ä¸ªå®Œæ•´è§„æ¨¡çš„åº”ç”¨ä¹Ÿå¥½ã€‚å½“ä½ æ§åˆ¶ä½classpathä¹‹åï¼Œé‚£ä¹ˆåœ¨è®¸å¤šæ–¹é¢ï¼ŒJettyçš„è¿™ç§éƒ¨ç½²æ–¹å¼è¦æ¯”ä¼ ç»Ÿçš„éƒ¨ç½²æ–¹å¼è¦ç®€å•å¾—å¤šã€‚</p>
<blockquote>
<p><em>è¯‘è€…æ–‡å¤–è¡¥å……ï¼šè¿™é‡Œè´´çš„ä»£ç å’Œ<a href="#2128%E5%B5%8C%E5%85%A5web%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F">ä¸Šé¢</a>æ˜¯ä¸€æ ·çš„ã€‚</em></p>
</blockquote>
<p>è¿™é‡Œä½ ä¼šä½¿ç”¨åˆ°çš„Mavenä¾èµ–åæ ‡ï¼š</p>
<pre><code>&lt;dependency&gt;
  &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
  &lt;artifactId&gt;jetty-webapp&lt;/artifactId&gt;
  &lt;version&gt;${project.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre><p><a href="#top">å›åˆ°é¡¶éƒ¨</a><br><br></p>
<p><span id="2137web-applicationä»¥åŠjsp"></span></p>

          <h5>
            <a name="_root-21.3.7ã€Web Applicationä»¥åŠJSP" class="reference-link" target="_blank">
              <span class="header-link"></span>
            </a>
            21.3.7ã€Web Applicationä»¥åŠJSP
          </h5><p>è¿™ä¸ªæ —å­å’Œä¸Šä¸€ä¸ªæ —å­éå¸¸åƒï¼Œå› ä¸ºå®ƒåªæ˜¯æ”¯æŒäº†å†…åµŒwebåº”ç”¨å¯ä»¥ä½¿ç”¨jspè€Œå·²ã€‚ä»Jetty9.2ä»¥æ¥ï¼Œæˆ‘ä»¬ä¸€ç›´ä½¿ç”¨çš„æ˜¯Apacheçš„JSPå¼•æ“ï¼Œè¿™ç§åšæ³•éœ€è¦<code>ServletContainerInitializer</code>å»å®ä¾‹åŒ–å®ƒè‡ªå·±ä»¥æ”¯æŒServlet3.1è§„èŒƒã€‚ä¸ºäº†è®©Jettyåšåˆ°è¿™äº›ï¼Œä½ éœ€è¦å¼€å¯æ³¨è§£å¤„ç†æœºåˆ¶ï¼š</p>
<pre><code>package org.eclipse.jetty.embedded;

import java.io.File;
import java.lang.management.ManagementFactory;

import org.eclipse.jetty.jmx.MBeanContainer;
import org.eclipse.jetty.security.HashLoginService;
import org.eclipse.jetty.server.Server;
import org.eclipse.jetty.webapp.Configuration;
import org.eclipse.jetty.webapp.WebAppContext;

public class OneWebAppWithJsp
{
    public static void main( String[] args ) throws Exception
    {
        Server server = new Server( 8080 );

        // Setup JMX
        MBeanContainer mbContainer = new MBeanContainer(
                ManagementFactory.getPlatformMBeanServer() );
        server.addBean( mbContainer );

        // WebAppContextå¯¹è±¡æ˜¯ç”¨æ¥æ§åˆ¶å®ƒè‡ªå·±èµ–ä»¥ç”Ÿå­˜çš„ç¯å¢ƒçš„ã€‚
        // åœ¨è¿™ä¸ªæ —å­é‡Œé¢ï¼Œcontext pathè®¾ç½®ä¸ºâ€œ/â€
        // è¿™æ ·å®ƒå°±å¯ä»¥å¤„ç†æ ¹contextä¸‹çš„è¯·æ±‚äº†
        // æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ°å®ƒè®¾ç½®äº†warçš„ä½ç½®
        // æ•´ä¸ªhostçš„å…¶ä»–é…ç½®éƒ½æ˜¯å¯ç”¨çš„å¯é…ç½®çš„
        // ä½ å¯ç”¨é…ç½®æ³¨è§£æ‰«æçš„æ”¯æŒï¼ˆéœ€è¦é€šè¿‡PlusConfigurationï¼‰
        // è¿˜å¯ç”¨é€‰æ‹©webappåœ¨å“ªé‡Œè‡ªåŠ¨è§£å‹
        WebAppContext webapp = new WebAppContext();
        webapp.setContextPath( &quot;/&quot; );
        File warFile = new File(
                &quot;../../jetty-distribution/target/distribution/demo-base/webapps/test.war&quot; );
        if (!warFile.exists())
        {
            throw new RuntimeException( &quot;Unable to find WAR File: &quot;
                    + warFile.getAbsolutePath() );
        }
        webapp.setWar( warFile.getAbsolutePath() );
        webapp.setExtractWAR(true);

        // è¿™ä¸ªwebappä¼šä½¿ç”¨jspå’Œjstl
        // æˆ‘ä»¬éœ€è¦æ¿€æ´»AnnotationConfiguration
        // è¿™æ ·æ‰èƒ½æ­£ç¡®çš„è®¾ç½®jspå®¹å™¨
        Configuration.ClassList classlist = Configuration.ClassList
                .setServerDefault( server );
        classlist.addBefore(
                &quot;org.eclipse.jetty.webapp.JettyWebXmlConfiguration&quot;,
                &quot;org.eclipse.jetty.annotations.AnnotationConfiguration&quot; );

        // è®¾ç½®ContainerIncludeJarPattern
        // è¿™æ ·jettyæ‰ä¼šå»æ£€æŸ¥container path çš„jar
        // è¿™æ ·æ‰å¥½ä¸ºé¡¶çº§åŸŸåä»¥åŠwebç‰‡æ®µæœåŠ¡
        // å¦‚æœä½ çœç•¥äº†åŒ…å«jstlå’ŒåŸŸåçš„jar jspå¼•æ“ä¼šæ¥æ‰«æå®ƒä»¬
        webapp.setAttribute(
                &quot;org.eclipse.jetty.server.webapp.ContainerIncludeJarPattern&quot;,
                &quot;.*/[^/]*servlet-api-[^/]*\\.jar$|.*/javax.servlet.jsp.jstl-.*\\.jar$|.*/[^/]*taglibs.*\\.jar$&quot; );


        server.setHandler( webapp );

        // Configure a LoginService.
        // Since this example is for our test webapp, we need to setup a
        // LoginService so this shows how to create a very simple hashmap based
        // one. The name of the LoginService needs to correspond to what is
        // configured in the webapp&#39;s web.xml and since it has a lifecycle of
        // its own we register it as a bean with the Jetty server object so it
        // can be started and stopped according to the lifecycle of the server
        // itself.
        HashLoginService loginService = new HashLoginService();
        loginService.setName( &quot;Test Realm&quot; );
        loginService.setConfig( &quot;src/test/resources/realm.properties&quot; );
        server.addBean( loginService );

        // Start things up!
        server.start();
        server.dumpStdErr();
        server.join();
    }
}</code></pre><p>ä½ ä¼šç”¨åˆ°çš„Mavenä¾èµ–åæ ‡ï¼š</p>
<pre><code>&lt;dependency&gt;
  &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
  &lt;artifactId&gt;jetty-annotations&lt;/artifactId&gt;
  &lt;version&gt;${project.version}&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
  &lt;artifactId&gt;apache-jsp&lt;/artifactId&gt;
  &lt;version&gt;${project.version}&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.eclipse.jetty&lt;/groupId&gt;
  &lt;artifactId&gt;apache-jstl&lt;/artifactId&gt;
  &lt;version&gt;${project.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre><p><a href="#top">å›åˆ°é¡¶éƒ¨</a></p>
<hr>

    </div>
    <div id="scriptsearcher" class="myhide input-group new_font">
        <input id="searchtext" type="text" class="form-control" placeholder="keywords" autocomplete="off">
        <div class="input-group-append">
            <button id="searchbut" class="btn btn-dark" type="button">Search</button>
        </div>
    </div>

    <div id="bbt" class="myhide new_font">
        <a id="toc" style="display: none;" class="myhide" href="javascript:void(0);" data-toggle="tooltip" data-placement="left" title="show/hide Toc">Toc</a>
        <a id="gohub" href="#" target="_blank" data-toggle="tooltip" data-placement="bottom" title="view this at github">unuse</a>
    </div>

    <div id="share_png_panel" class="myhide">
        <div id="share_curtain"></div>
        <div id="png_box"></div>
        <button id="share_png_paned_close" class="btn btn-dark">Close</button>
    </div>

</body>

</html>